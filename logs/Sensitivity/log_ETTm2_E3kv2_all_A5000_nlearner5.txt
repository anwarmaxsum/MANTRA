Args in experiment:
Namespace(is_training=1, model_id='E3k_n5_ETTm2_96_96', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints0/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=5, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
>>>>>>>start training : E3k_n5_ETTm2_96_96_B6autoformer_ETTm2_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.2395223
	speed: 0.2070s/iter; left time: 4426.5483s
	iters: 200, epoch: 1 | loss: 1.7172809
	speed: 0.1790s/iter; left time: 3809.6265s
	iters: 300, epoch: 1 | loss: 0.5629154
	speed: 0.1664s/iter; left time: 3525.4968s
	iters: 400, epoch: 1 | loss: 0.4794706
	speed: 0.1681s/iter; left time: 3543.9749s
	iters: 500, epoch: 1 | loss: 0.3240925
	speed: 0.1709s/iter; left time: 3586.2786s
	iters: 600, epoch: 1 | loss: 0.2466240
	speed: 0.1724s/iter; left time: 3600.0215s
	iters: 700, epoch: 1 | loss: 0.3029796
	speed: 0.1728s/iter; left time: 3591.8766s
	iters: 800, epoch: 1 | loss: 0.2091100
	speed: 0.1817s/iter; left time: 3758.7551s
	iters: 900, epoch: 1 | loss: 0.1847320
	speed: 0.1738s/iter; left time: 3576.6198s
	iters: 1000, epoch: 1 | loss: 0.2557065
	speed: 0.1707s/iter; left time: 3495.1667s
Epoch: 1 cost time: 189.51167511940002
Epoch: 1, Steps: 1074 | Train Loss: 58.6089534 Vali Loss: 0.1766799 Test Loss: 0.2487367
Validation loss decreased (inf --> 0.176680).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2189911
	speed: 0.7230s/iter; left time: 14682.6317s
	iters: 200, epoch: 2 | loss: 0.3554277
	speed: 0.1733s/iter; left time: 3501.8727s
	iters: 300, epoch: 2 | loss: 0.1641212
	speed: 0.1752s/iter; left time: 3522.0277s
	iters: 400, epoch: 2 | loss: 0.3047877
	speed: 0.1737s/iter; left time: 3475.6251s
	iters: 500, epoch: 2 | loss: 0.5031265
	speed: 0.1732s/iter; left time: 3447.0421s
	iters: 600, epoch: 2 | loss: 0.2257242
	speed: 0.1737s/iter; left time: 3440.4189s
	iters: 700, epoch: 2 | loss: 0.1513005
	speed: 0.1754s/iter; left time: 3457.5117s
	iters: 800, epoch: 2 | loss: 0.2547510
	speed: 0.1810s/iter; left time: 3549.1923s
	iters: 900, epoch: 2 | loss: 0.4162848
	speed: 0.1847s/iter; left time: 3603.8558s
	iters: 1000, epoch: 2 | loss: 0.2302511
	speed: 0.1792s/iter; left time: 3477.8679s
Epoch: 2 cost time: 189.78909349441528
Epoch: 2, Steps: 1074 | Train Loss: 0.3139554 Vali Loss: 0.1641720 Test Loss: 0.2318000
Validation loss decreased (0.176680 --> 0.164172).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3132666
	speed: 0.7267s/iter; left time: 13976.3942s
	iters: 200, epoch: 3 | loss: 0.4153234
	speed: 0.1743s/iter; left time: 3334.8795s
	iters: 300, epoch: 3 | loss: 0.2640195
	speed: 0.1727s/iter; left time: 3287.5164s
	iters: 400, epoch: 3 | loss: 0.2069458
	speed: 0.1722s/iter; left time: 3259.4058s
	iters: 500, epoch: 3 | loss: 0.1384254
	speed: 0.1736s/iter; left time: 3269.5958s
	iters: 600, epoch: 3 | loss: 0.1710887
	speed: 0.1722s/iter; left time: 3224.9963s
	iters: 700, epoch: 3 | loss: 0.2651899
	speed: 0.1728s/iter; left time: 3220.2187s
	iters: 800, epoch: 3 | loss: 0.2039829
	speed: 0.1718s/iter; left time: 3184.5811s
	iters: 900, epoch: 3 | loss: 0.3566361
	speed: 0.1756s/iter; left time: 3236.6997s
	iters: 1000, epoch: 3 | loss: 0.3032008
	speed: 0.1811s/iter; left time: 3320.3834s
Epoch: 3 cost time: 188.31585240364075
Epoch: 3, Steps: 1074 | Train Loss: 0.2926558 Vali Loss: 0.1535111 Test Loss: 0.2218072
Validation loss decreased (0.164172 --> 0.153511).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1902471
	speed: 0.7681s/iter; left time: 13948.4162s
	iters: 200, epoch: 4 | loss: 0.2953720
	speed: 0.1733s/iter; left time: 3129.0679s
	iters: 300, epoch: 4 | loss: 0.2362760
	speed: 0.1752s/iter; left time: 3145.5720s
	iters: 400, epoch: 4 | loss: 0.1545702
	speed: 0.1717s/iter; left time: 3067.1435s
	iters: 500, epoch: 4 | loss: 0.2021272
	speed: 0.1728s/iter; left time: 3068.2553s
	iters: 600, epoch: 4 | loss: 0.3463953
	speed: 0.1735s/iter; left time: 3063.5485s
	iters: 700, epoch: 4 | loss: 0.2092091
	speed: 0.1724s/iter; left time: 3027.7460s
	iters: 800, epoch: 4 | loss: 0.2835341
	speed: 0.1707s/iter; left time: 2980.6779s
	iters: 900, epoch: 4 | loss: 0.2620434
	speed: 0.1747s/iter; left time: 3032.5393s
	iters: 1000, epoch: 4 | loss: 0.1896227
	speed: 0.1727s/iter; left time: 2979.8214s
Epoch: 4 cost time: 187.12860774993896
Epoch: 4, Steps: 1074 | Train Loss: 0.2864528 Vali Loss: 0.1544393 Test Loss: 0.2204471
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.1402381
	speed: 0.8229s/iter; left time: 14059.9214s
	iters: 200, epoch: 5 | loss: 0.2428586
	speed: 0.1727s/iter; left time: 2933.3455s
	iters: 300, epoch: 5 | loss: 0.5343094
	speed: 0.1723s/iter; left time: 2908.6048s
	iters: 400, epoch: 5 | loss: 0.1668027
	speed: 0.1720s/iter; left time: 2886.4568s
	iters: 500, epoch: 5 | loss: 0.2435910
	speed: 0.1763s/iter; left time: 2942.3986s
	iters: 600, epoch: 5 | loss: 0.1853069
	speed: 0.1720s/iter; left time: 2852.7022s
	iters: 700, epoch: 5 | loss: 0.2677163
	speed: 0.1733s/iter; left time: 2857.2772s
	iters: 800, epoch: 5 | loss: 0.5367918
	speed: 0.1723s/iter; left time: 2823.5095s
	iters: 900, epoch: 5 | loss: 0.3290520
	speed: 0.1730s/iter; left time: 2817.4726s
	iters: 1000, epoch: 5 | loss: 0.2514457
	speed: 0.1729s/iter; left time: 2798.6800s
Epoch: 5 cost time: 187.034903049469
Epoch: 5, Steps: 1074 | Train Loss: 0.2826548 Vali Loss: 0.1502122 Test Loss: 0.2170431
Validation loss decreased (0.153511 --> 0.150212).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3177797
	speed: 0.7505s/iter; left time: 12015.5452s
	iters: 200, epoch: 6 | loss: 0.1488191
	speed: 0.1810s/iter; left time: 2879.1020s
	iters: 300, epoch: 6 | loss: 0.2176774
	speed: 0.1778s/iter; left time: 2810.8942s
	iters: 400, epoch: 6 | loss: 0.2287865
	speed: 0.1739s/iter; left time: 2732.5974s
	iters: 500, epoch: 6 | loss: 0.1497971
	speed: 0.1730s/iter; left time: 2701.3523s
	iters: 600, epoch: 6 | loss: 0.2566952
	speed: 0.1697s/iter; left time: 2631.5106s
	iters: 700, epoch: 6 | loss: 0.1652063
	speed: 0.1727s/iter; left time: 2661.3335s
	iters: 800, epoch: 6 | loss: 0.2824814
	speed: 0.1730s/iter; left time: 2648.8405s
	iters: 900, epoch: 6 | loss: 0.4185154
	speed: 0.1705s/iter; left time: 2594.0009s
	iters: 1000, epoch: 6 | loss: 0.3071663
	speed: 0.1725s/iter; left time: 2606.7255s
Epoch: 6 cost time: 188.40580558776855
Epoch: 6, Steps: 1074 | Train Loss: 0.2793990 Vali Loss: 0.1495547 Test Loss: 0.2164418
Validation loss decreased (0.150212 --> 0.149555).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2292342
	speed: 0.7316s/iter; left time: 10928.2497s
	iters: 200, epoch: 7 | loss: 0.1413906
	speed: 0.1821s/iter; left time: 2702.5494s
	iters: 300, epoch: 7 | loss: 0.3890929
	speed: 0.1839s/iter; left time: 2709.4681s
	iters: 400, epoch: 7 | loss: 0.1939225
	speed: 0.1804s/iter; left time: 2640.9077s
	iters: 500, epoch: 7 | loss: 0.1313066
	speed: 0.1756s/iter; left time: 2553.3697s
	iters: 600, epoch: 7 | loss: 0.3215343
	speed: 0.1736s/iter; left time: 2505.7038s
	iters: 700, epoch: 7 | loss: 0.2127614
	speed: 0.1723s/iter; left time: 2469.7795s
	iters: 800, epoch: 7 | loss: 0.2456475
	speed: 0.1748s/iter; left time: 2487.9396s
	iters: 900, epoch: 7 | loss: 0.2690441
	speed: 0.1721s/iter; left time: 2432.8421s
	iters: 1000, epoch: 7 | loss: 0.5031304
	speed: 0.1741s/iter; left time: 2443.7493s
Epoch: 7 cost time: 190.4256694316864
Epoch: 7, Steps: 1074 | Train Loss: 0.2770618 Vali Loss: 0.1484527 Test Loss: 0.2160176
Validation loss decreased (0.149555 --> 0.148453).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2277977
	speed: 0.7273s/iter; left time: 10082.6050s
	iters: 200, epoch: 8 | loss: 0.1347669
	speed: 0.1731s/iter; left time: 2382.5286s
	iters: 300, epoch: 8 | loss: 0.4477105
	speed: 0.1746s/iter; left time: 2386.1287s
	iters: 400, epoch: 8 | loss: 0.4537091
	speed: 0.1798s/iter; left time: 2437.9657s
	iters: 500, epoch: 8 | loss: 0.3640074
	speed: 0.1819s/iter; left time: 2448.7500s
	iters: 600, epoch: 8 | loss: 0.1718132
	speed: 0.1834s/iter; left time: 2451.2912s
	iters: 700, epoch: 8 | loss: 0.1605136
	speed: 0.1733s/iter; left time: 2298.6689s
	iters: 800, epoch: 8 | loss: 0.2707182
	speed: 0.1744s/iter; left time: 2295.9684s
	iters: 900, epoch: 8 | loss: 0.2053787
	speed: 0.1766s/iter; left time: 2307.3808s
	iters: 1000, epoch: 8 | loss: 0.3631806
	speed: 0.1738s/iter; left time: 2253.3616s
Epoch: 8 cost time: 190.20947933197021
Epoch: 8, Steps: 1074 | Train Loss: 0.2754199 Vali Loss: 0.1481407 Test Loss: 0.2153383
Validation loss decreased (0.148453 --> 0.148141).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.1563042
	speed: 0.7311s/iter; left time: 9350.1465s
	iters: 200, epoch: 9 | loss: 0.6716298
	speed: 0.1720s/iter; left time: 2182.5426s
	iters: 300, epoch: 9 | loss: 0.8646960
	speed: 0.1744s/iter; left time: 2194.9716s
	iters: 400, epoch: 9 | loss: 0.1988689
	speed: 0.1734s/iter; left time: 2164.9842s
	iters: 500, epoch: 9 | loss: 0.2764026
	speed: 0.1760s/iter; left time: 2180.0850s
	iters: 600, epoch: 9 | loss: 0.1139635
	speed: 0.1801s/iter; left time: 2213.1399s
	iters: 700, epoch: 9 | loss: 0.1256207
	speed: 0.1844s/iter; left time: 2247.1972s
	iters: 800, epoch: 9 | loss: 0.2704963
	speed: 0.1819s/iter; left time: 2199.5450s
	iters: 900, epoch: 9 | loss: 0.3545853
	speed: 0.1869s/iter; left time: 2241.3425s
	iters: 1000, epoch: 9 | loss: 0.3224826
	speed: 0.1771s/iter; left time: 2105.5724s
Epoch: 9 cost time: 192.35577535629272
Epoch: 9, Steps: 1074 | Train Loss: 0.2739209 Vali Loss: 0.1479694 Test Loss: 0.2157544
Validation loss decreased (0.148141 --> 0.147969).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.1524784
	speed: 0.7762s/iter; left time: 9093.5707s
	iters: 200, epoch: 10 | loss: 0.2778662
	speed: 0.1799s/iter; left time: 2089.7001s
	iters: 300, epoch: 10 | loss: 0.1398081
	speed: 0.1777s/iter; left time: 2046.1923s
	iters: 400, epoch: 10 | loss: 0.5083919
	speed: 0.1774s/iter; left time: 2024.8288s
	iters: 500, epoch: 10 | loss: 0.4073809
	speed: 0.1787s/iter; left time: 2021.9806s
	iters: 600, epoch: 10 | loss: 0.3271569
	speed: 0.1788s/iter; left time: 2004.8272s
	iters: 700, epoch: 10 | loss: 0.4928760
	speed: 0.1779s/iter; left time: 1976.9208s
	iters: 800, epoch: 10 | loss: 0.2701574
	speed: 0.1783s/iter; left time: 1963.6740s
	iters: 900, epoch: 10 | loss: 0.4174560
	speed: 0.1849s/iter; left time: 2017.7969s
	iters: 1000, epoch: 10 | loss: 0.1849722
	speed: 0.1843s/iter; left time: 1993.2912s
Epoch: 10 cost time: 194.26947259902954
Epoch: 10, Steps: 1074 | Train Loss: 0.2727993 Vali Loss: 0.1482038 Test Loss: 0.2155516
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
	iters: 100, epoch: 11 | loss: 0.4881336
	speed: 0.7811s/iter; left time: 8311.7519s
	iters: 200, epoch: 11 | loss: 0.2513724
	speed: 0.1775s/iter; left time: 1870.5937s
	iters: 300, epoch: 11 | loss: 0.3776996
	speed: 0.1787s/iter; left time: 1865.3236s
	iters: 400, epoch: 11 | loss: 0.6788002
	speed: 0.1782s/iter; left time: 1842.4075s
	iters: 500, epoch: 11 | loss: 0.1522685
	speed: 0.1810s/iter; left time: 1853.9799s
	iters: 600, epoch: 11 | loss: 0.2238218
	speed: 0.1781s/iter; left time: 1805.8359s
	iters: 700, epoch: 11 | loss: 0.1486372
	speed: 0.1778s/iter; left time: 1785.2985s
	iters: 800, epoch: 11 | loss: 0.1482442
	speed: 0.1811s/iter; left time: 1800.6621s
	iters: 900, epoch: 11 | loss: 0.4391359
	speed: 0.1851s/iter; left time: 1821.5654s
	iters: 1000, epoch: 11 | loss: 0.5672590
	speed: 0.1836s/iter; left time: 1788.2043s
Epoch: 11 cost time: 194.5936563014984
Epoch: 11, Steps: 1074 | Train Loss: 0.2723475 Vali Loss: 0.1477223 Test Loss: 0.2154071
Validation loss decreased (0.147969 --> 0.147722).  Saving model ...
Updating learning rate to 9.765625e-07
	iters: 100, epoch: 12 | loss: 0.2248625
	speed: 0.7724s/iter; left time: 7389.6066s
	iters: 200, epoch: 12 | loss: 0.5306554
	speed: 0.1780s/iter; left time: 1684.9681s
	iters: 300, epoch: 12 | loss: 0.2146387
	speed: 0.1788s/iter; left time: 1674.4224s
	iters: 400, epoch: 12 | loss: 0.3313384
	speed: 0.1766s/iter; left time: 1636.5768s
	iters: 500, epoch: 12 | loss: 0.2987942
	speed: 0.1766s/iter; left time: 1618.8728s
	iters: 600, epoch: 12 | loss: 0.1302455
	speed: 0.1837s/iter; left time: 1665.9050s
	iters: 700, epoch: 12 | loss: 0.2461419
	speed: 0.1758s/iter; left time: 1576.7775s
	iters: 800, epoch: 12 | loss: 0.3488587
	speed: 0.1857s/iter; left time: 1646.1874s
	iters: 900, epoch: 12 | loss: 0.3045651
	speed: 0.1856s/iter; left time: 1627.1358s
	iters: 1000, epoch: 12 | loss: 0.7751624
	speed: 0.1857s/iter; left time: 1609.4147s
Epoch: 12 cost time: 194.5531029701233
Epoch: 12, Steps: 1074 | Train Loss: 0.2718749 Vali Loss: 0.1478011 Test Loss: 0.2153383
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.8828125e-07
	iters: 100, epoch: 13 | loss: 0.1290565
	speed: 0.7712s/iter; left time: 6549.9961s
	iters: 200, epoch: 13 | loss: 0.1706388
	speed: 0.1789s/iter; left time: 1501.7244s
	iters: 300, epoch: 13 | loss: 0.1879647
	speed: 0.1794s/iter; left time: 1487.7779s
	iters: 400, epoch: 13 | loss: 0.1974480
	speed: 0.1738s/iter; left time: 1423.6989s
	iters: 500, epoch: 13 | loss: 0.4126606
	speed: 0.1801s/iter; left time: 1457.3499s
	iters: 600, epoch: 13 | loss: 0.1924820
	speed: 0.1796s/iter; left time: 1435.8751s
	iters: 700, epoch: 13 | loss: 0.1913235
	speed: 0.1789s/iter; left time: 1412.2923s
	iters: 800, epoch: 13 | loss: 0.5066019
	speed: 0.1844s/iter; left time: 1437.0452s
	iters: 900, epoch: 13 | loss: 0.1741291
	speed: 0.1841s/iter; left time: 1416.4279s
	iters: 1000, epoch: 13 | loss: 0.2236873
	speed: 0.1816s/iter; left time: 1378.7972s
Epoch: 13 cost time: 194.84201908111572
Epoch: 13, Steps: 1074 | Train Loss: 0.2718771 Vali Loss: 0.1477333 Test Loss: 0.2153475
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.44140625e-07
	iters: 100, epoch: 14 | loss: 0.1400259
	speed: 0.7425s/iter; left time: 5508.5415s
	iters: 200, epoch: 14 | loss: 0.2057622
	speed: 0.1759s/iter; left time: 1287.4393s
	iters: 300, epoch: 14 | loss: 0.2565215
	speed: 0.1801s/iter; left time: 1300.0095s
	iters: 400, epoch: 14 | loss: 0.2693043
	speed: 0.1788s/iter; left time: 1273.0121s
	iters: 500, epoch: 14 | loss: 0.2329853
	speed: 0.1745s/iter; left time: 1224.8153s
	iters: 600, epoch: 14 | loss: 0.2929299
	speed: 0.1764s/iter; left time: 1220.5564s
	iters: 700, epoch: 14 | loss: 0.1551504
	speed: 0.1765s/iter; left time: 1203.3461s
	iters: 800, epoch: 14 | loss: 0.1785407
	speed: 0.1769s/iter; left time: 1188.3261s
	iters: 900, epoch: 14 | loss: 0.2099222
	speed: 0.1772s/iter; left time: 1173.1983s
	iters: 1000, epoch: 14 | loss: 0.2298566
	speed: 0.1799s/iter; left time: 1172.6716s
Epoch: 14 cost time: 191.2684576511383
Epoch: 14, Steps: 1074 | Train Loss: 0.2718703 Vali Loss: 0.1476901 Test Loss: 0.2153217
Validation loss decreased (0.147722 --> 0.147690).  Saving model ...
Updating learning rate to 1.220703125e-07
	iters: 100, epoch: 15 | loss: 0.2093061
	speed: 0.7641s/iter; left time: 4848.3537s
	iters: 200, epoch: 15 | loss: 0.1710260
	speed: 0.1795s/iter; left time: 1120.7964s
	iters: 300, epoch: 15 | loss: 0.4432051
	speed: 0.1768s/iter; left time: 1086.6640s
	iters: 400, epoch: 15 | loss: 0.2828211
	speed: 0.1768s/iter; left time: 1069.0466s
	iters: 500, epoch: 15 | loss: 0.2945808
	speed: 0.1756s/iter; left time: 1043.7178s
	iters: 600, epoch: 15 | loss: 0.1637679
	speed: 0.1777s/iter; left time: 1038.6615s
	iters: 700, epoch: 15 | loss: 0.1195773
	speed: 0.1750s/iter; left time: 1005.2826s
	iters: 800, epoch: 15 | loss: 0.2149834
	speed: 0.1771s/iter; left time: 999.9861s
	iters: 900, epoch: 15 | loss: 0.2184189
	speed: 0.1785s/iter; left time: 990.0536s
	iters: 1000, epoch: 15 | loss: 0.2248494
	speed: 0.1749s/iter; left time: 952.3510s
Epoch: 15 cost time: 190.97818970680237
Epoch: 15, Steps: 1074 | Train Loss: 0.2718152 Vali Loss: 0.1476755 Test Loss: 0.2153014
Validation loss decreased (0.147690 --> 0.147675).  Saving model ...
Updating learning rate to 6.103515625e-08
	iters: 100, epoch: 16 | loss: 0.3678473
	speed: 0.7364s/iter; left time: 3881.8062s
	iters: 200, epoch: 16 | loss: 0.2746543
	speed: 0.1745s/iter; left time: 902.5734s
	iters: 300, epoch: 16 | loss: 0.1489202
	speed: 0.1761s/iter; left time: 892.7944s
	iters: 400, epoch: 16 | loss: 0.3306463
	speed: 0.1834s/iter; left time: 911.6764s
	iters: 500, epoch: 16 | loss: 0.4349699
	speed: 0.1779s/iter; left time: 866.3782s
	iters: 600, epoch: 16 | loss: 0.1211184
	speed: 0.1798s/iter; left time: 857.8477s
	iters: 700, epoch: 16 | loss: 0.2847669
	speed: 0.1793s/iter; left time: 837.5163s
	iters: 800, epoch: 16 | loss: 0.1625354
	speed: 0.1774s/iter; left time: 810.8809s
	iters: 900, epoch: 16 | loss: 0.3803720
	speed: 0.1764s/iter; left time: 788.5616s
	iters: 1000, epoch: 16 | loss: 0.2972402
	speed: 0.1759s/iter; left time: 768.6871s
Epoch: 16 cost time: 192.2583441734314
Epoch: 16, Steps: 1074 | Train Loss: 0.2715354 Vali Loss: 0.1477014 Test Loss: 0.2153230
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.0517578125e-08
	iters: 100, epoch: 17 | loss: 0.3952760
	speed: 0.7278s/iter; left time: 3054.6835s
	iters: 200, epoch: 17 | loss: 0.1504141
	speed: 0.1774s/iter; left time: 726.9631s
	iters: 300, epoch: 17 | loss: 0.3124517
	speed: 0.1762s/iter; left time: 704.1944s
	iters: 400, epoch: 17 | loss: 0.2447903
	speed: 0.1768s/iter; left time: 688.8966s
	iters: 500, epoch: 17 | loss: 0.2100525
	speed: 0.1779s/iter; left time: 675.5077s
	iters: 600, epoch: 17 | loss: 0.4200204
	speed: 0.1779s/iter; left time: 657.7211s
	iters: 700, epoch: 17 | loss: 0.4134353
	speed: 0.1752s/iter; left time: 630.3666s
	iters: 800, epoch: 17 | loss: 0.6041393
	speed: 0.1800s/iter; left time: 629.3112s
	iters: 900, epoch: 17 | loss: 0.3277704
	speed: 0.1778s/iter; left time: 604.0340s
	iters: 1000, epoch: 17 | loss: 0.2428318
	speed: 0.1781s/iter; left time: 587.2402s
Epoch: 17 cost time: 191.5566267967224
Epoch: 17, Steps: 1074 | Train Loss: 0.2716214 Vali Loss: 0.1477134 Test Loss: 0.2153179
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.52587890625e-08
	iters: 100, epoch: 18 | loss: 0.3155603
	speed: 0.7347s/iter; left time: 2294.3970s
	iters: 200, epoch: 18 | loss: 0.1189831
	speed: 0.1767s/iter; left time: 534.0879s
	iters: 300, epoch: 18 | loss: 0.2366370
	speed: 0.1749s/iter; left time: 511.3787s
	iters: 400, epoch: 18 | loss: 0.1432346
	speed: 0.1785s/iter; left time: 503.7983s
	iters: 500, epoch: 18 | loss: 0.2398758
	speed: 0.1772s/iter; left time: 482.6197s
	iters: 600, epoch: 18 | loss: 0.1555355
	speed: 0.1764s/iter; left time: 462.7712s
	iters: 700, epoch: 18 | loss: 0.2999525
	speed: 0.1757s/iter; left time: 443.3260s
	iters: 800, epoch: 18 | loss: 0.2051316
	speed: 0.1735s/iter; left time: 420.4608s
	iters: 900, epoch: 18 | loss: 0.2738209
	speed: 0.1773s/iter; left time: 411.8321s
	iters: 1000, epoch: 18 | loss: 0.4120524
	speed: 0.1751s/iter; left time: 389.3575s
Epoch: 18 cost time: 190.16079783439636
Epoch: 18, Steps: 1074 | Train Loss: 0.2714738 Vali Loss: 0.1477161 Test Loss: 0.2153233
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : E3k_n5_ETTm2_96_96_B6autoformer_ETTm2_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2156362384557724, mae:0.29912635684013367
Test learner: 0 test 11425
mse:0.28537487983703613, mae:0.37114548683166504
Test learner: 1 test 11425
mse:0.3006250560283661, mae:0.3922559916973114
Test learner: 2 test 11425
mse:0.32074061036109924, mae:0.3994476795196533
Test learner: 3 test 11425
mse:0.30191370844841003, mae:0.3742288649082184
Test learner: 4 test 11425
mse:0.2833655774593353, mae:0.36483076214790344
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training URT: E3k_n5_ETTm2_96_96_B6autoformer_ETTm2_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.2102194
	speed: 0.1462s/iter; left time: 3126.7838s
	iters: 200, epoch: 1 | loss: 0.3142566
	speed: 0.1380s/iter; left time: 2937.7329s
	iters: 300, epoch: 1 | loss: 0.2394263
	speed: 0.1371s/iter; left time: 2904.1093s
	iters: 400, epoch: 1 | loss: 0.2126164
	speed: 0.1376s/iter; left time: 2900.2652s
	iters: 500, epoch: 1 | loss: 0.2786642
	speed: 0.1386s/iter; left time: 2908.0186s
	iters: 600, epoch: 1 | loss: 0.2060449
	speed: 0.1378s/iter; left time: 2876.3595s
	iters: 700, epoch: 1 | loss: 0.3832235
	speed: 0.1397s/iter; left time: 2903.9321s
	iters: 800, epoch: 1 | loss: 0.2319979
	speed: 0.1382s/iter; left time: 2857.9044s
	iters: 900, epoch: 1 | loss: 0.4001760
	speed: 0.1383s/iter; left time: 2846.0043s
	iters: 1000, epoch: 1 | loss: 0.6670077
	speed: 0.1387s/iter; left time: 2841.6426s
Epoch: 1 cost time: 149.53643012046814
Update Best URT params
Epoch: 1, Steps: 1074 | Train Loss: 0.2755250 Vali Loss: 0.1477240 Test Loss: 0.2153943
Validation loss decreased (inf --> 0.147724).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1637785
	speed: 0.6784s/iter; left time: 13775.7145s
	iters: 200, epoch: 2 | loss: 0.2781428
	speed: 0.1381s/iter; left time: 2791.2467s
	iters: 300, epoch: 2 | loss: 0.1567714
	speed: 0.1387s/iter; left time: 2789.4048s
	iters: 400, epoch: 2 | loss: 0.6436998
	speed: 0.1532s/iter; left time: 3064.4515s
	iters: 500, epoch: 2 | loss: 0.2580763
	speed: 0.1528s/iter; left time: 3042.6965s
	iters: 600, epoch: 2 | loss: 0.3449404
	speed: 0.1508s/iter; left time: 2986.8980s
	iters: 700, epoch: 2 | loss: 0.1997019
	speed: 0.1523s/iter; left time: 3001.2404s
	iters: 800, epoch: 2 | loss: 0.2295724
	speed: 0.1478s/iter; left time: 2898.1761s
	iters: 900, epoch: 2 | loss: 0.3448151
	speed: 0.1374s/iter; left time: 2679.6462s
	iters: 1000, epoch: 2 | loss: 0.2756065
	speed: 0.1392s/iter; left time: 2701.5176s
Epoch: 2 cost time: 156.04824686050415
Epoch: 2, Steps: 1074 | Train Loss: 0.2753467 Vali Loss: 0.1479272 Test Loss: 0.2153476
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.3436659
	speed: 0.6752s/iter; left time: 12985.2930s
	iters: 200, epoch: 3 | loss: 0.2970551
	speed: 0.1391s/iter; left time: 2661.5960s
	iters: 300, epoch: 3 | loss: 0.5041842
	speed: 0.1374s/iter; left time: 2615.8591s
	iters: 400, epoch: 3 | loss: 0.1622877
	speed: 0.1379s/iter; left time: 2610.6241s
	iters: 500, epoch: 3 | loss: 0.5149843
	speed: 0.1387s/iter; left time: 2611.8403s
	iters: 600, epoch: 3 | loss: 0.1481114
	speed: 0.1398s/iter; left time: 2618.1911s
	iters: 700, epoch: 3 | loss: 0.1947583
	speed: 0.1386s/iter; left time: 2583.0420s
	iters: 800, epoch: 3 | loss: 0.1140556
	speed: 0.1384s/iter; left time: 2565.4272s
	iters: 900, epoch: 3 | loss: 0.1679772
	speed: 0.1388s/iter; left time: 2558.3252s
	iters: 1000, epoch: 3 | loss: 0.1075736
	speed: 0.1382s/iter; left time: 2534.1183s
Epoch: 3 cost time: 149.75622606277466
Epoch: 3, Steps: 1074 | Train Loss: 0.2752109 Vali Loss: 0.1480460 Test Loss: 0.2153551
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5722218
	speed: 0.7295s/iter; left time: 13246.5219s
	iters: 200, epoch: 4 | loss: 0.2313492
	speed: 0.1528s/iter; left time: 2758.9611s
	iters: 300, epoch: 4 | loss: 0.2695439
	speed: 0.1463s/iter; left time: 2628.1398s
	iters: 400, epoch: 4 | loss: 0.1845548
	speed: 0.1378s/iter; left time: 2460.6544s
	iters: 500, epoch: 4 | loss: 0.7157949
	speed: 0.1389s/iter; left time: 2466.9684s
	iters: 600, epoch: 4 | loss: 0.2952605
	speed: 0.1389s/iter; left time: 2453.1332s
	iters: 700, epoch: 4 | loss: 0.1808540
	speed: 0.1388s/iter; left time: 2437.2809s
	iters: 800, epoch: 4 | loss: 0.2205997
	speed: 0.1385s/iter; left time: 2417.8581s
	iters: 900, epoch: 4 | loss: 0.2821753
	speed: 0.1380s/iter; left time: 2394.9719s
	iters: 1000, epoch: 4 | loss: 0.4073987
	speed: 0.1387s/iter; left time: 2392.9998s
Epoch: 4 cost time: 153.3862509727478
Epoch: 4, Steps: 1074 | Train Loss: 0.2751930 Vali Loss: 0.1478823 Test Loss: 0.2153151
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_n5_ETTm2_96_96_B6autoformer_ETTm2_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.21573103964328766, mae:0.2991766035556793
Args in experiment:
Namespace(is_training=1, model_id='E3k_n5_ETTm2_96_192', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints1/', seq_len=96, label_len=48, pred_len=192, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=5, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
>>>>>>>start training : E3k_n5_ETTm2_96_192_B6autoformer_ETTm2_ftM_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.3683263
	speed: 0.2297s/iter; left time: 4897.7096s
	iters: 200, epoch: 1 | loss: 1.9502389
	speed: 0.2022s/iter; left time: 4290.5517s
	iters: 300, epoch: 1 | loss: 0.5084695
	speed: 0.1993s/iter; left time: 4209.5439s
	iters: 400, epoch: 1 | loss: 0.6985481
	speed: 0.1991s/iter; left time: 4184.8661s
	iters: 500, epoch: 1 | loss: 0.2496164
	speed: 0.2000s/iter; left time: 4183.3924s
	iters: 600, epoch: 1 | loss: 0.4729058
	speed: 0.1988s/iter; left time: 4139.4587s
	iters: 700, epoch: 1 | loss: 0.4144093
	speed: 0.2007s/iter; left time: 4159.0555s
	iters: 800, epoch: 1 | loss: 0.4350156
	speed: 0.2009s/iter; left time: 4143.5518s
	iters: 900, epoch: 1 | loss: 0.3916018
	speed: 0.1997s/iter; left time: 4097.2872s
	iters: 1000, epoch: 1 | loss: 0.2867002
	speed: 0.2007s/iter; left time: 4098.6203s
Epoch: 1 cost time: 217.5672082901001
Epoch: 1, Steps: 1071 | Train Loss: 33.5906167 Vali Loss: 0.2049375 Test Loss: 0.2909490
Validation loss decreased (inf --> 0.204938).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2664209
	speed: 0.8779s/iter; left time: 17778.1504s
	iters: 200, epoch: 2 | loss: 0.2502075
	speed: 0.2021s/iter; left time: 4072.5538s
	iters: 300, epoch: 2 | loss: 0.3154655
	speed: 0.1985s/iter; left time: 3980.8912s
	iters: 400, epoch: 2 | loss: 0.2726854
	speed: 0.1992s/iter; left time: 3974.1961s
	iters: 500, epoch: 2 | loss: 0.7157606
	speed: 0.2010s/iter; left time: 3990.7636s
	iters: 600, epoch: 2 | loss: 0.2611691
	speed: 0.2012s/iter; left time: 3974.0905s
	iters: 700, epoch: 2 | loss: 0.2037223
	speed: 0.1977s/iter; left time: 3885.4384s
	iters: 800, epoch: 2 | loss: 0.5557476
	speed: 0.1972s/iter; left time: 3854.7440s
	iters: 900, epoch: 2 | loss: 0.2635840
	speed: 0.1974s/iter; left time: 3839.4762s
	iters: 1000, epoch: 2 | loss: 0.2866959
	speed: 0.2010s/iter; left time: 3889.6833s
Epoch: 2 cost time: 214.71368646621704
Epoch: 2, Steps: 1071 | Train Loss: 0.3845626 Vali Loss: 0.1886772 Test Loss: 0.2722314
Validation loss decreased (0.204938 --> 0.188677).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2227921
	speed: 0.8835s/iter; left time: 16944.2527s
	iters: 200, epoch: 3 | loss: 0.2187463
	speed: 0.1987s/iter; left time: 3790.6466s
	iters: 300, epoch: 3 | loss: 0.2639908
	speed: 0.2002s/iter; left time: 3799.5223s
	iters: 400, epoch: 3 | loss: 0.2552066
	speed: 0.1999s/iter; left time: 3774.6261s
	iters: 500, epoch: 3 | loss: 0.2536544
	speed: 0.2012s/iter; left time: 3777.8346s
	iters: 600, epoch: 3 | loss: 0.2323174
	speed: 0.1995s/iter; left time: 3725.6391s
	iters: 700, epoch: 3 | loss: 0.4003847
	speed: 0.1988s/iter; left time: 3694.0387s
	iters: 800, epoch: 3 | loss: 0.5318501
	speed: 0.2015s/iter; left time: 3722.7053s
	iters: 900, epoch: 3 | loss: 0.2135511
	speed: 0.2009s/iter; left time: 3693.0395s
	iters: 1000, epoch: 3 | loss: 0.4246210
	speed: 0.1983s/iter; left time: 3624.4193s
Epoch: 3 cost time: 215.24604392051697
Epoch: 3, Steps: 1071 | Train Loss: 0.3718027 Vali Loss: 0.1884473 Test Loss: 0.2717441
Validation loss decreased (0.188677 --> 0.188447).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.1821958
	speed: 0.8793s/iter; left time: 15922.2111s
	iters: 200, epoch: 4 | loss: 0.4891877
	speed: 0.2001s/iter; left time: 3603.4178s
	iters: 300, epoch: 4 | loss: 0.7853252
	speed: 0.2021s/iter; left time: 3618.9665s
	iters: 400, epoch: 4 | loss: 0.2170909
	speed: 0.1993s/iter; left time: 3549.5476s
	iters: 500, epoch: 4 | loss: 0.4310693
	speed: 0.2025s/iter; left time: 3586.3197s
	iters: 600, epoch: 4 | loss: 0.1768872
	speed: 0.1999s/iter; left time: 3520.1973s
	iters: 700, epoch: 4 | loss: 0.6955436
	speed: 0.1998s/iter; left time: 3498.3310s
	iters: 800, epoch: 4 | loss: 0.2997719
	speed: 0.2010s/iter; left time: 3498.9377s
	iters: 900, epoch: 4 | loss: 0.5994070
	speed: 0.1996s/iter; left time: 3454.8396s
	iters: 1000, epoch: 4 | loss: 0.2380504
	speed: 0.2028s/iter; left time: 3489.5755s
Epoch: 4 cost time: 215.5588047504425
Epoch: 4, Steps: 1071 | Train Loss: 0.3680115 Vali Loss: 0.1920210 Test Loss: 0.2750070
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.8100896
	speed: 0.9783s/iter; left time: 16668.0433s
	iters: 200, epoch: 5 | loss: 0.1891244
	speed: 0.2034s/iter; left time: 3444.1935s
	iters: 300, epoch: 5 | loss: 0.2384268
	speed: 0.2017s/iter; left time: 3396.7354s
	iters: 400, epoch: 5 | loss: 0.2808041
	speed: 0.2044s/iter; left time: 3421.7035s
	iters: 500, epoch: 5 | loss: 0.2235045
	speed: 0.2018s/iter; left time: 3357.4634s
	iters: 600, epoch: 5 | loss: 0.3044135
	speed: 0.2012s/iter; left time: 3327.3122s
	iters: 700, epoch: 5 | loss: 0.2538529
	speed: 0.2031s/iter; left time: 3337.6214s
	iters: 800, epoch: 5 | loss: 0.7024273
	speed: 0.2034s/iter; left time: 3323.6455s
	iters: 900, epoch: 5 | loss: 0.3893934
	speed: 0.2030s/iter; left time: 3296.7029s
	iters: 1000, epoch: 5 | loss: 0.7261444
	speed: 0.2006s/iter; left time: 3237.1823s
Epoch: 5 cost time: 217.67736172676086
Epoch: 5, Steps: 1071 | Train Loss: 0.3657490 Vali Loss: 0.1907433 Test Loss: 0.2737473
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.5249840
	speed: 0.9310s/iter; left time: 14864.3872s
	iters: 200, epoch: 6 | loss: 0.2134038
	speed: 0.2009s/iter; left time: 3187.2155s
	iters: 300, epoch: 6 | loss: 0.2073105
	speed: 0.2010s/iter; left time: 3168.9764s
	iters: 400, epoch: 6 | loss: 0.4247712
	speed: 0.2006s/iter; left time: 3142.9915s
	iters: 500, epoch: 6 | loss: 0.2892317
	speed: 0.2005s/iter; left time: 3120.6917s
	iters: 600, epoch: 6 | loss: 0.3927341
	speed: 0.2021s/iter; left time: 3125.0268s
	iters: 700, epoch: 6 | loss: 0.2756166
	speed: 0.2049s/iter; left time: 3148.1401s
	iters: 800, epoch: 6 | loss: 0.1841054
	speed: 0.2049s/iter; left time: 3128.6891s
	iters: 900, epoch: 6 | loss: 0.4651352
	speed: 0.1994s/iter; left time: 3024.7367s
	iters: 1000, epoch: 6 | loss: 0.5014126
	speed: 0.2022s/iter; left time: 3046.1277s
Epoch: 6 cost time: 216.757159948349
Epoch: 6, Steps: 1071 | Train Loss: 0.3639928 Vali Loss: 0.1947423 Test Loss: 0.2778396
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : E3k_n5_ETTm2_96_192_B6autoformer_ETTm2_ftM_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.27222302556037903, mae:0.33127838373184204
Test learner: 0 test 11329
mse:0.35556209087371826, mae:0.4211021959781647
Test learner: 1 test 11329
mse:0.32125189900398254, mae:0.380710244178772
Test learner: 2 test 11329
mse:0.5530332326889038, mae:0.5452378988265991
Test learner: 3 test 11329
mse:0.30683425068855286, mae:0.36145493388175964
Test learner: 4 test 11329
mse:0.31345972418785095, mae:0.3754021227359772
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training URT: E3k_n5_ETTm2_96_192_B6autoformer_ETTm2_ftM_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.2942422
	speed: 0.2025s/iter; left time: 4318.4222s
	iters: 200, epoch: 1 | loss: 0.3936085
	speed: 0.1872s/iter; left time: 3972.3936s
	iters: 300, epoch: 1 | loss: 0.6188456
	speed: 0.1803s/iter; left time: 3807.4364s
	iters: 400, epoch: 1 | loss: 0.3228376
	speed: 0.1796s/iter; left time: 3774.4236s
	iters: 500, epoch: 1 | loss: 0.3630108
	speed: 0.1811s/iter; left time: 3788.9175s
	iters: 600, epoch: 1 | loss: 0.5049351
	speed: 0.1807s/iter; left time: 3762.6869s
	iters: 700, epoch: 1 | loss: 0.3447220
	speed: 0.1811s/iter; left time: 3752.1149s
	iters: 800, epoch: 1 | loss: 0.2925718
	speed: 0.1803s/iter; left time: 3718.9853s
	iters: 900, epoch: 1 | loss: 0.2585237
	speed: 0.1808s/iter; left time: 3711.0777s
	iters: 1000, epoch: 1 | loss: 0.4882033
	speed: 0.1818s/iter; left time: 3711.7809s
Epoch: 1 cost time: 196.53304481506348
Update Best URT params
Epoch: 1, Steps: 1071 | Train Loss: 0.3677571 Vali Loss: 0.1884441 Test Loss: 0.2715816
Validation loss decreased (inf --> 0.188444).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3114636
	speed: 0.9261s/iter; left time: 18752.9322s
	iters: 200, epoch: 2 | loss: 0.6357681
	speed: 0.1936s/iter; left time: 3901.8714s
	iters: 300, epoch: 2 | loss: 0.1773850
	speed: 0.1931s/iter; left time: 3871.0105s
	iters: 400, epoch: 2 | loss: 0.2990824
	speed: 0.1926s/iter; left time: 3842.0505s
	iters: 500, epoch: 2 | loss: 0.6339996
	speed: 0.1842s/iter; left time: 3657.0514s
	iters: 600, epoch: 2 | loss: 0.3129289
	speed: 0.1804s/iter; left time: 3563.2704s
	iters: 700, epoch: 2 | loss: 0.4046990
	speed: 0.1810s/iter; left time: 3556.6531s
	iters: 800, epoch: 2 | loss: 0.2685325
	speed: 0.1820s/iter; left time: 3557.3722s
	iters: 900, epoch: 2 | loss: 0.1763427
	speed: 0.1823s/iter; left time: 3544.9355s
	iters: 1000, epoch: 2 | loss: 0.6307496
	speed: 0.1822s/iter; left time: 3526.1966s
Epoch: 2 cost time: 199.61946606636047
Epoch: 2, Steps: 1071 | Train Loss: 0.3675588 Vali Loss: 0.1885108 Test Loss: 0.2717021
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.3642002
	speed: 0.9200s/iter; left time: 17643.8808s
	iters: 200, epoch: 3 | loss: 0.5027433
	speed: 0.1795s/iter; left time: 3425.0074s
	iters: 300, epoch: 3 | loss: 0.3247184
	speed: 0.1811s/iter; left time: 3436.2510s
	iters: 400, epoch: 3 | loss: 0.2579283
	speed: 0.1922s/iter; left time: 3627.8804s
	iters: 500, epoch: 3 | loss: 0.2559761
	speed: 0.1924s/iter; left time: 3613.1907s
	iters: 600, epoch: 3 | loss: 0.4705286
	speed: 0.1927s/iter; left time: 3600.3626s
	iters: 700, epoch: 3 | loss: 0.3094676
	speed: 0.1911s/iter; left time: 3549.5426s
	iters: 800, epoch: 3 | loss: 0.2929057
	speed: 0.1805s/iter; left time: 3334.9630s
	iters: 900, epoch: 3 | loss: 0.3266667
	speed: 0.1816s/iter; left time: 3337.8273s
	iters: 1000, epoch: 3 | loss: 0.5947376
	speed: 0.1814s/iter; left time: 3315.4215s
Epoch: 3 cost time: 199.24885511398315
Epoch: 3, Steps: 1071 | Train Loss: 0.3674641 Vali Loss: 0.1887329 Test Loss: 0.2716887
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.4318112
	speed: 0.9163s/iter; left time: 16592.5904s
	iters: 200, epoch: 4 | loss: 0.7638361
	speed: 0.1807s/iter; left time: 3253.6349s
	iters: 300, epoch: 4 | loss: 0.3116730
	speed: 0.1802s/iter; left time: 3226.9643s
	iters: 400, epoch: 4 | loss: 0.2359787
	speed: 0.1820s/iter; left time: 3240.6524s
	iters: 500, epoch: 4 | loss: 0.3560342
	speed: 0.1809s/iter; left time: 3203.4296s
	iters: 600, epoch: 4 | loss: 0.1513525
	speed: 0.1840s/iter; left time: 3239.6522s
	iters: 700, epoch: 4 | loss: 0.2231936
	speed: 0.1923s/iter; left time: 3367.3537s
	iters: 800, epoch: 4 | loss: 0.3181823
	speed: 0.1929s/iter; left time: 3357.5449s
	iters: 900, epoch: 4 | loss: 0.3767327
	speed: 0.1944s/iter; left time: 3364.0744s
	iters: 1000, epoch: 4 | loss: 0.2247421
	speed: 0.1840s/iter; left time: 3167.0711s
Epoch: 4 cost time: 199.13546085357666
Epoch: 4, Steps: 1071 | Train Loss: 0.3674032 Vali Loss: 0.1886507 Test Loss: 0.2716554
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_n5_ETTm2_96_192_B6autoformer_ETTm2_ftM_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.2720625102519989, mae:0.33123987913131714
Args in experiment:
Namespace(is_training=1, model_id='E3k_n5_ETTm2_96_336', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints2/', seq_len=96, label_len=48, pred_len=336, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=5, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
>>>>>>>start training : E3k_n5_ETTm2_96_336_B6autoformer_ETTm2_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
	iters: 100, epoch: 1 | loss: 0.8398501
	speed: 0.2601s/iter; left time: 5520.0724s
	iters: 200, epoch: 1 | loss: 0.4468381
	speed: 0.2299s/iter; left time: 4855.4451s
	iters: 300, epoch: 1 | loss: 39.9219971
	speed: 0.2312s/iter; left time: 4859.2223s
	iters: 400, epoch: 1 | loss: 0.4557381
	speed: 0.2287s/iter; left time: 4783.9897s
	iters: 500, epoch: 1 | loss: 0.3033820
	speed: 0.2331s/iter; left time: 4854.1802s
	iters: 600, epoch: 1 | loss: 0.3577186
	speed: 0.2323s/iter; left time: 4812.6257s
	iters: 700, epoch: 1 | loss: 0.7385039
	speed: 0.2337s/iter; left time: 4819.5301s
	iters: 800, epoch: 1 | loss: 0.7997335
	speed: 0.2333s/iter; left time: 4786.6102s
	iters: 900, epoch: 1 | loss: 0.2661800
	speed: 0.2321s/iter; left time: 4738.8120s
	iters: 1000, epoch: 1 | loss: 0.3556292
	speed: 0.2325s/iter; left time: 4724.4597s
Epoch: 1 cost time: 250.3320562839508
Epoch: 1, Steps: 1066 | Train Loss: 8.9251545 Vali Loss: 0.2308848 Test Loss: 0.3308974
Validation loss decreased (inf --> 0.230885).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6853387
	speed: 1.1268s/iter; left time: 22711.5135s
	iters: 200, epoch: 2 | loss: 0.3814417
	speed: 0.2308s/iter; left time: 4629.2344s
	iters: 300, epoch: 2 | loss: 0.1345569
	speed: 0.2298s/iter; left time: 4586.3742s
	iters: 400, epoch: 2 | loss: 0.3399241
	speed: 0.2335s/iter; left time: 4636.2906s
	iters: 500, epoch: 2 | loss: 0.4500239
	speed: 0.2346s/iter; left time: 4635.3991s
	iters: 600, epoch: 2 | loss: 0.1739323
	speed: 0.2347s/iter; left time: 4613.8480s
	iters: 700, epoch: 2 | loss: 0.2622896
	speed: 0.2318s/iter; left time: 4533.4242s
	iters: 800, epoch: 2 | loss: 0.1606515
	speed: 0.2326s/iter; left time: 4524.2652s
	iters: 900, epoch: 2 | loss: 0.2814454
	speed: 0.2308s/iter; left time: 4466.5884s
	iters: 1000, epoch: 2 | loss: 0.3190296
	speed: 0.2321s/iter; left time: 4469.4932s
Epoch: 2 cost time: 248.49780297279358
Epoch: 2, Steps: 1066 | Train Loss: 0.4542053 Vali Loss: 0.2326204 Test Loss: 0.3336912
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.8617798
	speed: 1.1290s/iter; left time: 21550.7796s
	iters: 200, epoch: 3 | loss: 0.6079444
	speed: 0.2320s/iter; left time: 4405.9814s
	iters: 300, epoch: 3 | loss: 0.2839629
	speed: 0.2325s/iter; left time: 4390.9215s
	iters: 400, epoch: 3 | loss: 0.3772762
	speed: 0.2339s/iter; left time: 4395.6362s
	iters: 500, epoch: 3 | loss: 0.2318010
	speed: 0.2330s/iter; left time: 4355.0181s
	iters: 600, epoch: 3 | loss: 0.3730918
	speed: 0.2307s/iter; left time: 4289.1627s
	iters: 700, epoch: 3 | loss: 0.3036914
	speed: 0.2312s/iter; left time: 4274.6102s
	iters: 800, epoch: 3 | loss: 0.1934804
	speed: 0.2290s/iter; left time: 4210.2504s
	iters: 900, epoch: 3 | loss: 0.3507658
	speed: 0.2327s/iter; left time: 4256.0639s
	iters: 1000, epoch: 3 | loss: 0.9372559
	speed: 0.2288s/iter; left time: 4161.6798s
Epoch: 3 cost time: 247.9710774421692
Epoch: 3, Steps: 1066 | Train Loss: 0.4476646 Vali Loss: 0.2434068 Test Loss: 0.3567773
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.8090532
	speed: 1.1294s/iter; left time: 20355.8903s
	iters: 200, epoch: 4 | loss: 0.2800106
	speed: 0.2340s/iter; left time: 4194.1946s
	iters: 300, epoch: 4 | loss: 0.3720468
	speed: 0.2357s/iter; left time: 4201.5564s
	iters: 400, epoch: 4 | loss: 0.3054017
	speed: 0.2333s/iter; left time: 4133.9086s
	iters: 500, epoch: 4 | loss: 1.0987831
	speed: 0.2332s/iter; left time: 4110.5393s
	iters: 600, epoch: 4 | loss: 0.4665357
	speed: 0.2309s/iter; left time: 4045.4442s
	iters: 700, epoch: 4 | loss: 0.4767796
	speed: 0.2310s/iter; left time: 4025.5358s
	iters: 800, epoch: 4 | loss: 0.7956599
	speed: 0.2303s/iter; left time: 3988.8860s
	iters: 900, epoch: 4 | loss: 0.4166168
	speed: 0.2309s/iter; left time: 3976.6796s
	iters: 1000, epoch: 4 | loss: 0.5871816
	speed: 0.2321s/iter; left time: 3974.1487s
Epoch: 4 cost time: 248.460102558136
Epoch: 4, Steps: 1066 | Train Loss: 0.4403265 Vali Loss: 0.2655582 Test Loss: 0.3937657
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : E3k_n5_ETTm2_96_336_B6autoformer_ETTm2_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3311847150325775, mae:0.3688230514526367
Test learner: 0 test 11185
mse:0.3689749836921692, mae:0.40418973565101624
Test learner: 1 test 11185
mse:0.4122674763202667, mae:0.4418430030345917
Test learner: 2 test 11185
mse:0.3503898084163666, mae:0.38814571499824524
Test learner: 3 test 11185
mse:0.4996047019958496, mae:0.49637672305107117
Test learner: 4 test 11185
mse:0.4264259338378906, mae:0.46543243527412415
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training URT: E3k_n5_ETTm2_96_336_B6autoformer_ETTm2_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.3789675
	speed: 0.2407s/iter; left time: 5108.6435s
	iters: 200, epoch: 1 | loss: 0.3776048
	speed: 0.2303s/iter; left time: 4863.2223s
	iters: 300, epoch: 1 | loss: 0.1992808
	speed: 0.2301s/iter; left time: 4836.4681s
	iters: 400, epoch: 1 | loss: 0.3661772
	speed: 0.2318s/iter; left time: 4849.0937s
	iters: 500, epoch: 1 | loss: 0.2852780
	speed: 0.2321s/iter; left time: 4832.0726s
	iters: 600, epoch: 1 | loss: 0.2031485
	speed: 0.2332s/iter; left time: 4832.6406s
	iters: 700, epoch: 1 | loss: 0.5214518
	speed: 0.2450s/iter; left time: 5052.7932s
	iters: 800, epoch: 1 | loss: 0.3809503
	speed: 0.2446s/iter; left time: 5019.2806s
	iters: 900, epoch: 1 | loss: 0.6231817
	speed: 0.2449s/iter; left time: 5000.5231s
	iters: 1000, epoch: 1 | loss: 0.4393005
	speed: 0.2415s/iter; left time: 4907.6633s
Epoch: 1 cost time: 252.92247366905212
Update Best URT params
Epoch: 1, Steps: 1066 | Train Loss: 0.4577884 Vali Loss: 0.2307242 Test Loss: 0.3307845
Validation loss decreased (inf --> 0.230724).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5537404
	speed: 1.0899s/iter; left time: 21966.2278s
	iters: 200, epoch: 2 | loss: 0.2535877
	speed: 0.2231s/iter; left time: 4474.4059s
	iters: 300, epoch: 2 | loss: 0.2934312
	speed: 0.2228s/iter; left time: 4445.8355s
	iters: 400, epoch: 2 | loss: 0.3884154
	speed: 0.2231s/iter; left time: 4429.8389s
	iters: 500, epoch: 2 | loss: 0.4865924
	speed: 0.2237s/iter; left time: 4418.6056s
	iters: 600, epoch: 2 | loss: 0.4558860
	speed: 0.2226s/iter; left time: 4374.4900s
	iters: 700, epoch: 2 | loss: 0.6296557
	speed: 0.2236s/iter; left time: 4372.6743s
	iters: 800, epoch: 2 | loss: 0.3625230
	speed: 0.2246s/iter; left time: 4369.0425s
	iters: 900, epoch: 2 | loss: 0.6133737
	speed: 0.2227s/iter; left time: 4310.2204s
	iters: 1000, epoch: 2 | loss: 0.3293109
	speed: 0.2236s/iter; left time: 4304.8134s
Epoch: 2 cost time: 240.0532054901123
Update Best URT params
Epoch: 2, Steps: 1066 | Train Loss: 0.4569851 Vali Loss: 0.2306493 Test Loss: 0.3306099
Validation loss decreased (0.230724 --> 0.230649).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3716322
	speed: 1.1921s/iter; left time: 22755.9545s
	iters: 200, epoch: 3 | loss: 0.5577519
	speed: 0.2238s/iter; left time: 4249.4517s
	iters: 300, epoch: 3 | loss: 0.5934547
	speed: 0.2244s/iter; left time: 4238.4694s
	iters: 400, epoch: 3 | loss: 0.5193415
	speed: 0.2251s/iter; left time: 4230.2126s
	iters: 500, epoch: 3 | loss: 0.4340514
	speed: 0.2235s/iter; left time: 4177.3512s
	iters: 600, epoch: 3 | loss: 0.2697897
	speed: 0.2244s/iter; left time: 4170.7613s
	iters: 700, epoch: 3 | loss: 0.4182391
	speed: 0.2256s/iter; left time: 4171.7786s
	iters: 800, epoch: 3 | loss: 0.2957513
	speed: 0.2236s/iter; left time: 4111.5659s
	iters: 900, epoch: 3 | loss: 0.7527613
	speed: 0.2251s/iter; left time: 4116.5130s
	iters: 1000, epoch: 3 | loss: 0.3179748
	speed: 0.2250s/iter; left time: 4092.3296s
Epoch: 3 cost time: 240.2253634929657
Update Best URT params
Epoch: 3, Steps: 1066 | Train Loss: 0.4567658 Vali Loss: 0.2301449 Test Loss: 0.3307763
Validation loss decreased (0.230649 --> 0.230145).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2842844
	speed: 1.1443s/iter; left time: 20623.3036s
	iters: 200, epoch: 4 | loss: 0.1638057
	speed: 0.2395s/iter; left time: 4291.9795s
	iters: 300, epoch: 4 | loss: 0.3652956
	speed: 0.2303s/iter; left time: 4104.5437s
	iters: 400, epoch: 4 | loss: 0.2713494
	speed: 0.2221s/iter; left time: 3937.0078s
	iters: 500, epoch: 4 | loss: 0.7714707
	speed: 0.2220s/iter; left time: 3912.0826s
	iters: 600, epoch: 4 | loss: 0.4342982
	speed: 0.2214s/iter; left time: 3879.6043s
	iters: 700, epoch: 4 | loss: 0.4469022
	speed: 0.2215s/iter; left time: 3859.9264s
	iters: 800, epoch: 4 | loss: 0.4662029
	speed: 0.2223s/iter; left time: 3851.2721s
	iters: 900, epoch: 4 | loss: 0.4981282
	speed: 0.2223s/iter; left time: 3828.7852s
	iters: 1000, epoch: 4 | loss: 0.2469653
	speed: 0.2232s/iter; left time: 3821.6270s
Epoch: 4 cost time: 242.175142288208
Epoch: 4, Steps: 1066 | Train Loss: 0.4566415 Vali Loss: 0.2303462 Test Loss: 0.3305557
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.3468415
	speed: 1.0746s/iter; left time: 18222.8303s
	iters: 200, epoch: 5 | loss: 0.5246753
	speed: 0.2324s/iter; left time: 3918.2037s
	iters: 300, epoch: 5 | loss: 0.2381973
	speed: 0.2389s/iter; left time: 4003.3317s
	iters: 400, epoch: 5 | loss: 0.7615460
	speed: 0.2384s/iter; left time: 3971.7207s
	iters: 500, epoch: 5 | loss: 0.3372653
	speed: 0.2380s/iter; left time: 3940.9445s
	iters: 600, epoch: 5 | loss: 0.6288229
	speed: 0.2226s/iter; left time: 3662.7374s
	iters: 700, epoch: 5 | loss: 0.3920215
	speed: 0.2210s/iter; left time: 3615.5234s
	iters: 800, epoch: 5 | loss: 0.3028374
	speed: 0.2217s/iter; left time: 3604.3966s
	iters: 900, epoch: 5 | loss: 0.3109873
	speed: 0.2213s/iter; left time: 3576.0792s
	iters: 1000, epoch: 5 | loss: 0.3935095
	speed: 0.2221s/iter; left time: 3565.7567s
Epoch: 5 cost time: 243.51616096496582
Epoch: 5, Steps: 1066 | Train Loss: 0.4568947 Vali Loss: 0.2310935 Test Loss: 0.3309524
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.4534298
	speed: 1.0816s/iter; left time: 17186.9416s
	iters: 200, epoch: 6 | loss: 0.3694023
	speed: 0.2213s/iter; left time: 3495.1742s
	iters: 300, epoch: 6 | loss: 0.2962864
	speed: 0.2229s/iter; left time: 3498.2794s
	iters: 400, epoch: 6 | loss: 0.5569847
	speed: 0.2223s/iter; left time: 3465.8219s
	iters: 500, epoch: 6 | loss: 0.5290323
	speed: 0.2382s/iter; left time: 3689.3864s
	iters: 600, epoch: 6 | loss: 0.2768176
	speed: 0.2380s/iter; left time: 3663.3233s
	iters: 700, epoch: 6 | loss: 0.2822424
	speed: 0.2379s/iter; left time: 3638.4401s
	iters: 800, epoch: 6 | loss: 0.2602262
	speed: 0.2326s/iter; left time: 3533.9645s
	iters: 900, epoch: 6 | loss: 0.9179808
	speed: 0.2219s/iter; left time: 3347.9955s
	iters: 1000, epoch: 6 | loss: 0.7267448
	speed: 0.2218s/iter; left time: 3325.5726s
Epoch: 6 cost time: 243.55075764656067
Epoch: 6, Steps: 1066 | Train Loss: 0.4569297 Vali Loss: 0.2306185 Test Loss: 0.3306631
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_n5_ETTm2_96_336_B6autoformer_ETTm2_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.33106333017349243, mae:0.3686935007572174
Args in experiment:
Namespace(is_training=1, model_id='E3k_n5_ETTm2_96_720', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints3/', seq_len=96, label_len=48, pred_len=720, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=5, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
>>>>>>>start training : E3k_n5_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
	iters: 100, epoch: 1 | loss: 0.4562942
	speed: 0.3741s/iter; left time: 7849.1694s
	iters: 200, epoch: 1 | loss: 0.7336737
	speed: 0.3469s/iter; left time: 7243.9286s
	iters: 300, epoch: 1 | loss: 0.6627861
	speed: 0.3467s/iter; left time: 7204.7139s
	iters: 400, epoch: 1 | loss: 0.5166867
	speed: 0.3462s/iter; left time: 7158.9736s
	iters: 500, epoch: 1 | loss: 0.5522778
	speed: 0.3469s/iter; left time: 7140.0616s
	iters: 600, epoch: 1 | loss: 0.7042168
	speed: 0.3486s/iter; left time: 7138.8716s
	iters: 700, epoch: 1 | loss: 0.3337062
	speed: 0.3507s/iter; left time: 7147.9548s
	iters: 800, epoch: 1 | loss: 0.3966421
	speed: 0.3529s/iter; left time: 7156.5709s
	iters: 900, epoch: 1 | loss: 0.6428813
	speed: 0.3529s/iter; left time: 7122.3613s
	iters: 1000, epoch: 1 | loss: 0.8458796
	speed: 0.3512s/iter; left time: 7053.0610s
Epoch: 1 cost time: 370.6808145046234
Epoch: 1, Steps: 1054 | Train Loss: 15.4272435 Vali Loss: 0.3070028 Test Loss: 0.4359467
Validation loss decreased (inf --> 0.307003).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4719308
	speed: 1.8946s/iter; left time: 37753.0823s
	iters: 200, epoch: 2 | loss: 0.7627966
	speed: 0.3465s/iter; left time: 6869.9314s
	iters: 300, epoch: 2 | loss: 0.3760763
	speed: 0.3466s/iter; left time: 6837.0285s
	iters: 400, epoch: 2 | loss: 0.9181365
	speed: 0.3470s/iter; left time: 6810.0113s
	iters: 500, epoch: 2 | loss: 0.3759584
	speed: 0.3472s/iter; left time: 6780.2242s
	iters: 600, epoch: 2 | loss: 0.5929093
	speed: 0.3470s/iter; left time: 6740.2971s
	iters: 700, epoch: 2 | loss: 0.7729009
	speed: 0.3472s/iter; left time: 6709.6793s
	iters: 800, epoch: 2 | loss: 0.7140903
	speed: 0.3463s/iter; left time: 6657.7847s
	iters: 900, epoch: 2 | loss: 0.3941893
	speed: 0.3475s/iter; left time: 6647.4120s
	iters: 1000, epoch: 2 | loss: 0.6871896
	speed: 0.3451s/iter; left time: 6565.4598s
Epoch: 2 cost time: 366.25574111938477
Epoch: 2, Steps: 1054 | Train Loss: 0.5918048 Vali Loss: 0.3061736 Test Loss: 0.4341142
Validation loss decreased (0.307003 --> 0.306174).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4711823
	speed: 1.8497s/iter; left time: 34908.8999s
	iters: 200, epoch: 3 | loss: 0.4244485
	speed: 0.3467s/iter; left time: 6509.4399s
	iters: 300, epoch: 3 | loss: 0.6861237
	speed: 0.3473s/iter; left time: 6484.4539s
	iters: 400, epoch: 3 | loss: 0.6153947
	speed: 0.3459s/iter; left time: 6424.8054s
	iters: 500, epoch: 3 | loss: 0.4223175
	speed: 0.3467s/iter; left time: 6404.4830s
	iters: 600, epoch: 3 | loss: 0.7045521
	speed: 0.3481s/iter; left time: 6395.8980s
	iters: 700, epoch: 3 | loss: 0.4862030
	speed: 0.3472s/iter; left time: 6344.5064s
	iters: 800, epoch: 3 | loss: 0.6612745
	speed: 0.3452s/iter; left time: 6273.4071s
	iters: 900, epoch: 3 | loss: 0.5045480
	speed: 0.3454s/iter; left time: 6243.1079s
	iters: 1000, epoch: 3 | loss: 0.6813381
	speed: 0.3464s/iter; left time: 6225.4837s
Epoch: 3 cost time: 366.4773545265198
Epoch: 3, Steps: 1054 | Train Loss: 0.5832442 Vali Loss: 0.2993420 Test Loss: 0.4349935
Validation loss decreased (0.306174 --> 0.299342).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3600332
	speed: 1.9156s/iter; left time: 34134.8865s
	iters: 200, epoch: 4 | loss: 0.5980244
	speed: 0.3454s/iter; left time: 6120.9541s
	iters: 300, epoch: 4 | loss: 0.5750649
	speed: 0.3468s/iter; left time: 6111.0884s
	iters: 400, epoch: 4 | loss: 0.4717786
	speed: 0.3474s/iter; left time: 6085.5314s
	iters: 500, epoch: 4 | loss: 0.7718481
	speed: 0.3477s/iter; left time: 6057.4380s
	iters: 600, epoch: 4 | loss: 0.8694696
	speed: 0.3463s/iter; left time: 5997.0223s
	iters: 700, epoch: 4 | loss: 0.3238518
	speed: 0.3462s/iter; left time: 5960.7354s
	iters: 800, epoch: 4 | loss: 0.3566153
	speed: 0.3479s/iter; left time: 5956.0433s
	iters: 900, epoch: 4 | loss: 0.8926256
	speed: 0.3446s/iter; left time: 5865.2250s
	iters: 1000, epoch: 4 | loss: 0.6301209
	speed: 0.3455s/iter; left time: 5845.5783s
Epoch: 4 cost time: 365.95806407928467
Epoch: 4, Steps: 1054 | Train Loss: 0.5793321 Vali Loss: 0.3137601 Test Loss: 0.4424868
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.8930950
	speed: 1.8258s/iter; left time: 30608.7848s
	iters: 200, epoch: 5 | loss: 0.2652473
	speed: 0.3444s/iter; left time: 5738.6473s
	iters: 300, epoch: 5 | loss: 0.5331027
	speed: 0.3459s/iter; left time: 5729.3550s
	iters: 400, epoch: 5 | loss: 0.2214586
	speed: 0.3463s/iter; left time: 5702.5374s
	iters: 500, epoch: 5 | loss: 0.3336968
	speed: 0.3470s/iter; left time: 5678.1146s
	iters: 600, epoch: 5 | loss: 0.5598698
	speed: 0.3467s/iter; left time: 5638.9410s
	iters: 700, epoch: 5 | loss: 0.3612506
	speed: 0.3476s/iter; left time: 5618.3001s
	iters: 800, epoch: 5 | loss: 0.7223442
	speed: 0.3493s/iter; left time: 5611.9361s
	iters: 900, epoch: 5 | loss: 1.2131360
	speed: 0.3450s/iter; left time: 5507.6241s
	iters: 1000, epoch: 5 | loss: 0.3896226
	speed: 0.3472s/iter; left time: 5508.9209s
Epoch: 5 cost time: 366.0247492790222
Epoch: 5, Steps: 1054 | Train Loss: 0.5744100 Vali Loss: 0.3262947 Test Loss: 0.4558719
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.7320281
	speed: 1.7735s/iter; left time: 27864.2131s
	iters: 200, epoch: 6 | loss: 0.4257062
	speed: 0.3475s/iter; left time: 5424.4854s
	iters: 300, epoch: 6 | loss: 0.3202371
	speed: 0.3471s/iter; left time: 5383.9533s
	iters: 400, epoch: 6 | loss: 0.3643467
	speed: 0.3465s/iter; left time: 5339.9184s
	iters: 500, epoch: 6 | loss: 0.5460787
	speed: 0.3475s/iter; left time: 5320.6170s
	iters: 600, epoch: 6 | loss: 0.6811352
	speed: 0.3470s/iter; left time: 5278.8311s
	iters: 700, epoch: 6 | loss: 0.4515725
	speed: 0.3497s/iter; left time: 5284.2771s
	iters: 800, epoch: 6 | loss: 0.9339322
	speed: 0.3493s/iter; left time: 5242.8904s
	iters: 900, epoch: 6 | loss: 0.6733888
	speed: 0.3511s/iter; left time: 5235.1599s
	iters: 1000, epoch: 6 | loss: 0.6681592
	speed: 0.3503s/iter; left time: 5188.8874s
Epoch: 6 cost time: 368.02521681785583
Epoch: 6, Steps: 1054 | Train Loss: 0.5685646 Vali Loss: 0.3309835 Test Loss: 0.4537988
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : E3k_n5_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4345947504043579, mae:0.427758127450943
Test learner: 0 test 10801
mse:0.7815518379211426, mae:0.634992778301239
Test learner: 1 test 10801
mse:0.48334845900535583, mae:0.46610626578330994
Test learner: 2 test 10801
mse:0.6558194756507874, mae:0.5827584862709045
Test learner: 3 test 10801
mse:0.5688399076461792, mae:0.5207208395004272
Test learner: 4 test 10801
mse:0.6558362245559692, mae:0.5298032760620117
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 5 learners of Autoformer
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training URT: E3k_n5_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.5887305
	speed: 0.4211s/iter; left time: 8836.0293s
	iters: 200, epoch: 1 | loss: 0.7703911
	speed: 0.4232s/iter; left time: 8837.2743s
	iters: 300, epoch: 1 | loss: 1.0508139
	speed: 0.4319s/iter; left time: 8975.8672s
	iters: 400, epoch: 1 | loss: 0.6436939
	speed: 0.4319s/iter; left time: 8932.5122s
	iters: 500, epoch: 1 | loss: 0.3580389
	speed: 0.4326s/iter; left time: 8903.5590s
	iters: 600, epoch: 1 | loss: 0.3209789
	speed: 0.4172s/iter; left time: 8543.7815s
	iters: 700, epoch: 1 | loss: 1.0774918
	speed: 0.4167s/iter; left time: 8492.7599s
	iters: 800, epoch: 1 | loss: 1.0627766
	speed: 0.4185s/iter; left time: 8488.0766s
	iters: 900, epoch: 1 | loss: 0.4037408
	speed: 0.4171s/iter; left time: 8417.0934s
	iters: 1000, epoch: 1 | loss: 0.5301122
	speed: 0.4178s/iter; left time: 8390.0641s
Epoch: 1 cost time: 445.5326762199402
Update Best URT params
Epoch: 1, Steps: 1054 | Train Loss: 0.5903715 Vali Loss: 0.2988644 Test Loss: 0.4345359
Validation loss decreased (inf --> 0.298864).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4663539
	speed: 2.0434s/iter; left time: 40718.1275s
	iters: 200, epoch: 2 | loss: 0.2717853
	speed: 0.4229s/iter; left time: 8385.5238s
	iters: 300, epoch: 2 | loss: 0.5516385
	speed: 0.4295s/iter; left time: 8473.6238s
	iters: 400, epoch: 2 | loss: 0.4325483
	speed: 0.4293s/iter; left time: 8426.1647s
	iters: 500, epoch: 2 | loss: 0.3996492
	speed: 0.4267s/iter; left time: 8332.3873s
	iters: 600, epoch: 2 | loss: 0.7219191
	speed: 0.4144s/iter; left time: 8049.6191s
	iters: 700, epoch: 2 | loss: 0.2946893
	speed: 0.4141s/iter; left time: 8003.1977s
	iters: 800, epoch: 2 | loss: 0.8286625
	speed: 0.4125s/iter; left time: 7931.9653s
	iters: 900, epoch: 2 | loss: 0.5513116
	speed: 0.4146s/iter; left time: 7929.3783s
	iters: 1000, epoch: 2 | loss: 0.5918643
	speed: 0.4122s/iter; left time: 7842.9493s
Epoch: 2 cost time: 442.2411081790924
Epoch: 2, Steps: 1054 | Train Loss: 0.5894447 Vali Loss: 0.3000945 Test Loss: 0.4353070
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.9683005
	speed: 1.9611s/iter; left time: 37012.6508s
	iters: 200, epoch: 3 | loss: 0.3811944
	speed: 0.4227s/iter; left time: 7935.5708s
	iters: 300, epoch: 3 | loss: 0.4864131
	speed: 0.4327s/iter; left time: 8079.6531s
	iters: 400, epoch: 3 | loss: 0.5735767
	speed: 0.4314s/iter; left time: 8013.1712s
	iters: 500, epoch: 3 | loss: 0.3035050
	speed: 0.4328s/iter; left time: 7995.4951s
	iters: 600, epoch: 3 | loss: 0.5440041
	speed: 0.4172s/iter; left time: 7665.4027s
	iters: 700, epoch: 3 | loss: 0.4377822
	speed: 0.4164s/iter; left time: 7608.2347s
	iters: 800, epoch: 3 | loss: 0.7297618
	speed: 0.4166s/iter; left time: 7570.1549s
	iters: 900, epoch: 3 | loss: 1.0569063
	speed: 0.4157s/iter; left time: 7512.8086s
	iters: 1000, epoch: 3 | loss: 0.5936944
	speed: 0.4155s/iter; left time: 7468.3420s
Epoch: 3 cost time: 445.24594235420227
Epoch: 3, Steps: 1054 | Train Loss: 0.5892770 Vali Loss: 0.3007573 Test Loss: 0.4352401
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5344491
	speed: 2.0465s/iter; left time: 36465.7620s
	iters: 200, epoch: 4 | loss: 0.5959343
	speed: 0.4211s/iter; left time: 7460.7355s
	iters: 300, epoch: 4 | loss: 0.7709497
	speed: 0.4284s/iter; left time: 7547.3907s
	iters: 400, epoch: 4 | loss: 0.6013473
	speed: 0.4319s/iter; left time: 7566.9037s
	iters: 500, epoch: 4 | loss: 0.7682961
	speed: 0.4298s/iter; left time: 7486.5190s
	iters: 600, epoch: 4 | loss: 0.4693144
	speed: 0.4297s/iter; left time: 7441.1601s
	iters: 700, epoch: 4 | loss: 0.5941336
	speed: 0.4276s/iter; left time: 7363.4012s
	iters: 800, epoch: 4 | loss: 0.2958402
	speed: 0.4259s/iter; left time: 7290.7159s
	iters: 900, epoch: 4 | loss: 0.8330429
	speed: 0.4276s/iter; left time: 7276.4930s
	iters: 1000, epoch: 4 | loss: 0.3572997
	speed: 0.4253s/iter; left time: 7196.1617s
Epoch: 4 cost time: 450.1996557712555
Epoch: 4, Steps: 1054 | Train Loss: 0.5889523 Vali Loss: 0.2998979 Test Loss: 0.4354135
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_n5_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4341338574886322, mae:0.42712676525115967
