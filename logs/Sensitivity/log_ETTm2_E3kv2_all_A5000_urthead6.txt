Args in experiment:
Namespace(is_training=1, model_id='E3k_ETTm2_96_96', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints0/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=3, n_heads=8, urt_heads=6, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: E3k_ETTm2_96_96_B6autoformer_ETTm2_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34369
val 11425
test 11425
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.2607472
	speed: 0.1325s/iter; left time: 2833.8370s
	iters: 200, epoch: 1 | loss: 0.2458181
	speed: 0.1423s/iter; left time: 3028.8074s
	iters: 300, epoch: 1 | loss: 0.1486244
	speed: 0.1382s/iter; left time: 2927.3365s
	iters: 400, epoch: 1 | loss: 0.2512258
	speed: 0.1413s/iter; left time: 2978.1556s
	iters: 500, epoch: 1 | loss: 0.3581959
	speed: 0.1399s/iter; left time: 2935.8470s
	iters: 600, epoch: 1 | loss: 0.2211120
	speed: 0.1433s/iter; left time: 2992.5998s
	iters: 700, epoch: 1 | loss: 0.2885746
	speed: 0.1457s/iter; left time: 3026.9315s
	iters: 800, epoch: 1 | loss: 0.1945009
	speed: 0.1465s/iter; left time: 3029.8806s
	iters: 900, epoch: 1 | loss: 0.2231731
	speed: 0.1463s/iter; left time: 3010.6935s
	iters: 1000, epoch: 1 | loss: 0.2256477
	speed: 0.1451s/iter; left time: 2970.9533s
Epoch: 1 cost time: 152.93562269210815
Update Best URT params
Epoch: 1, Steps: 1074 | Train Loss: 0.2743847 Vali Loss: 0.1453302 Test Loss: 0.2123725
Validation loss decreased (inf --> 0.145330).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1485376
	speed: 0.6524s/iter; left time: 13248.0028s
	iters: 200, epoch: 2 | loss: 0.2935289
	speed: 0.1446s/iter; left time: 2921.0511s
	iters: 300, epoch: 2 | loss: 0.2741634
	speed: 0.1442s/iter; left time: 2899.8051s
	iters: 400, epoch: 2 | loss: 0.3341559
	speed: 0.1453s/iter; left time: 2907.9344s
	iters: 500, epoch: 2 | loss: 0.1422708
	speed: 0.1455s/iter; left time: 2896.5216s
	iters: 600, epoch: 2 | loss: 0.1593205
	speed: 0.1436s/iter; left time: 2844.0078s
	iters: 700, epoch: 2 | loss: 0.2943817
	speed: 0.1454s/iter; left time: 2865.2417s
	iters: 800, epoch: 2 | loss: 0.2740775
	speed: 0.1455s/iter; left time: 2852.5064s
	iters: 900, epoch: 2 | loss: 0.5028036
	speed: 0.1451s/iter; left time: 2830.3569s
	iters: 1000, epoch: 2 | loss: 0.3508298
	speed: 0.1449s/iter; left time: 2812.0913s
Epoch: 2 cost time: 155.45957612991333
Epoch: 2, Steps: 1074 | Train Loss: 0.2740044 Vali Loss: 0.1454509 Test Loss: 0.2123813
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.2143985
	speed: 0.6544s/iter; left time: 12585.6858s
	iters: 200, epoch: 3 | loss: 0.3704001
	speed: 0.1423s/iter; left time: 2722.5124s
	iters: 300, epoch: 3 | loss: 0.2561880
	speed: 0.1462s/iter; left time: 2782.5478s
	iters: 400, epoch: 3 | loss: 0.1642708
	speed: 0.1458s/iter; left time: 2760.6205s
	iters: 500, epoch: 3 | loss: 0.2489944
	speed: 0.1449s/iter; left time: 2729.2710s
	iters: 600, epoch: 3 | loss: 0.2120069
	speed: 0.1455s/iter; left time: 2726.2448s
	iters: 700, epoch: 3 | loss: 0.2840361
	speed: 0.1448s/iter; left time: 2697.5443s
	iters: 800, epoch: 3 | loss: 0.2607315
	speed: 0.1466s/iter; left time: 2717.5009s
	iters: 900, epoch: 3 | loss: 0.5275579
	speed: 0.1467s/iter; left time: 2704.5658s
	iters: 1000, epoch: 3 | loss: 0.2447554
	speed: 0.1481s/iter; left time: 2715.7380s
Epoch: 3 cost time: 156.38901257514954
Epoch: 3, Steps: 1074 | Train Loss: 0.2740091 Vali Loss: 0.1453480 Test Loss: 0.2123531
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2479733
	speed: 0.6560s/iter; left time: 11912.8256s
	iters: 200, epoch: 4 | loss: 1.0917628
	speed: 0.1448s/iter; left time: 2615.2423s
	iters: 300, epoch: 4 | loss: 0.1544154
	speed: 0.1458s/iter; left time: 2617.6763s
	iters: 400, epoch: 4 | loss: 0.1751821
	speed: 0.1444s/iter; left time: 2578.5280s
	iters: 500, epoch: 4 | loss: 0.2063935
	speed: 0.1437s/iter; left time: 2552.6447s
	iters: 600, epoch: 4 | loss: 0.3015831
	speed: 0.1442s/iter; left time: 2546.0114s
	iters: 700, epoch: 4 | loss: 0.1992348
	speed: 0.1450s/iter; left time: 2545.4828s
	iters: 800, epoch: 4 | loss: 0.1035886
	speed: 0.1442s/iter; left time: 2518.1655s
	iters: 900, epoch: 4 | loss: 0.2825847
	speed: 0.1469s/iter; left time: 2550.4372s
	iters: 1000, epoch: 4 | loss: 0.6330861
	speed: 0.1452s/iter; left time: 2505.4431s
Epoch: 4 cost time: 155.47420954704285
Update Best URT params
Epoch: 4, Steps: 1074 | Train Loss: 0.2738939 Vali Loss: 0.1452847 Test Loss: 0.2123488
Validation loss decreased (0.145330 --> 0.145285).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3905776
	speed: 0.6545s/iter; left time: 11182.5963s
	iters: 200, epoch: 5 | loss: 0.1115427
	speed: 0.1437s/iter; left time: 2440.2197s
	iters: 300, epoch: 5 | loss: 0.1107154
	speed: 0.1458s/iter; left time: 2461.0895s
	iters: 400, epoch: 5 | loss: 0.3663959
	speed: 0.1462s/iter; left time: 2453.9644s
	iters: 500, epoch: 5 | loss: 0.1596173
	speed: 0.1470s/iter; left time: 2452.3560s
	iters: 600, epoch: 5 | loss: 0.2206380
	speed: 0.1443s/iter; left time: 2393.1982s
	iters: 700, epoch: 5 | loss: 0.1325838
	speed: 0.1457s/iter; left time: 2401.1325s
	iters: 800, epoch: 5 | loss: 0.2542754
	speed: 0.1477s/iter; left time: 2419.8937s
	iters: 900, epoch: 5 | loss: 0.2311117
	speed: 0.1457s/iter; left time: 2372.2810s
	iters: 1000, epoch: 5 | loss: 0.1627822
	speed: 0.1451s/iter; left time: 2348.8421s
Epoch: 5 cost time: 156.09296035766602
Epoch: 5, Steps: 1074 | Train Loss: 0.2738874 Vali Loss: 0.1452909 Test Loss: 0.2122752
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.3697652
	speed: 0.6530s/iter; left time: 10454.3892s
	iters: 200, epoch: 6 | loss: 0.3692484
	speed: 0.1458s/iter; left time: 2319.7378s
	iters: 300, epoch: 6 | loss: 0.5206244
	speed: 0.1433s/iter; left time: 2265.0460s
	iters: 400, epoch: 6 | loss: 0.1967689
	speed: 0.1466s/iter; left time: 2303.1307s
	iters: 500, epoch: 6 | loss: 0.1692542
	speed: 0.1440s/iter; left time: 2248.2348s
	iters: 600, epoch: 6 | loss: 0.0985373
	speed: 0.1461s/iter; left time: 2266.5899s
	iters: 700, epoch: 6 | loss: 0.3421013
	speed: 0.1472s/iter; left time: 2268.0602s
	iters: 800, epoch: 6 | loss: 0.4576439
	speed: 0.1434s/iter; left time: 2196.0795s
	iters: 900, epoch: 6 | loss: 0.2007103
	speed: 0.1440s/iter; left time: 2191.0937s
	iters: 1000, epoch: 6 | loss: 0.3091822
	speed: 0.1470s/iter; left time: 2220.7299s
Epoch: 6 cost time: 155.853741645813
Epoch: 6, Steps: 1074 | Train Loss: 0.2738346 Vali Loss: 0.1453020 Test Loss: 0.2123112
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 7 | loss: 0.1334039
	speed: 0.6545s/iter; left time: 9775.8692s
	iters: 200, epoch: 7 | loss: 0.4177764
	speed: 0.1460s/iter; left time: 2166.2621s
	iters: 300, epoch: 7 | loss: 0.2173582
	speed: 0.1430s/iter; left time: 2106.9212s
	iters: 400, epoch: 7 | loss: 0.1329835
	speed: 0.1466s/iter; left time: 2145.3488s
	iters: 500, epoch: 7 | loss: 0.2209952
	speed: 0.1459s/iter; left time: 2120.3547s
	iters: 600, epoch: 7 | loss: 0.2018030
	speed: 0.1445s/iter; left time: 2085.6643s
	iters: 700, epoch: 7 | loss: 0.1781397
	speed: 0.1463s/iter; left time: 2097.6511s
	iters: 800, epoch: 7 | loss: 0.3227287
	speed: 0.1456s/iter; left time: 2073.5083s
	iters: 900, epoch: 7 | loss: 0.2690314
	speed: 0.1458s/iter; left time: 2061.7342s
	iters: 1000, epoch: 7 | loss: 0.2398690
	speed: 0.1452s/iter; left time: 2038.5715s
Epoch: 7 cost time: 155.89596104621887
Update Best URT params
Epoch: 7, Steps: 1074 | Train Loss: 0.2738115 Vali Loss: 0.1452284 Test Loss: 0.2122698
Validation loss decreased (0.145285 --> 0.145228).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7948743
	speed: 0.6562s/iter; left time: 9097.5600s
	iters: 200, epoch: 8 | loss: 0.1975361
	speed: 0.1450s/iter; left time: 1995.0706s
	iters: 300, epoch: 8 | loss: 0.3078566
	speed: 0.1463s/iter; left time: 1998.7047s
	iters: 400, epoch: 8 | loss: 0.2319033
	speed: 0.1440s/iter; left time: 1952.4081s
	iters: 500, epoch: 8 | loss: 0.1597338
	speed: 0.1484s/iter; left time: 1997.8429s
	iters: 600, epoch: 8 | loss: 0.4888365
	speed: 0.1467s/iter; left time: 1960.2158s
	iters: 700, epoch: 8 | loss: 0.3704444
	speed: 0.1429s/iter; left time: 1895.1931s
	iters: 800, epoch: 8 | loss: 0.1624600
	speed: 0.1456s/iter; left time: 1916.8119s
	iters: 900, epoch: 8 | loss: 0.7435054
	speed: 0.1467s/iter; left time: 1916.9140s
	iters: 1000, epoch: 8 | loss: 0.1683803
	speed: 0.1466s/iter; left time: 1900.6832s
Epoch: 8 cost time: 156.24887084960938
Epoch: 8, Steps: 1074 | Train Loss: 0.2737636 Vali Loss: 0.1453108 Test Loss: 0.2122703
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 9 | loss: 0.1925142
	speed: 0.6525s/iter; left time: 8345.3174s
	iters: 200, epoch: 9 | loss: 0.4568487
	speed: 0.1324s/iter; left time: 1679.9341s
	iters: 300, epoch: 9 | loss: 0.1664654
	speed: 0.1105s/iter; left time: 1391.0307s
	iters: 400, epoch: 9 | loss: 0.5219959
	speed: 0.1097s/iter; left time: 1370.0608s
	iters: 500, epoch: 9 | loss: 0.1820858
	speed: 0.1511s/iter; left time: 1872.4646s
	iters: 600, epoch: 9 | loss: 0.2294896
	speed: 0.1506s/iter; left time: 1851.1370s
	iters: 700, epoch: 9 | loss: 0.4318256
	speed: 0.1511s/iter; left time: 1841.9282s
	iters: 800, epoch: 9 | loss: 0.5905629
	speed: 0.1511s/iter; left time: 1826.6574s
	iters: 900, epoch: 9 | loss: 0.1872039
	speed: 0.1512s/iter; left time: 1813.0263s
	iters: 1000, epoch: 9 | loss: 0.1268319
	speed: 0.1508s/iter; left time: 1792.3835s
Epoch: 9 cost time: 151.31128931045532
Epoch: 9, Steps: 1074 | Train Loss: 0.2738152 Vali Loss: 0.1453917 Test Loss: 0.2122825
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 10 | loss: 0.2447058
	speed: 0.7157s/iter; left time: 8384.1536s
	iters: 200, epoch: 10 | loss: 0.1681214
	speed: 0.1520s/iter; left time: 1766.0027s
	iters: 300, epoch: 10 | loss: 0.2277880
	speed: 0.1513s/iter; left time: 1741.9417s
	iters: 400, epoch: 10 | loss: 0.2404307
	speed: 0.1410s/iter; left time: 1609.0731s
	iters: 500, epoch: 10 | loss: 0.1372222
	speed: 0.1410s/iter; left time: 1595.6931s
	iters: 600, epoch: 10 | loss: 0.2159398
	speed: 0.1439s/iter; left time: 1614.3199s
	iters: 700, epoch: 10 | loss: 0.1893941
	speed: 0.1400s/iter; left time: 1555.6108s
	iters: 800, epoch: 10 | loss: 0.1984373
	speed: 0.1512s/iter; left time: 1665.3622s
	iters: 900, epoch: 10 | loss: 0.6881167
	speed: 0.1515s/iter; left time: 1653.4632s
	iters: 1000, epoch: 10 | loss: 0.2274219
	speed: 0.1508s/iter; left time: 1630.9172s
Epoch: 10 cost time: 159.45676255226135
Epoch: 10, Steps: 1074 | Train Loss: 0.2736970 Vali Loss: 0.1453277 Test Loss: 0.2122736
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_ETTm2_96_96_B6autoformer_ETTm2_ftM_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
test shape: (11425, 96, 7) (11425, 96, 7)
mse:0.2126300185918808, mae:0.29512399435043335
Args in experiment:
Namespace(is_training=1, model_id='E3k_ETTm2_96_192', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints1/', seq_len=96, label_len=48, pred_len=192, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=3, n_heads=8, urt_heads=6, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: E3k_ETTm2_96_192_B6autoformer_ETTm2_ftM_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34273
val 11329
test 11329
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.3338597
	speed: 0.2486s/iter; left time: 5301.2333s
	iters: 200, epoch: 1 | loss: 0.1934626
	speed: 0.1972s/iter; left time: 4184.4810s
	iters: 300, epoch: 1 | loss: 0.2760132
	speed: 0.1901s/iter; left time: 4015.1447s
	iters: 400, epoch: 1 | loss: 0.5064260
	speed: 0.1861s/iter; left time: 3912.5355s
	iters: 500, epoch: 1 | loss: 0.3946735
	speed: 0.1812s/iter; left time: 3791.5507s
	iters: 600, epoch: 1 | loss: 0.3228938
	speed: 0.1867s/iter; left time: 3888.0391s
	iters: 700, epoch: 1 | loss: 0.5753089
	speed: 0.1945s/iter; left time: 4030.0215s
	iters: 800, epoch: 1 | loss: 0.5334176
	speed: 0.1988s/iter; left time: 4099.3976s
	iters: 900, epoch: 1 | loss: 0.3024729
	speed: 0.1967s/iter; left time: 4036.4129s
	iters: 1000, epoch: 1 | loss: 0.5534995
	speed: 0.1960s/iter; left time: 4001.8715s
Epoch: 1 cost time: 211.63026332855225
Update Best URT params
Epoch: 1, Steps: 1071 | Train Loss: 0.3633580 Vali Loss: 0.1859640 Test Loss: 0.2699992
Validation loss decreased (inf --> 0.185964).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2272840
	speed: 0.9002s/iter; left time: 18229.1905s
	iters: 200, epoch: 2 | loss: 0.6184326
	speed: 0.1994s/iter; left time: 4018.3526s
	iters: 300, epoch: 2 | loss: 0.4806197
	speed: 0.1893s/iter; left time: 3795.3909s
	iters: 400, epoch: 2 | loss: 0.3964974
	speed: 0.1878s/iter; left time: 3746.0141s
	iters: 500, epoch: 2 | loss: 0.1775737
	speed: 0.1837s/iter; left time: 3647.3517s
	iters: 600, epoch: 2 | loss: 0.4851958
	speed: 0.1864s/iter; left time: 3680.6543s
	iters: 700, epoch: 2 | loss: 0.1587631
	speed: 0.1975s/iter; left time: 3881.6416s
	iters: 800, epoch: 2 | loss: 0.2844555
	speed: 0.1960s/iter; left time: 3831.4837s
	iters: 900, epoch: 2 | loss: 0.2343157
	speed: 0.1979s/iter; left time: 3849.1591s
	iters: 1000, epoch: 2 | loss: 0.4889267
	speed: 0.2012s/iter; left time: 3893.6242s
Epoch: 2 cost time: 208.8589210510254
Update Best URT params
Epoch: 2, Steps: 1071 | Train Loss: 0.3627409 Vali Loss: 0.1858300 Test Loss: 0.2700340
Validation loss decreased (0.185964 --> 0.185830).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5166212
	speed: 0.9054s/iter; left time: 17364.5836s
	iters: 200, epoch: 3 | loss: 0.2001500
	speed: 0.1991s/iter; left time: 3798.3963s
	iters: 300, epoch: 3 | loss: 0.3794989
	speed: 0.1904s/iter; left time: 3614.3720s
	iters: 400, epoch: 3 | loss: 0.2557146
	speed: 0.1859s/iter; left time: 3508.6815s
	iters: 500, epoch: 3 | loss: 0.2922794
	speed: 0.1817s/iter; left time: 3412.7675s
	iters: 600, epoch: 3 | loss: 0.2944546
	speed: 0.1857s/iter; left time: 3469.5930s
	iters: 700, epoch: 3 | loss: 0.5665559
	speed: 0.1950s/iter; left time: 3622.9483s
	iters: 800, epoch: 3 | loss: 0.4434555
	speed: 0.1982s/iter; left time: 3661.6153s
	iters: 900, epoch: 3 | loss: 0.1525110
	speed: 0.1943s/iter; left time: 3570.5550s
	iters: 1000, epoch: 3 | loss: 0.2535514
	speed: 0.1963s/iter; left time: 3588.4410s
Epoch: 3 cost time: 207.3265540599823
Update Best URT params
Epoch: 3, Steps: 1071 | Train Loss: 0.3630083 Vali Loss: 0.1856365 Test Loss: 0.2700005
Validation loss decreased (0.185830 --> 0.185637).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2750305
	speed: 0.9001s/iter; left time: 16298.4641s
	iters: 200, epoch: 4 | loss: 0.1904551
	speed: 0.1953s/iter; left time: 3517.3610s
	iters: 300, epoch: 4 | loss: 0.2644022
	speed: 0.1867s/iter; left time: 3343.4962s
	iters: 400, epoch: 4 | loss: 0.2712466
	speed: 0.1854s/iter; left time: 3300.8221s
	iters: 500, epoch: 4 | loss: 0.1678762
	speed: 0.1817s/iter; left time: 3217.9000s
	iters: 600, epoch: 4 | loss: 0.3963139
	speed: 0.1839s/iter; left time: 3238.1896s
	iters: 700, epoch: 4 | loss: 0.3017224
	speed: 0.1955s/iter; left time: 3423.2892s
	iters: 800, epoch: 4 | loss: 0.1911690
	speed: 0.1950s/iter; left time: 3395.3266s
	iters: 900, epoch: 4 | loss: 0.1538728
	speed: 0.1975s/iter; left time: 3417.6061s
	iters: 1000, epoch: 4 | loss: 0.3018827
	speed: 0.1945s/iter; left time: 3347.2508s
Epoch: 4 cost time: 206.00365018844604
Epoch: 4, Steps: 1071 | Train Loss: 0.3628884 Vali Loss: 0.1858859 Test Loss: 0.2700548
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.6577191
	speed: 0.8991s/iter; left time: 15318.0859s
	iters: 200, epoch: 5 | loss: 0.1786226
	speed: 0.1942s/iter; left time: 3288.6023s
	iters: 300, epoch: 5 | loss: 0.6763297
	speed: 0.1888s/iter; left time: 3179.4495s
	iters: 400, epoch: 5 | loss: 0.2244381
	speed: 0.1849s/iter; left time: 3094.3221s
	iters: 500, epoch: 5 | loss: 0.3477575
	speed: 0.1820s/iter; left time: 3028.5152s
	iters: 600, epoch: 5 | loss: 0.2880211
	speed: 0.1854s/iter; left time: 3066.0021s
	iters: 700, epoch: 5 | loss: 0.5067532
	speed: 0.1977s/iter; left time: 3250.1108s
	iters: 800, epoch: 5 | loss: 0.2955989
	speed: 0.1997s/iter; left time: 3262.7610s
	iters: 900, epoch: 5 | loss: 0.3682293
	speed: 0.2001s/iter; left time: 3248.5182s
	iters: 1000, epoch: 5 | loss: 0.4344473
	speed: 0.1944s/iter; left time: 3136.2914s
Epoch: 5 cost time: 207.53520107269287
Epoch: 5, Steps: 1071 | Train Loss: 0.3629666 Vali Loss: 0.1857672 Test Loss: 0.2699578
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.5094987
	speed: 0.8948s/iter; left time: 14286.9080s
	iters: 200, epoch: 6 | loss: 0.3870978
	speed: 0.1985s/iter; left time: 3149.7123s
	iters: 300, epoch: 6 | loss: 0.1578922
	speed: 0.1897s/iter; left time: 2990.3722s
	iters: 400, epoch: 6 | loss: 0.5536270
	speed: 0.1836s/iter; left time: 2875.5844s
	iters: 500, epoch: 6 | loss: 0.1693816
	speed: 0.1813s/iter; left time: 2822.6364s
	iters: 600, epoch: 6 | loss: 0.1560322
	speed: 0.1834s/iter; left time: 2836.2426s
	iters: 700, epoch: 6 | loss: 0.1807887
	speed: 0.1969s/iter; left time: 3025.6515s
	iters: 800, epoch: 6 | loss: 0.5365131
	speed: 0.1967s/iter; left time: 3003.1853s
	iters: 900, epoch: 6 | loss: 0.3113809
	speed: 0.1971s/iter; left time: 2989.9135s
	iters: 1000, epoch: 6 | loss: 0.2142504
	speed: 0.1946s/iter; left time: 2931.2185s
Epoch: 6 cost time: 206.60678267478943
Update Best URT params
Epoch: 6, Steps: 1071 | Train Loss: 0.3628932 Vali Loss: 0.1856286 Test Loss: 0.2699064
Validation loss decreased (0.185637 --> 0.185629).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2973139
	speed: 0.8976s/iter; left time: 13370.0890s
	iters: 200, epoch: 7 | loss: 0.7763777
	speed: 0.1949s/iter; left time: 2883.4106s
	iters: 300, epoch: 7 | loss: 0.4736777
	speed: 0.1891s/iter; left time: 2778.5849s
	iters: 400, epoch: 7 | loss: 0.3479080
	speed: 0.1845s/iter; left time: 2692.8566s
	iters: 500, epoch: 7 | loss: 0.3778434
	speed: 0.1825s/iter; left time: 2645.3070s
	iters: 600, epoch: 7 | loss: 0.2999905
	speed: 0.1801s/iter; left time: 2592.3827s
	iters: 700, epoch: 7 | loss: 0.3474762
	speed: 0.1719s/iter; left time: 2457.8713s
	iters: 800, epoch: 7 | loss: 0.2893766
	speed: 0.1476s/iter; left time: 2095.1576s
	iters: 900, epoch: 7 | loss: 0.2573297
	speed: 0.1380s/iter; left time: 1944.5683s
	iters: 1000, epoch: 7 | loss: 0.7669685
	speed: 0.1914s/iter; left time: 2678.5387s
Epoch: 7 cost time: 192.05132794380188
Epoch: 7, Steps: 1071 | Train Loss: 0.3627849 Vali Loss: 0.1856765 Test Loss: 0.2699168
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.1726180
	speed: 0.9079s/iter; left time: 12551.3839s
	iters: 200, epoch: 8 | loss: 0.3087541
	speed: 0.1945s/iter; left time: 2669.9552s
	iters: 300, epoch: 8 | loss: 0.3822761
	speed: 0.1920s/iter; left time: 2616.1742s
	iters: 400, epoch: 8 | loss: 0.4744242
	speed: 0.1921s/iter; left time: 2598.1735s
	iters: 500, epoch: 8 | loss: 0.5677637
	speed: 0.1923s/iter; left time: 2580.8171s
	iters: 600, epoch: 8 | loss: 0.2657144
	speed: 0.1923s/iter; left time: 2561.6433s
	iters: 700, epoch: 8 | loss: 0.2149402
	speed: 0.1923s/iter; left time: 2542.5253s
	iters: 800, epoch: 8 | loss: 0.3282910
	speed: 0.1924s/iter; left time: 2525.2017s
	iters: 900, epoch: 8 | loss: 0.1573146
	speed: 0.1919s/iter; left time: 2499.1441s
	iters: 1000, epoch: 8 | loss: 0.3703941
	speed: 0.1847s/iter; left time: 2387.0516s
Epoch: 8 cost time: 205.02575278282166
Epoch: 8, Steps: 1071 | Train Loss: 0.3627595 Vali Loss: 0.1858470 Test Loss: 0.2699685
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 9 | loss: 0.3837752
	speed: 0.8529s/iter; left time: 10877.1000s
	iters: 200, epoch: 9 | loss: 0.3728923
	speed: 0.1923s/iter; left time: 2433.4489s
	iters: 300, epoch: 9 | loss: 0.5106003
	speed: 0.1916s/iter; left time: 2405.4338s
	iters: 400, epoch: 9 | loss: 0.5702431
	speed: 0.1917s/iter; left time: 2387.2319s
	iters: 500, epoch: 9 | loss: 0.4742137
	speed: 0.1920s/iter; left time: 2371.2399s
	iters: 600, epoch: 9 | loss: 0.2479516
	speed: 0.1926s/iter; left time: 2360.1281s
	iters: 700, epoch: 9 | loss: 0.1710697
	speed: 0.1921s/iter; left time: 2334.0339s
	iters: 800, epoch: 9 | loss: 0.5579151
	speed: 0.1913s/iter; left time: 2305.2850s
	iters: 900, epoch: 9 | loss: 0.2443765
	speed: 0.1918s/iter; left time: 2292.6680s
	iters: 1000, epoch: 9 | loss: 0.4050240
	speed: 0.1914s/iter; left time: 2269.0916s
Epoch: 9 cost time: 206.56744241714478
Epoch: 9, Steps: 1071 | Train Loss: 0.3627505 Vali Loss: 0.1856896 Test Loss: 0.2699382
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_ETTm2_96_192_B6autoformer_ETTm2_ftM_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
test shape: (11329, 192, 7) (11329, 192, 7)
mse:0.27035486698150635, mae:0.329696923494339
Args in experiment:
Namespace(is_training=1, model_id='E3k_ETTm2_96_336', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints2/', seq_len=96, label_len=48, pred_len=336, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=3, n_heads=8, urt_heads=6, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: E3k_ETTm2_96_336_B6autoformer_ETTm2_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11185
test 11185
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.2793374
	speed: 0.3672s/iter; left time: 7791.4919s
	iters: 200, epoch: 1 | loss: 0.2780089
	speed: 0.3253s/iter; left time: 6871.3505s
	iters: 300, epoch: 1 | loss: 0.2566095
	speed: 0.3431s/iter; left time: 7211.5048s
	iters: 400, epoch: 1 | loss: 0.4344454
	speed: 0.3546s/iter; left time: 7418.1601s
	iters: 500, epoch: 1 | loss: 0.8826543
	speed: 0.3417s/iter; left time: 7115.2776s
	iters: 600, epoch: 1 | loss: 0.6607392
	speed: 0.3593s/iter; left time: 7445.5632s
	iters: 700, epoch: 1 | loss: 0.8639051
	speed: 0.3616s/iter; left time: 7456.4046s
	iters: 800, epoch: 1 | loss: 0.3167723
	speed: 0.3518s/iter; left time: 7218.9522s
	iters: 900, epoch: 1 | loss: 0.3632735
	speed: 0.3601s/iter; left time: 7353.4678s
	iters: 1000, epoch: 1 | loss: 0.5465137
	speed: 0.3531s/iter; left time: 7176.3150s
Epoch: 1 cost time: 374.4265501499176
Update Best URT params
Epoch: 1, Steps: 1066 | Train Loss: 0.4572590 Vali Loss: 0.2284746 Test Loss: 0.3254027
Validation loss decreased (inf --> 0.228475).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7113400
	speed: 1.5243s/iter; left time: 30721.4481s
	iters: 200, epoch: 2 | loss: 0.2309992
	speed: 0.3162s/iter; left time: 6340.9473s
	iters: 300, epoch: 2 | loss: 0.3052344
	speed: 0.3379s/iter; left time: 6742.2726s
	iters: 400, epoch: 2 | loss: 0.2473952
	speed: 0.3479s/iter; left time: 6907.8284s
	iters: 500, epoch: 2 | loss: 1.0927311
	speed: 0.3400s/iter; left time: 6717.0353s
	iters: 600, epoch: 2 | loss: 0.5753540
	speed: 0.3520s/iter; left time: 6918.1561s
	iters: 700, epoch: 2 | loss: 0.2961568
	speed: 0.3472s/iter; left time: 6788.9411s
	iters: 800, epoch: 2 | loss: 0.3681073
	speed: 0.3524s/iter; left time: 6856.0326s
	iters: 900, epoch: 2 | loss: 0.2277792
	speed: 0.3516s/iter; left time: 6804.8957s
	iters: 1000, epoch: 2 | loss: 0.5672414
	speed: 0.3400s/iter; left time: 6546.6066s
Epoch: 2 cost time: 363.0195457935333
Update Best URT params
Epoch: 2, Steps: 1066 | Train Loss: 0.4569581 Vali Loss: 0.2279530 Test Loss: 0.3254612
Validation loss decreased (0.228475 --> 0.227953).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4388934
	speed: 1.5576s/iter; left time: 29733.3927s
	iters: 200, epoch: 3 | loss: 0.3441891
	speed: 0.3261s/iter; left time: 6192.2914s
	iters: 300, epoch: 3 | loss: 0.7064166
	speed: 0.3363s/iter; left time: 6352.2328s
	iters: 400, epoch: 3 | loss: 0.5942819
	speed: 0.3520s/iter; left time: 6613.4968s
	iters: 500, epoch: 3 | loss: 0.2197739
	speed: 0.3492s/iter; left time: 6526.1814s
	iters: 600, epoch: 3 | loss: 0.3489723
	speed: 0.3548s/iter; left time: 6594.7620s
	iters: 700, epoch: 3 | loss: 0.2717777
	speed: 0.3538s/iter; left time: 6541.3022s
	iters: 800, epoch: 3 | loss: 0.3755989
	speed: 0.3613s/iter; left time: 6644.7298s
	iters: 900, epoch: 3 | loss: 0.2927892
	speed: 0.3482s/iter; left time: 6369.0943s
	iters: 1000, epoch: 3 | loss: 0.7141171
	speed: 0.3537s/iter; left time: 6432.6106s
Epoch: 3 cost time: 370.3378167152405
Epoch: 3, Steps: 1066 | Train Loss: 0.4567791 Vali Loss: 0.2280138 Test Loss: 0.3253273
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.5315894
	speed: 1.5471s/iter; left time: 27883.2233s
	iters: 200, epoch: 4 | loss: 0.4456330
	speed: 0.3189s/iter; left time: 5716.1704s
	iters: 300, epoch: 4 | loss: 0.2147075
	speed: 0.3667s/iter; left time: 6536.5130s
	iters: 400, epoch: 4 | loss: 0.1860065
	speed: 0.3635s/iter; left time: 6442.1908s
	iters: 500, epoch: 4 | loss: 0.3117828
	speed: 0.3628s/iter; left time: 6394.5047s
	iters: 600, epoch: 4 | loss: 0.4719670
	speed: 0.3748s/iter; left time: 6568.0719s
	iters: 700, epoch: 4 | loss: 0.3207492
	speed: 0.3429s/iter; left time: 5975.1724s
	iters: 800, epoch: 4 | loss: 0.4294744
	speed: 0.3567s/iter; left time: 6178.4916s
	iters: 900, epoch: 4 | loss: 0.2539077
	speed: 0.3486s/iter; left time: 6003.1759s
	iters: 1000, epoch: 4 | loss: 0.3724568
	speed: 0.3476s/iter; left time: 5952.7713s
Epoch: 4 cost time: 373.2939054965973
Epoch: 4, Steps: 1066 | Train Loss: 0.4565696 Vali Loss: 0.2287777 Test Loss: 0.3256938
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.5431372
	speed: 1.5505s/iter; left time: 26292.4439s
	iters: 200, epoch: 5 | loss: 0.4305657
	speed: 0.3225s/iter; left time: 5435.9249s
	iters: 300, epoch: 5 | loss: 0.2756877
	speed: 0.3070s/iter; left time: 5144.8740s
	iters: 400, epoch: 5 | loss: 1.2335087
	speed: 0.2757s/iter; left time: 4592.5553s
	iters: 500, epoch: 5 | loss: 0.5805756
	speed: 0.2499s/iter; left time: 4138.2915s
	iters: 600, epoch: 5 | loss: 0.7564583
	speed: 0.3428s/iter; left time: 5641.0613s
	iters: 700, epoch: 5 | loss: 0.5850061
	speed: 0.3433s/iter; left time: 5615.7114s
	iters: 800, epoch: 5 | loss: 0.5973074
	speed: 0.3409s/iter; left time: 5542.3172s
	iters: 900, epoch: 5 | loss: 0.4124521
	speed: 0.3412s/iter; left time: 5512.7645s
	iters: 1000, epoch: 5 | loss: 0.6013101
	speed: 0.3556s/iter; left time: 5709.2997s
Epoch: 5 cost time: 344.4719042778015
Epoch: 5, Steps: 1066 | Train Loss: 0.4566065 Vali Loss: 0.2282148 Test Loss: 0.3256147
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_ETTm2_96_336_B6autoformer_ETTm2_ftM_sl96_ll48_pl336_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
test shape: (11185, 336, 7) (11185, 336, 7)
mse:0.3257565200328827, mae:0.36268332600593567
Args in experiment:
Namespace(is_training=1, model_id='E3k_ETTm2_96_720', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints3/', seq_len=96, label_len=48, pred_len=720, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=3, n_heads=8, urt_heads=6, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: E3k_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
Best MSE: 10000000000.0
Args in experiment:
Namespace(is_training=1, model_id='E3k_ETTm2_96_720', model='B6autoformer', slow_model='AutoformerS1', data='ETTm2', root_path='./dataset/ETT-small/', data_path='ETTm2.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints3/', seq_len=96, label_len=48, pred_len=720, bucket_size=4, n_hashes=4, enc_in=7, dec_in=7, c_out=7, d_model=256, n_learner=3, n_heads=8, urt_heads=6, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=3, learning_rate=0.001, anomaly=10.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
7
Check c_out
7
Check c_out
7
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: E3k_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 10801
test 10801
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.6297635
	speed: 0.3959s/iter; left time: 8305.6921s
	iters: 200, epoch: 1 | loss: 0.5029450
	speed: 0.3706s/iter; left time: 7738.5797s
	iters: 300, epoch: 1 | loss: 0.3962646
	speed: 0.3607s/iter; left time: 7496.4507s
	iters: 400, epoch: 1 | loss: 0.4146921
	speed: 0.3712s/iter; left time: 7676.0143s
	iters: 500, epoch: 1 | loss: 0.6687457
	speed: 0.3697s/iter; left time: 7608.9511s
	iters: 600, epoch: 1 | loss: 0.4493187
	speed: 0.3720s/iter; left time: 7619.0138s
	iters: 700, epoch: 1 | loss: 0.8314864
	speed: 0.3687s/iter; left time: 7515.3246s
	iters: 800, epoch: 1 | loss: 0.2540890
	speed: 0.3798s/iter; left time: 7702.8999s
	iters: 900, epoch: 1 | loss: 0.5054368
	speed: 0.3677s/iter; left time: 7421.0080s
	iters: 1000, epoch: 1 | loss: 0.6757444
	speed: 0.3681s/iter; left time: 7392.4766s
Epoch: 1 cost time: 392.4956934452057
Update Best URT params
Epoch: 1, Steps: 1054 | Train Loss: 0.5994752 Vali Loss: 0.3099185 Test Loss: 0.4360860
Validation loss decreased (inf --> 0.309918).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5571231
	speed: 1.6304s/iter; left time: 32488.5495s
	iters: 200, epoch: 2 | loss: 0.7064550
	speed: 0.3514s/iter; left time: 6966.4596s
	iters: 300, epoch: 2 | loss: 0.8454443
	speed: 0.3478s/iter; left time: 6861.9739s
	iters: 400, epoch: 2 | loss: 0.7611639
	speed: 0.3529s/iter; left time: 6926.9886s
	iters: 500, epoch: 2 | loss: 0.2682593
	speed: 0.3614s/iter; left time: 7056.5738s
	iters: 600, epoch: 2 | loss: 0.4284934
	speed: 0.3551s/iter; left time: 6898.1587s
	iters: 700, epoch: 2 | loss: 0.3456128
	speed: 0.3587s/iter; left time: 6932.8681s
	iters: 800, epoch: 2 | loss: 0.7861348
	speed: 0.3559s/iter; left time: 6843.0851s
	iters: 900, epoch: 2 | loss: 0.8963882
	speed: 0.3505s/iter; left time: 6704.2082s
	iters: 1000, epoch: 2 | loss: 0.7101269
	speed: 0.3528s/iter; left time: 6712.1443s
Epoch: 2 cost time: 374.1593883037567
Epoch: 2, Steps: 1054 | Train Loss: 0.5990292 Vali Loss: 0.3121461 Test Loss: 0.4366685
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.7211283
	speed: 1.5849s/iter; left time: 29912.6475s
	iters: 200, epoch: 3 | loss: 0.6539695
	speed: 0.3630s/iter; left time: 6814.5918s
	iters: 300, epoch: 3 | loss: 0.4219199
	speed: 0.3569s/iter; left time: 6663.9733s
	iters: 400, epoch: 3 | loss: 0.8442730
	speed: 0.3578s/iter; left time: 6646.1907s
	iters: 500, epoch: 3 | loss: 0.3836600
	speed: 0.3629s/iter; left time: 6704.1688s
	iters: 600, epoch: 3 | loss: 0.4097635
	speed: 0.3578s/iter; left time: 6573.8046s
	iters: 700, epoch: 3 | loss: 0.2740742
	speed: 0.3506s/iter; left time: 6407.1160s
	iters: 800, epoch: 3 | loss: 0.3058867
	speed: 0.3562s/iter; left time: 6472.4555s
	iters: 900, epoch: 3 | loss: 0.2680559
	speed: 0.3496s/iter; left time: 6318.0648s
	iters: 1000, epoch: 3 | loss: 0.8136847
	speed: 0.3532s/iter; left time: 6348.2221s
Epoch: 3 cost time: 376.11503553390503
Epoch: 3, Steps: 1054 | Train Loss: 0.5988216 Vali Loss: 0.3114516 Test Loss: 0.4364026
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3027471
	speed: 1.5401s/iter; left time: 27443.2256s
	iters: 200, epoch: 4 | loss: 0.4477345
	speed: 0.3468s/iter; left time: 6145.2868s
	iters: 300, epoch: 4 | loss: 0.7525301
	speed: 0.3589s/iter; left time: 6323.5068s
	iters: 400, epoch: 4 | loss: 0.6032738
	speed: 0.3543s/iter; left time: 6206.5812s
	iters: 500, epoch: 4 | loss: 0.7215650
	speed: 0.3465s/iter; left time: 6035.4371s
	iters: 600, epoch: 4 | loss: 1.1001645
	speed: 0.3488s/iter; left time: 6040.0436s
	iters: 700, epoch: 4 | loss: 0.5120392
	speed: 0.3566s/iter; left time: 6140.9550s
	iters: 800, epoch: 4 | loss: 0.4521703
	speed: 0.3596s/iter; left time: 6156.2586s
	iters: 900, epoch: 4 | loss: 0.3478722
	speed: 0.3472s/iter; left time: 5908.6572s
	iters: 1000, epoch: 4 | loss: 0.8648045
	speed: 0.3585s/iter; left time: 6066.1474s
Epoch: 4 cost time: 373.2199673652649
Epoch: 4, Steps: 1054 | Train Loss: 0.5987042 Vali Loss: 0.3110636 Test Loss: 0.4362747
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : E3k_ETTm2_96_720_B6autoformer_ETTm2_ftM_sl96_ll48_pl720_dm256_nh8_el2_dl1_df2048_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10801
test shape: (10801, 720, 7) (10801, 720, 7)
mse:0.4357007145881653, mae:0.4289773404598236
