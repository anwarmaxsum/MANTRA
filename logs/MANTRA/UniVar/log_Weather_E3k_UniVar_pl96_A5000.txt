Args in experiment:
Namespace(is_training=1, model_id='Weather_E3k_96_96', model='B6autoformer', slow_model='AutoformerS1', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints1/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=1, dec_in=1, c_out=1, d_model=256, n_learner=3, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.01, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=3, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, anomaly=1.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.0020439
	speed: 0.2032s/iter; left time: 2309.1138s
	iters: 200, epoch: 1 | loss: 6.3921175
	speed: 0.1857s/iter; left time: 2091.5902s
	iters: 300, epoch: 1 | loss: 0.0071607
	speed: 0.1780s/iter; left time: 1986.5428s
	iters: 400, epoch: 1 | loss: 2.8450150
	speed: 0.2856s/iter; left time: 3159.3606s
	iters: 500, epoch: 1 | loss: 0.0044668
	speed: 0.3982s/iter; left time: 4364.3633s
	iters: 600, epoch: 1 | loss: 0.4610371
	speed: 0.4052s/iter; left time: 4401.2272s
	iters: 700, epoch: 1 | loss: 0.0112085
	speed: 0.4086s/iter; left time: 4396.8841s
	iters: 800, epoch: 1 | loss: 0.0071336
	speed: 0.4086s/iter; left time: 4355.8395s
	iters: 900, epoch: 1 | loss: 0.0078193
	speed: 0.4049s/iter; left time: 4276.3261s
	iters: 1000, epoch: 1 | loss: 0.0234539
	speed: 0.4004s/iter; left time: 4188.2665s
	iters: 1100, epoch: 1 | loss: 3.8309512
	speed: 0.4115s/iter; left time: 4263.4052s
Epoch: 1 cost time: 387.0703589916229
Epoch: 1, Steps: 1146 | Train Loss: 1.2088698 Vali Loss: 0.0155276 Test Loss: 0.0169884
Validation loss decreased (inf --> 0.015528).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 3.8479199
	speed: 0.9762s/iter; left time: 9972.3740s
	iters: 200, epoch: 2 | loss: 0.0062261
	speed: 0.4075s/iter; left time: 4121.8306s
	iters: 300, epoch: 2 | loss: 0.9376265
	speed: 0.3996s/iter; left time: 4001.5970s
	iters: 400, epoch: 2 | loss: 1.5563802
	speed: 0.3971s/iter; left time: 3937.5123s
	iters: 500, epoch: 2 | loss: 0.0121062
	speed: 0.3985s/iter; left time: 3910.8426s
	iters: 600, epoch: 2 | loss: 3.5827940
	speed: 0.3285s/iter; left time: 3191.2207s
	iters: 700, epoch: 2 | loss: 0.0074762
	speed: 0.2994s/iter; left time: 2878.4268s
	iters: 800, epoch: 2 | loss: 1.2271093
	speed: 0.2993s/iter; left time: 2848.2743s
	iters: 900, epoch: 2 | loss: 0.0091260
	speed: 0.3007s/iter; left time: 2831.2470s
	iters: 1000, epoch: 2 | loss: 0.4167975
	speed: 0.3815s/iter; left time: 3553.4930s
	iters: 1100, epoch: 2 | loss: 0.0111294
	speed: 0.4015s/iter; left time: 3699.3641s
Epoch: 2 cost time: 420.8489592075348
Epoch: 2, Steps: 1146 | Train Loss: 1.1329043 Vali Loss: 0.0096862 Test Loss: 0.0136766
Validation loss decreased (0.015528 --> 0.009686).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0065277
	speed: 0.9856s/iter; left time: 8938.7221s
	iters: 200, epoch: 3 | loss: 0.9560387
	speed: 0.4039s/iter; left time: 3622.2652s
	iters: 300, epoch: 3 | loss: 1.4611073
	speed: 0.3987s/iter; left time: 3535.8566s
	iters: 400, epoch: 3 | loss: 1.2254107
	speed: 0.3922s/iter; left time: 3439.5362s
	iters: 500, epoch: 3 | loss: 0.0073275
	speed: 0.4048s/iter; left time: 3509.4224s
	iters: 600, epoch: 3 | loss: 1.1929618
	speed: 0.4035s/iter; left time: 3457.5448s
	iters: 700, epoch: 3 | loss: 0.0084285
	speed: 0.4001s/iter; left time: 3388.1617s
	iters: 800, epoch: 3 | loss: 0.0135166
	speed: 0.4057s/iter; left time: 3395.1105s
	iters: 900, epoch: 3 | loss: 0.0077469
	speed: 0.3988s/iter; left time: 3297.8525s
	iters: 1000, epoch: 3 | loss: 1.8176033
	speed: 0.4139s/iter; left time: 3381.3184s
	iters: 1100, epoch: 3 | loss: 1.9994011
	speed: 0.3938s/iter; left time: 3177.6347s
Epoch: 3 cost time: 456.7252130508423
Epoch: 3, Steps: 1146 | Train Loss: 1.0732720 Vali Loss: 0.0141542 Test Loss: 0.0122108
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.3097138
	speed: 0.8869s/iter; left time: 7026.6454s
	iters: 200, epoch: 4 | loss: 0.0080319
	speed: 0.3002s/iter; left time: 2348.4422s
	iters: 300, epoch: 4 | loss: 0.0038468
	speed: 0.3907s/iter; left time: 3017.4297s
	iters: 400, epoch: 4 | loss: 2.0733957
	speed: 0.4057s/iter; left time: 3092.2735s
	iters: 500, epoch: 4 | loss: 0.3552189
	speed: 0.4010s/iter; left time: 3016.8111s
	iters: 600, epoch: 4 | loss: 0.1589790
	speed: 0.4039s/iter; left time: 2998.2874s
	iters: 700, epoch: 4 | loss: 6.2223120
	speed: 0.4038s/iter; left time: 2956.9250s
	iters: 800, epoch: 4 | loss: 0.0044490
	speed: 0.3997s/iter; left time: 2886.7405s
	iters: 900, epoch: 4 | loss: 0.0053970
	speed: 0.4004s/iter; left time: 2851.8629s
	iters: 1000, epoch: 4 | loss: 0.3061745
	speed: 0.4005s/iter; left time: 2812.3960s
	iters: 1100, epoch: 4 | loss: 0.0063690
	speed: 0.4104s/iter; left time: 2840.8763s
Epoch: 4 cost time: 440.76148796081543
Epoch: 4, Steps: 1146 | Train Loss: 1.0500423 Vali Loss: 0.0088373 Test Loss: 0.0100266
Validation loss decreased (0.009686 --> 0.008837).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.1803240
	speed: 0.9859s/iter; left time: 6681.6592s
	iters: 200, epoch: 5 | loss: 0.0074171
	speed: 0.4007s/iter; left time: 2675.6511s
	iters: 300, epoch: 5 | loss: 0.0056302
	speed: 0.4038s/iter; left time: 2655.8780s
	iters: 400, epoch: 5 | loss: 0.0086409
	speed: 0.3899s/iter; left time: 2525.6244s
	iters: 500, epoch: 5 | loss: 0.0044565
	speed: 0.3385s/iter; left time: 2158.3639s
	iters: 600, epoch: 5 | loss: 3.8034039
	speed: 0.3326s/iter; left time: 2087.5718s
	iters: 700, epoch: 5 | loss: 0.0052830
	speed: 0.3002s/iter; left time: 1854.2957s
	iters: 800, epoch: 5 | loss: 0.0060544
	speed: 0.3704s/iter; left time: 2251.1879s
	iters: 900, epoch: 5 | loss: 0.0042267
	speed: 0.3993s/iter; left time: 2386.8922s
	iters: 1000, epoch: 5 | loss: 0.0045433
	speed: 0.4033s/iter; left time: 2370.3051s
	iters: 1100, epoch: 5 | loss: 0.0051297
	speed: 0.3958s/iter; left time: 2286.7563s
Epoch: 5 cost time: 432.8852069377899
Epoch: 5, Steps: 1146 | Train Loss: 1.0440934 Vali Loss: 0.0083260 Test Loss: 0.0115186
Validation loss decreased (0.008837 --> 0.008326).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 8.1197958
	speed: 0.9805s/iter; left time: 5521.3405s
	iters: 200, epoch: 6 | loss: 0.0041669
	speed: 0.4023s/iter; left time: 2225.3884s
	iters: 300, epoch: 6 | loss: 0.2447859
	speed: 0.4016s/iter; left time: 2181.0128s
	iters: 400, epoch: 6 | loss: 3.3302588
	speed: 0.4018s/iter; left time: 2141.9475s
	iters: 500, epoch: 6 | loss: 0.0043792
	speed: 0.4032s/iter; left time: 2108.9727s
	iters: 600, epoch: 6 | loss: 3.1139135
	speed: 0.4007s/iter; left time: 2056.1832s
	iters: 700, epoch: 6 | loss: 4.2144413
	speed: 0.3989s/iter; left time: 2006.6269s
	iters: 800, epoch: 6 | loss: 0.0039735
	speed: 0.3997s/iter; left time: 1971.0656s
	iters: 900, epoch: 6 | loss: 0.0038448
	speed: 0.4095s/iter; left time: 1978.4647s
	iters: 1000, epoch: 6 | loss: 0.0033462
	speed: 0.3438s/iter; left time: 1626.6965s
	iters: 1100, epoch: 6 | loss: 0.5393102
	speed: 0.3401s/iter; left time: 1574.9738s
Epoch: 6 cost time: 445.48469257354736
Epoch: 6, Steps: 1146 | Train Loss: 1.0311324 Vali Loss: 0.0093056 Test Loss: 0.0117381
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 8.4467163
	speed: 0.8846s/iter; left time: 3967.5757s
	iters: 200, epoch: 7 | loss: 0.0047281
	speed: 0.2937s/iter; left time: 1288.0380s
	iters: 300, epoch: 7 | loss: 0.0037457
	speed: 0.2978s/iter; left time: 1276.2057s
	iters: 400, epoch: 7 | loss: 8.1779175
	speed: 0.2856s/iter; left time: 1195.4344s
	iters: 500, epoch: 7 | loss: 0.6777365
	speed: 0.2813s/iter; left time: 1149.0521s
	iters: 600, epoch: 7 | loss: 0.2414464
	speed: 0.3431s/iter; left time: 1367.3298s
	iters: 700, epoch: 7 | loss: 0.0048508
	speed: 0.4055s/iter; left time: 1575.4276s
	iters: 800, epoch: 7 | loss: 0.0053858
	speed: 0.4035s/iter; left time: 1527.3268s
	iters: 900, epoch: 7 | loss: 0.0054470
	speed: 0.4074s/iter; left time: 1501.3041s
	iters: 1000, epoch: 7 | loss: 0.0054311
	speed: 0.4003s/iter; left time: 1435.2495s
	iters: 1100, epoch: 7 | loss: 0.0038333
	speed: 0.3993s/iter; left time: 1391.4651s
Epoch: 7 cost time: 401.10854482650757
Epoch: 7, Steps: 1146 | Train Loss: 1.0248218 Vali Loss: 0.0084080 Test Loss: 0.0109270
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0052692
	speed: 0.9757s/iter; left time: 3257.6970s
	iters: 200, epoch: 8 | loss: 3.8321791
	speed: 0.4099s/iter; left time: 1327.7007s
	iters: 300, epoch: 8 | loss: 0.0055324
	speed: 0.4095s/iter; left time: 1285.5536s
	iters: 400, epoch: 8 | loss: 0.0041306
	speed: 0.4095s/iter; left time: 1244.4196s
	iters: 500, epoch: 8 | loss: 1.1644289
	speed: 0.4014s/iter; left time: 1179.8223s
	iters: 600, epoch: 8 | loss: 0.0864475
	speed: 0.4089s/iter; left time: 1160.8354s
	iters: 700, epoch: 8 | loss: 0.0038861
	speed: 0.4010s/iter; left time: 1098.4750s
	iters: 800, epoch: 8 | loss: 0.0044112
	speed: 0.2985s/iter; left time: 787.7444s
	iters: 900, epoch: 8 | loss: 0.0048496
	speed: 0.2982s/iter; left time: 757.1689s
	iters: 1000, epoch: 8 | loss: 0.0036676
	speed: 0.3036s/iter; left time: 740.5529s
	iters: 1100, epoch: 8 | loss: 0.0904281
	speed: 0.2993s/iter; left time: 700.1325s
Epoch: 8 cost time: 423.45960116386414
Epoch: 8, Steps: 1146 | Train Loss: 1.0219717 Vali Loss: 0.0089036 Test Loss: 0.0120502
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 1) (10444, 96, 1)
mse:0.011523490771651268, mae:0.08260972797870636
Test learner: 0 test 10444
mse:0.04871540889143944, mae:0.13308481872081757
Test learner: 1 test 10444
mse:0.004305304028093815, mae:0.05036900192499161
Test learner: 2 test 10444
mse:0.03416614234447479, mae:0.1691136509180069
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
>>>>>>>start training : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.0032019
	speed: 0.4095s/iter; left time: 4652.6194s
	iters: 200, epoch: 1 | loss: 1.9260006
	speed: 0.4121s/iter; left time: 4640.3336s
	iters: 300, epoch: 1 | loss: 0.0050410
	speed: 0.4066s/iter; left time: 4537.6369s
	iters: 400, epoch: 1 | loss: 0.0036766
	speed: 0.4044s/iter; left time: 4473.2549s
	iters: 500, epoch: 1 | loss: 0.0068004
	speed: 0.4004s/iter; left time: 4388.3881s
	iters: 600, epoch: 1 | loss: 8.1471043
	speed: 0.4035s/iter; left time: 4382.1363s
	iters: 700, epoch: 1 | loss: 2.4527030
	speed: 0.3931s/iter; left time: 4230.4760s
	iters: 800, epoch: 1 | loss: 0.9858437
	speed: 0.4136s/iter; left time: 4409.7880s
	iters: 900, epoch: 1 | loss: 0.0083483
	speed: 0.4006s/iter; left time: 4230.4024s
	iters: 1000, epoch: 1 | loss: 0.0189033
	speed: 0.4031s/iter; left time: 4217.3474s
	iters: 1100, epoch: 1 | loss: 8.1164379
	speed: 0.4032s/iter; left time: 4177.3354s
Epoch: 1 cost time: 462.1181766986847
Epoch: 1, Steps: 1146 | Train Loss: 1.2011810 Vali Loss: 0.0117787 Test Loss: 0.0114961
Validation loss decreased (inf --> 0.011779).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0087916
	speed: 0.9160s/iter; left time: 9357.4440s
	iters: 200, epoch: 2 | loss: 0.0111645
	speed: 0.3048s/iter; left time: 3082.9879s
	iters: 300, epoch: 2 | loss: 0.0090350
	speed: 0.3574s/iter; left time: 3579.6669s
	iters: 400, epoch: 2 | loss: 0.0083121
	speed: 0.3952s/iter; left time: 3918.6906s
	iters: 500, epoch: 2 | loss: 0.0556846
	speed: 0.4040s/iter; left time: 3965.3864s
	iters: 600, epoch: 2 | loss: 0.0176843
	speed: 0.4103s/iter; left time: 3985.9039s
	iters: 700, epoch: 2 | loss: 0.0155915
	speed: 0.4039s/iter; left time: 3883.1912s
	iters: 800, epoch: 2 | loss: 0.0572641
	speed: 0.4039s/iter; left time: 3842.8165s
	iters: 900, epoch: 2 | loss: 7.6795540
	speed: 0.3976s/iter; left time: 3743.3323s
	iters: 1000, epoch: 2 | loss: 0.0104398
	speed: 0.4071s/iter; left time: 3792.1209s
	iters: 1100, epoch: 2 | loss: 0.0381714
	speed: 0.3965s/iter; left time: 3654.1125s
Epoch: 2 cost time: 438.0099227428436
Epoch: 2, Steps: 1146 | Train Loss: 1.1336345 Vali Loss: 0.0117505 Test Loss: 0.0122566
Validation loss decreased (0.011779 --> 0.011751).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0059761
	speed: 0.9882s/iter; left time: 8962.1512s
	iters: 200, epoch: 3 | loss: 0.0080852
	speed: 0.4105s/iter; left time: 3682.1309s
	iters: 300, epoch: 3 | loss: 0.0183154
	speed: 0.4063s/iter; left time: 3603.4231s
	iters: 400, epoch: 3 | loss: 0.0072861
	speed: 0.4015s/iter; left time: 3520.6760s
	iters: 500, epoch: 3 | loss: 3.9269531
	speed: 0.3073s/iter; left time: 2663.6311s
	iters: 600, epoch: 3 | loss: 0.0069921
	speed: 0.2974s/iter; left time: 2548.6563s
	iters: 700, epoch: 3 | loss: 0.0073232
	speed: 0.3070s/iter; left time: 2600.3091s
	iters: 800, epoch: 3 | loss: 0.0069606
	speed: 0.3016s/iter; left time: 2524.1316s
	iters: 900, epoch: 3 | loss: 0.0065103
	speed: 0.4013s/iter; left time: 3318.0144s
	iters: 1000, epoch: 3 | loss: 0.0079707
	speed: 0.3963s/iter; left time: 3237.7556s
	iters: 1100, epoch: 3 | loss: 0.0074946
	speed: 0.4030s/iter; left time: 3251.4953s
Epoch: 3 cost time: 423.6812512874603
Epoch: 3, Steps: 1146 | Train Loss: 1.0838132 Vali Loss: 0.0106777 Test Loss: 0.0101088
Validation loss decreased (0.011751 --> 0.010678).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0069600
	speed: 0.9960s/iter; left time: 7891.0290s
	iters: 200, epoch: 4 | loss: 1.0293727
	speed: 0.4061s/iter; left time: 3177.2172s
	iters: 300, epoch: 4 | loss: 0.0078019
	speed: 0.4069s/iter; left time: 3142.4368s
	iters: 400, epoch: 4 | loss: 3.8417091
	speed: 0.4050s/iter; left time: 3087.0462s
	iters: 500, epoch: 4 | loss: 0.0033960
	speed: 0.4014s/iter; left time: 3019.7384s
	iters: 600, epoch: 4 | loss: 0.0051099
	speed: 0.4039s/iter; left time: 2998.3373s
	iters: 700, epoch: 4 | loss: 0.0054190
	speed: 0.4080s/iter; left time: 2987.8644s
	iters: 800, epoch: 4 | loss: 1.0475821
	speed: 0.3987s/iter; left time: 2879.9982s
	iters: 900, epoch: 4 | loss: 0.4842866
	speed: 0.3980s/iter; left time: 2834.7050s
	iters: 1000, epoch: 4 | loss: 0.0039799
	speed: 0.3729s/iter; left time: 2618.8492s
	iters: 1100, epoch: 4 | loss: 0.1350360
	speed: 0.3009s/iter; left time: 2083.0456s
Epoch: 4 cost time: 445.82768869400024
Epoch: 4, Steps: 1146 | Train Loss: 1.0516948 Vali Loss: 0.0144796 Test Loss: 0.0143025
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0065483
	speed: 0.8997s/iter; left time: 6097.5245s
	iters: 200, epoch: 5 | loss: 0.0057571
	speed: 0.4069s/iter; left time: 2716.5997s
	iters: 300, epoch: 5 | loss: 0.0040495
	speed: 0.4060s/iter; left time: 2670.1143s
	iters: 400, epoch: 5 | loss: 3.8498154
	speed: 0.4078s/iter; left time: 2641.5253s
	iters: 500, epoch: 5 | loss: 0.0058146
	speed: 0.4047s/iter; left time: 2580.9291s
	iters: 600, epoch: 5 | loss: 0.0046817
	speed: 0.4085s/iter; left time: 2564.0090s
	iters: 700, epoch: 5 | loss: 0.0058469
	speed: 0.4031s/iter; left time: 2490.1292s
	iters: 800, epoch: 5 | loss: 0.0040569
	speed: 0.4009s/iter; left time: 2436.3951s
	iters: 900, epoch: 5 | loss: 0.0036545
	speed: 0.4023s/iter; left time: 2404.3154s
	iters: 1000, epoch: 5 | loss: 0.0038813
	speed: 0.4093s/iter; left time: 2405.4797s
	iters: 1100, epoch: 5 | loss: 0.0023397
	speed: 0.4037s/iter; left time: 2331.9730s
Epoch: 5 cost time: 455.8268129825592
Epoch: 5, Steps: 1146 | Train Loss: 1.0216821 Vali Loss: 0.0061829 Test Loss: 0.0059140
Validation loss decreased (0.010678 --> 0.006183).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 8.1288929
	speed: 0.9888s/iter; left time: 5567.7758s
	iters: 200, epoch: 6 | loss: 0.0031897
	speed: 0.4056s/iter; left time: 2243.2572s
	iters: 300, epoch: 6 | loss: 0.0041939
	speed: 0.3466s/iter; left time: 1882.5836s
	iters: 400, epoch: 6 | loss: 6.7132244
	speed: 0.2992s/iter; left time: 1594.8330s
	iters: 500, epoch: 6 | loss: 0.0041601
	speed: 0.3031s/iter; left time: 1585.4402s
	iters: 600, epoch: 6 | loss: 0.0051580
	speed: 0.3038s/iter; left time: 1558.6377s
	iters: 700, epoch: 6 | loss: 3.8433032
	speed: 0.2970s/iter; left time: 1494.1162s
	iters: 800, epoch: 6 | loss: 0.0047211
	speed: 0.2975s/iter; left time: 1467.1863s
	iters: 900, epoch: 6 | loss: 7.6733551
	speed: 0.2937s/iter; left time: 1419.0470s
	iters: 1000, epoch: 6 | loss: 0.0049543
	speed: 0.2842s/iter; left time: 1344.6706s
	iters: 1100, epoch: 6 | loss: 0.2440919
	speed: 0.2827s/iter; left time: 1308.9685s
Epoch: 6 cost time: 365.998197555542
Epoch: 6, Steps: 1146 | Train Loss: 1.0244017 Vali Loss: 0.0063584 Test Loss: 0.0064596
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0054713
	speed: 0.9346s/iter; left time: 4191.6765s
	iters: 200, epoch: 7 | loss: 0.0026583
	speed: 0.4065s/iter; left time: 1782.6501s
	iters: 300, epoch: 7 | loss: 0.0037482
	speed: 0.4120s/iter; left time: 1765.4754s
	iters: 400, epoch: 7 | loss: 0.0032677
	speed: 0.4015s/iter; left time: 1680.1122s
	iters: 500, epoch: 7 | loss: 0.0035189
	speed: 0.4065s/iter; left time: 1660.4112s
	iters: 600, epoch: 7 | loss: 0.0049732
	speed: 0.3977s/iter; left time: 1584.8106s
	iters: 700, epoch: 7 | loss: 0.0032579
	speed: 0.4029s/iter; left time: 1565.3361s
	iters: 800, epoch: 7 | loss: 8.1634951
	speed: 0.4018s/iter; left time: 1520.8020s
	iters: 900, epoch: 7 | loss: 0.0028710
	speed: 0.4017s/iter; left time: 1480.4386s
	iters: 1000, epoch: 7 | loss: 0.0031051
	speed: 0.3957s/iter; left time: 1418.5865s
	iters: 1100, epoch: 7 | loss: 0.0042205
	speed: 0.4080s/iter; left time: 1421.7501s
Epoch: 7 cost time: 461.91632080078125
Epoch: 7, Steps: 1146 | Train Loss: 1.0074445 Vali Loss: 0.0062253 Test Loss: 0.0062550
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0031606
	speed: 0.9796s/iter; left time: 3270.8655s
	iters: 200, epoch: 8 | loss: 0.1643581
	speed: 0.3411s/iter; left time: 1104.9354s
	iters: 300, epoch: 8 | loss: 0.0056927
	speed: 0.2993s/iter; left time: 939.4453s
	iters: 400, epoch: 8 | loss: 0.0033105
	speed: 0.3021s/iter; left time: 918.0293s
	iters: 500, epoch: 8 | loss: 0.0047533
	speed: 0.3024s/iter; left time: 888.7270s
	iters: 600, epoch: 8 | loss: 0.3736849
	speed: 0.3566s/iter; left time: 1012.3979s
	iters: 700, epoch: 8 | loss: 3.5741801
	speed: 0.4033s/iter; left time: 1104.5455s
	iters: 800, epoch: 8 | loss: 0.0039216
	speed: 0.4059s/iter; left time: 1071.2363s
	iters: 900, epoch: 8 | loss: 0.0036445
	speed: 0.4001s/iter; left time: 1015.8949s
	iters: 1000, epoch: 8 | loss: 0.0666846
	speed: 0.4026s/iter; left time: 981.8844s
	iters: 1100, epoch: 8 | loss: 3.0988817
	speed: 0.4017s/iter; left time: 939.6595s
Epoch: 8 cost time: 421.00589299201965
Epoch: 8, Steps: 1146 | Train Loss: 1.0106811 Vali Loss: 0.0066924 Test Loss: 0.0071332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 1) (10444, 96, 1)
mse:0.005908321123570204, mae:0.0639750212430954
Test learner: 0 test 10444
mse:0.010102812200784683, mae:0.08361953496932983
Test learner: 1 test 10444
mse:0.017784591764211655, mae:0.09539159387350082
Test learner: 2 test 10444
mse:0.024488748982548714, mae:0.1430562138557434
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.0034074
	speed: 0.4032s/iter; left time: 4580.9052s
	iters: 200, epoch: 1 | loss: 0.9993014
	speed: 0.4004s/iter; left time: 4509.0669s
	iters: 300, epoch: 1 | loss: 0.0102306
	speed: 0.4047s/iter; left time: 4516.6354s
	iters: 400, epoch: 1 | loss: 3.8514686
	speed: 0.4031s/iter; left time: 4458.6347s
	iters: 500, epoch: 1 | loss: 0.0034313
	speed: 0.3995s/iter; left time: 4378.5206s
	iters: 600, epoch: 1 | loss: 3.9443135
	speed: 0.3753s/iter; left time: 4075.6192s
	iters: 700, epoch: 1 | loss: 0.0096584
	speed: 0.3033s/iter; left time: 3264.3071s
	iters: 800, epoch: 1 | loss: 0.0377615
	speed: 0.2997s/iter; left time: 3194.9978s
	iters: 900, epoch: 1 | loss: 0.0495664
	speed: 0.3022s/iter; left time: 3191.8383s
	iters: 1000, epoch: 1 | loss: 0.0258682
	speed: 0.3223s/iter; left time: 3371.5232s
	iters: 1100, epoch: 1 | loss: 0.0099490
	speed: 0.3990s/iter; left time: 4134.5038s
Epoch: 1 cost time: 420.132187128067
Epoch: 1, Steps: 1146 | Train Loss: 1.2119397 Vali Loss: 0.0171571 Test Loss: 0.0115771
Validation loss decreased (inf --> 0.017157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1238604
	speed: 0.9828s/iter; left time: 10039.6499s
	iters: 200, epoch: 2 | loss: 0.0190427
	speed: 0.4032s/iter; left time: 4078.2398s
	iters: 300, epoch: 2 | loss: 3.8189368
	speed: 0.4046s/iter; left time: 4051.6155s
	iters: 400, epoch: 2 | loss: 0.0069105
	speed: 0.4003s/iter; left time: 3969.3166s
	iters: 500, epoch: 2 | loss: 2.9075027
	speed: 0.4056s/iter; left time: 3981.1914s
	iters: 600, epoch: 2 | loss: 0.0076178
	speed: 0.4032s/iter; left time: 3917.5728s
	iters: 700, epoch: 2 | loss: 17.1252480
	speed: 0.4039s/iter; left time: 3883.6083s
	iters: 800, epoch: 2 | loss: 0.1191223
	speed: 0.4005s/iter; left time: 3810.7296s
	iters: 900, epoch: 2 | loss: 0.0058116
	speed: 0.4068s/iter; left time: 3830.2569s
	iters: 1000, epoch: 2 | loss: 0.0129331
	speed: 0.4007s/iter; left time: 3732.7234s
	iters: 1100, epoch: 2 | loss: 8.1252737
	speed: 0.4107s/iter; left time: 3784.7848s
Epoch: 2 cost time: 463.6041967868805
Epoch: 2, Steps: 1146 | Train Loss: 1.1485698 Vali Loss: 0.0126131 Test Loss: 0.0134693
Validation loss decreased (0.017157 --> 0.012613).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 2.1064446
	speed: 0.9352s/iter; left time: 8481.3916s
	iters: 200, epoch: 3 | loss: 0.0048486
	speed: 0.3081s/iter; left time: 2763.4499s
	iters: 300, epoch: 3 | loss: 0.0051237
	speed: 0.3471s/iter; left time: 3078.5862s
	iters: 400, epoch: 3 | loss: 0.0046474
	speed: 0.4113s/iter; left time: 3606.9973s
	iters: 500, epoch: 3 | loss: 0.0036319
	speed: 0.4045s/iter; left time: 3506.8248s
	iters: 600, epoch: 3 | loss: 0.0055488
	speed: 0.4027s/iter; left time: 3450.3780s
	iters: 700, epoch: 3 | loss: 0.0084949
	speed: 0.4050s/iter; left time: 3430.2018s
	iters: 800, epoch: 3 | loss: 0.0070017
	speed: 0.4074s/iter; left time: 3409.2328s
	iters: 900, epoch: 3 | loss: 0.0052168
	speed: 0.4147s/iter; left time: 3428.8595s
	iters: 1000, epoch: 3 | loss: 0.3411472
	speed: 0.4046s/iter; left time: 3305.4648s
	iters: 1100, epoch: 3 | loss: 3.8512294
	speed: 0.4057s/iter; left time: 3273.5131s
Epoch: 3 cost time: 441.34956073760986
Epoch: 3, Steps: 1146 | Train Loss: 1.0693100 Vali Loss: 0.0085256 Test Loss: 0.0078955
Validation loss decreased (0.012613 --> 0.008526).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0034314
	speed: 0.9918s/iter; left time: 7858.1998s
	iters: 200, epoch: 4 | loss: 0.0070709
	speed: 0.4048s/iter; left time: 3166.3676s
	iters: 300, epoch: 4 | loss: 0.4524897
	speed: 0.4066s/iter; left time: 3139.8925s
	iters: 400, epoch: 4 | loss: 1.9407409
	speed: 0.3982s/iter; left time: 3035.1842s
	iters: 500, epoch: 4 | loss: 0.2075411
	speed: 0.3120s/iter; left time: 2346.9246s
	iters: 600, epoch: 4 | loss: 0.0046047
	speed: 0.2981s/iter; left time: 2212.7212s
	iters: 700, epoch: 4 | loss: 0.0040614
	speed: 0.3044s/iter; left time: 2228.9100s
	iters: 800, epoch: 4 | loss: 0.0045733
	speed: 0.3050s/iter; left time: 2203.1739s
	iters: 900, epoch: 4 | loss: 0.0042173
	speed: 0.3006s/iter; left time: 2141.2299s
	iters: 1000, epoch: 4 | loss: 0.0064117
	speed: 0.2988s/iter; left time: 2098.7985s
	iters: 1100, epoch: 4 | loss: 0.0073782
	speed: 0.2955s/iter; left time: 2046.0343s
Epoch: 4 cost time: 386.68567752838135
Epoch: 4, Steps: 1146 | Train Loss: 1.0537078 Vali Loss: 0.0081676 Test Loss: 0.0100892
Validation loss decreased (0.008526 --> 0.008168).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0062431
	speed: 0.8533s/iter; left time: 5782.8360s
	iters: 200, epoch: 5 | loss: 0.0095914
	speed: 0.4347s/iter; left time: 2902.4973s
	iters: 300, epoch: 5 | loss: 3.7541866
	speed: 0.4471s/iter; left time: 2940.2867s
	iters: 400, epoch: 5 | loss: 0.0050216
	speed: 0.4323s/iter; left time: 2800.1108s
	iters: 500, epoch: 5 | loss: 0.0050979
	speed: 0.4400s/iter; left time: 2805.9840s
	iters: 600, epoch: 5 | loss: 1.4555314
	speed: 0.4440s/iter; left time: 2787.1791s
	iters: 700, epoch: 5 | loss: 0.7902292
	speed: 0.4323s/iter; left time: 2670.4266s
	iters: 800, epoch: 5 | loss: 0.0044922
	speed: 0.4395s/iter; left time: 2670.6958s
	iters: 900, epoch: 5 | loss: 0.0107063
	speed: 0.4376s/iter; left time: 2615.4557s
	iters: 1000, epoch: 5 | loss: 0.0055319
	speed: 0.4385s/iter; left time: 2577.3184s
	iters: 1100, epoch: 5 | loss: 0.0050348
	speed: 0.4327s/iter; left time: 2499.5189s
Epoch: 5 cost time: 488.71969175338745
Epoch: 5, Steps: 1146 | Train Loss: 1.0357584 Vali Loss: 0.0081989 Test Loss: 0.0112530
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0073038
	speed: 1.1200s/iter; left time: 6306.5038s
	iters: 200, epoch: 6 | loss: 0.0076834
	speed: 0.3914s/iter; left time: 2164.9227s
	iters: 300, epoch: 6 | loss: 0.0061787
	speed: 0.3002s/iter; left time: 1630.5243s
	iters: 400, epoch: 6 | loss: 0.0056111
	speed: 0.3025s/iter; left time: 1612.4666s
	iters: 500, epoch: 6 | loss: 0.0107712
	speed: 0.3046s/iter; left time: 1593.4603s
	iters: 600, epoch: 6 | loss: 0.0047667
	speed: 0.3417s/iter; left time: 1753.4441s
	iters: 700, epoch: 6 | loss: 0.0055102
	speed: 0.4358s/iter; left time: 2192.3559s
	iters: 800, epoch: 6 | loss: 0.0078615
	speed: 0.4383s/iter; left time: 2161.1707s
	iters: 900, epoch: 6 | loss: 0.0078943
	speed: 0.4380s/iter; left time: 2115.8655s
	iters: 1000, epoch: 6 | loss: 0.0055385
	speed: 0.4288s/iter; left time: 2028.7057s
	iters: 1100, epoch: 6 | loss: 0.0045378
	speed: 0.4359s/iter; left time: 2018.8554s
Epoch: 6 cost time: 446.50911593437195
Epoch: 6, Steps: 1146 | Train Loss: 1.0170715 Vali Loss: 0.0070501 Test Loss: 0.0078510
Validation loss decreased (0.008168 --> 0.007050).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0066276
	speed: 1.1120s/iter; left time: 4987.4701s
	iters: 200, epoch: 7 | loss: 0.0051999
	speed: 0.4307s/iter; left time: 1888.4183s
	iters: 300, epoch: 7 | loss: 0.0129707
	speed: 0.4414s/iter; left time: 1891.5820s
	iters: 400, epoch: 7 | loss: 0.9870684
	speed: 0.4365s/iter; left time: 1826.8826s
	iters: 500, epoch: 7 | loss: 0.0058626
	speed: 0.4353s/iter; left time: 1778.2381s
	iters: 600, epoch: 7 | loss: 0.0043728
	speed: 0.4348s/iter; left time: 1732.6357s
	iters: 700, epoch: 7 | loss: 0.0040423
	speed: 0.3713s/iter; left time: 1442.4673s
	iters: 800, epoch: 7 | loss: 0.0052218
	speed: 0.2956s/iter; left time: 1118.9303s
	iters: 900, epoch: 7 | loss: 3.8521304
	speed: 0.3036s/iter; left time: 1118.6899s
	iters: 1000, epoch: 7 | loss: 0.0042951
	speed: 0.3031s/iter; left time: 1086.4831s
	iters: 1100, epoch: 7 | loss: 0.9441087
	speed: 0.3527s/iter; left time: 1229.2774s
Epoch: 7 cost time: 444.28843092918396
Epoch: 7, Steps: 1146 | Train Loss: 1.0186725 Vali Loss: 0.0064750 Test Loss: 0.0067484
Validation loss decreased (0.007050 --> 0.006475).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.3018913
	speed: 1.1097s/iter; left time: 3705.3060s
	iters: 200, epoch: 8 | loss: 0.0044117
	speed: 0.4388s/iter; left time: 1421.3309s
	iters: 300, epoch: 8 | loss: 0.4991541
	speed: 0.4404s/iter; left time: 1382.5010s
	iters: 400, epoch: 8 | loss: 3.8199840
	speed: 0.4353s/iter; left time: 1322.9393s
	iters: 500, epoch: 8 | loss: 7.1787519
	speed: 0.4329s/iter; left time: 1272.3137s
	iters: 600, epoch: 8 | loss: 0.0044414
	speed: 0.4309s/iter; left time: 1223.2474s
	iters: 700, epoch: 8 | loss: 0.0050884
	speed: 0.4363s/iter; left time: 1195.0486s
	iters: 800, epoch: 8 | loss: 3.8596227
	speed: 0.4368s/iter; left time: 1152.8120s
	iters: 900, epoch: 8 | loss: 0.0045547
	speed: 0.4291s/iter; left time: 1089.5504s
	iters: 1000, epoch: 8 | loss: 0.0052863
	speed: 0.4325s/iter; left time: 1054.8652s
	iters: 1100, epoch: 8 | loss: 0.0050090
	speed: 0.4413s/iter; left time: 1032.1817s
Epoch: 8 cost time: 499.25172567367554
Epoch: 8, Steps: 1146 | Train Loss: 1.0038959 Vali Loss: 0.0070557 Test Loss: 0.0073441
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 8.1283674
	speed: 0.9426s/iter; left time: 2067.0330s
	iters: 200, epoch: 9 | loss: 0.0058744
	speed: 0.3026s/iter; left time: 633.3743s
	iters: 300, epoch: 9 | loss: 0.0048632
	speed: 0.3448s/iter; left time: 687.1309s
	iters: 400, epoch: 9 | loss: 0.2886990
	speed: 0.4375s/iter; left time: 828.1627s
	iters: 500, epoch: 9 | loss: 0.0046658
	speed: 0.4343s/iter; left time: 778.6609s
	iters: 600, epoch: 9 | loss: 9.1511316
	speed: 0.4302s/iter; left time: 728.3020s
	iters: 700, epoch: 9 | loss: 0.0054371
	speed: 0.4308s/iter; left time: 686.2356s
	iters: 800, epoch: 9 | loss: 0.0045818
	speed: 0.4385s/iter; left time: 654.6789s
	iters: 900, epoch: 9 | loss: 0.0038006
	speed: 0.4407s/iter; left time: 613.8571s
	iters: 1000, epoch: 9 | loss: 0.0043376
	speed: 0.4392s/iter; left time: 567.8635s
	iters: 1100, epoch: 9 | loss: 0.0055282
	speed: 0.4294s/iter; left time: 512.3192s
Epoch: 9 cost time: 463.79060459136963
Epoch: 9, Steps: 1146 | Train Loss: 1.0028123 Vali Loss: 0.0065260 Test Loss: 0.0067039
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0047980
	speed: 1.1133s/iter; left time: 1165.6194s
	iters: 200, epoch: 10 | loss: 0.7894030
	speed: 0.4425s/iter; left time: 419.0105s
	iters: 300, epoch: 10 | loss: 8.1830711
	speed: 0.4372s/iter; left time: 370.3230s
	iters: 400, epoch: 10 | loss: 0.0046603
	speed: 0.3610s/iter; left time: 269.6889s
	iters: 500, epoch: 10 | loss: 0.1999297
	speed: 0.2974s/iter; left time: 192.4364s
	iters: 600, epoch: 10 | loss: 0.0040366
	speed: 0.3032s/iter; left time: 165.8458s
	iters: 700, epoch: 10 | loss: 0.0051517
	speed: 0.3047s/iter; left time: 136.1996s
	iters: 800, epoch: 10 | loss: 3.8375814
	speed: 0.2978s/iter; left time: 103.3245s
	iters: 900, epoch: 10 | loss: 0.0056788
	speed: 0.2933s/iter; left time: 72.4426s
	iters: 1000, epoch: 10 | loss: 0.0043956
	speed: 0.2968s/iter; left time: 43.6245s
	iters: 1100, epoch: 10 | loss: 0.0045584
	speed: 0.3751s/iter; left time: 17.6316s
Epoch: 10 cost time: 405.3512794971466
Epoch: 10, Steps: 1146 | Train Loss: 1.0008299 Vali Loss: 0.0064705 Test Loss: 0.0066627
Validation loss decreased (0.006475 --> 0.006470).  Saving model ...
Updating learning rate to 1.953125e-07
>>>>>>>testing : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 1) (10444, 96, 1)
mse:0.006664592772722244, mae:0.06196948140859604
Test learner: 0 test 10444
mse:0.03677348047494888, mae:0.15212102234363556
Test learner: 1 test 10444
mse:0.011670279316604137, mae:0.08385278284549713
Test learner: 2 test 10444
mse:0.0028164188843220472, mae:0.040972303599119186
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.0040435480756849575
stdev: 0.009402813584933889
stdev: 0.005089631143355978
stdev: 0.005448386699276298
stdev: 0.0014131585762210013
stdev: 0.0020707073998624736
stdev: 0.005841607456447519
stdev: 0.001493055964133239
stdev: 0.003704688448286261
stdev: 0.004402757713752216
stdev: 0.006480962759697463
stdev: 0.008414428831214824
stdev: 0.0026460533528884123
stdev: 0.008082095550588086
stdev: 0.0038024873107643338
stdev: 0.007943626678150583
stdev: 0.009234545181900405
stdev: 0.003036445563629472
stdev: 0.009920439227526324
stdev: 0.0038031994650529768
stdev: 0.008970750596564325
stdev: 0.007242648894589634
stdev: 0.001490722533978015
stdev: 0.0028163694934197235
stdev: 0.00873240227592173
stdev: 0.00694681045314295
stdev: 0.008855081094057221
stdev: 0.007513703699165961
stdev: 0.001827446662939766
stdev: 0.0011976944599024545
stdev: 0.002638440948158871
stdev: 0.0034852161694518707
stdev: 0.007059999489706122
stdev: 0.00613427377696895
stdev: 0.004395762422816739
stdev: 0.0035606167405881754
stdev: 0.002823993072755853
stdev: 0.00397841073416727
>>>>>>>start training URT: Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Best MSE: 10000000000.0
Traceback (most recent call last):
  File "/home/maxsum/ws/MTNs/Autoformer/Autoformer-main/run_dualmode3k.py", line 243, in <module>
    main()
  File "/home/maxsum/ws/MTNs/Autoformer/Autoformer-main/run_dualmode3k.py", line 211, in main
    opt.train_urt(setting)
  File "/home/maxsum/ws/MTNs/Autoformer/Autoformer-main/exp/opt_urt.py", line 304, in train_urt
    loss.backward()
  File "/home/maxsum/anaconda3/envs/torchenv/lib/python3.9/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/maxsum/anaconda3/envs/torchenv/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Unable to find a valid cuDNN algorithm to run convolution
Args in experiment:
Namespace(is_training=1, model_id='Weather_E3k_96_96', model='B6autoformer', slow_model='AutoformerS1', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints1/', seq_len=96, label_len=48, pred_len=96, bucket_size=4, n_hashes=4, enc_in=1, dec_in=1, c_out=1, d_model=256, n_learner=3, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.01, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=3, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, anomaly=1.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.0063576
	speed: 0.1420s/iter; left time: 1613.5829s
	iters: 200, epoch: 1 | loss: 0.0084971
	speed: 0.1086s/iter; left time: 1222.6103s
	iters: 300, epoch: 1 | loss: 0.0068881
	speed: 0.1088s/iter; left time: 1213.8767s
	iters: 400, epoch: 1 | loss: 0.0080515
	speed: 0.1092s/iter; left time: 1207.7467s
	iters: 500, epoch: 1 | loss: 0.0066108
	speed: 0.1090s/iter; left time: 1194.4383s
	iters: 600, epoch: 1 | loss: 0.0091696
	speed: 0.1089s/iter; left time: 1183.0534s
	iters: 700, epoch: 1 | loss: 0.5398991
	speed: 0.1146s/iter; left time: 1233.6410s
	iters: 800, epoch: 1 | loss: 0.0061174
	speed: 0.1110s/iter; left time: 1183.7996s
	iters: 900, epoch: 1 | loss: 0.0070689
	speed: 0.1088s/iter; left time: 1149.3376s
	iters: 1000, epoch: 1 | loss: 5.3498244
	speed: 0.1096s/iter; left time: 1147.0010s
	iters: 1100, epoch: 1 | loss: 8.1384573
	speed: 0.1092s/iter; left time: 1131.5448s
Epoch: 1 cost time: 129.18183279037476
Update Best URT params
Epoch: 1, Steps: 1146 | Train Loss: 1.0244263 Vali Loss: 0.0087012 Test Loss: 0.0108554
Validation loss decreased (inf --> 0.008701).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0075615
	speed: 0.4124s/iter; left time: 4212.7767s
	iters: 200, epoch: 2 | loss: 0.0049200
	speed: 0.1103s/iter; left time: 1115.4877s
	iters: 300, epoch: 2 | loss: 1.2479612
	speed: 0.1117s/iter; left time: 1118.5746s
	iters: 400, epoch: 2 | loss: 0.0060613
	speed: 0.1133s/iter; left time: 1123.1167s
	iters: 500, epoch: 2 | loss: 0.0092888
	speed: 0.1164s/iter; left time: 1142.4783s
	iters: 600, epoch: 2 | loss: 0.0051466
	speed: 0.1152s/iter; left time: 1118.8476s
	iters: 700, epoch: 2 | loss: 0.5633923
	speed: 0.1118s/iter; left time: 1075.0516s
	iters: 800, epoch: 2 | loss: 0.0061936
	speed: 0.1102s/iter; left time: 1048.5757s
	iters: 900, epoch: 2 | loss: 8.1270866
	speed: 0.1113s/iter; left time: 1047.8821s
	iters: 1000, epoch: 2 | loss: 1.4326756
	speed: 0.1095s/iter; left time: 1019.9475s
	iters: 1100, epoch: 2 | loss: 0.0102796
	speed: 0.1102s/iter; left time: 1015.5356s
Epoch: 2 cost time: 128.78817319869995
Epoch: 2, Steps: 1146 | Train Loss: 1.0144752 Vali Loss: 0.0098192 Test Loss: 0.0129461
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.5949985
	speed: 0.4096s/iter; left time: 3714.3945s
	iters: 200, epoch: 3 | loss: 0.0059466
	speed: 0.1107s/iter; left time: 992.9404s
	iters: 300, epoch: 3 | loss: 0.4987673
	speed: 0.1099s/iter; left time: 975.0723s
	iters: 400, epoch: 3 | loss: 0.0080078
	speed: 0.1123s/iter; left time: 984.5361s
	iters: 500, epoch: 3 | loss: 0.0065552
	speed: 0.1163s/iter; left time: 1007.9024s
	iters: 600, epoch: 3 | loss: 0.0073213
	speed: 0.1143s/iter; left time: 979.3096s
	iters: 700, epoch: 3 | loss: 3.8047616
	speed: 0.1098s/iter; left time: 929.8375s
	iters: 800, epoch: 3 | loss: 5.7445078
	speed: 0.1101s/iter; left time: 921.5907s
	iters: 900, epoch: 3 | loss: 0.0055545
	speed: 0.1098s/iter; left time: 908.1181s
	iters: 1000, epoch: 3 | loss: 0.4468225
	speed: 0.1104s/iter; left time: 901.9026s
	iters: 1100, epoch: 3 | loss: 2.3929527
	speed: 0.1127s/iter; left time: 909.3630s
Epoch: 3 cost time: 129.0845069885254
Epoch: 3, Steps: 1146 | Train Loss: 1.0119641 Vali Loss: 0.0098340 Test Loss: 0.0127776
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 3.8040683
	speed: 0.4212s/iter; left time: 3337.4333s
	iters: 200, epoch: 4 | loss: 0.0072327
	speed: 0.1106s/iter; left time: 865.1637s
	iters: 300, epoch: 4 | loss: 2.5896740
	speed: 0.1109s/iter; left time: 856.7666s
	iters: 400, epoch: 4 | loss: 0.0110918
	speed: 0.1168s/iter; left time: 890.5557s
	iters: 500, epoch: 4 | loss: 0.0064096
	speed: 0.1108s/iter; left time: 833.3054s
	iters: 600, epoch: 4 | loss: 4.7875280
	speed: 0.1106s/iter; left time: 821.2544s
	iters: 700, epoch: 4 | loss: 0.0075787
	speed: 0.1095s/iter; left time: 801.8157s
	iters: 800, epoch: 4 | loss: 0.0077783
	speed: 0.1109s/iter; left time: 801.2584s
	iters: 900, epoch: 4 | loss: 0.0076425
	speed: 0.1099s/iter; left time: 782.8564s
	iters: 1000, epoch: 4 | loss: 0.0081956
	speed: 0.1125s/iter; left time: 789.7982s
	iters: 1100, epoch: 4 | loss: 0.0085235
	speed: 0.1130s/iter; left time: 782.5693s
Epoch: 4 cost time: 128.81948018074036
Epoch: 4, Steps: 1146 | Train Loss: 1.0081932 Vali Loss: 0.0104818 Test Loss: 0.0138555
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 1) (10444, 96, 1)
mse:0.010860900394618511, mae:0.08213585615158081
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
>>>>>>>start training URT: Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.0040330
	speed: 0.1213s/iter; left time: 1377.5988s
	iters: 200, epoch: 1 | loss: 0.0033160
	speed: 0.1188s/iter; left time: 1338.0737s
	iters: 300, epoch: 1 | loss: 0.0044618
	speed: 0.1124s/iter; left time: 1254.9260s
	iters: 400, epoch: 1 | loss: 0.0041104
	speed: 0.1160s/iter; left time: 1283.3634s
	iters: 500, epoch: 1 | loss: 2.3069661
	speed: 0.1107s/iter; left time: 1213.0784s
	iters: 600, epoch: 1 | loss: 0.3123167
	speed: 0.1118s/iter; left time: 1213.7847s
	iters: 700, epoch: 1 | loss: 0.0045079
	speed: 0.1130s/iter; left time: 1215.5605s
	iters: 800, epoch: 1 | loss: 0.0051787
	speed: 0.1187s/iter; left time: 1265.5049s
	iters: 900, epoch: 1 | loss: 0.5155024
	speed: 0.1115s/iter; left time: 1178.0632s
	iters: 1000, epoch: 1 | loss: 0.0044700
	speed: 0.1227s/iter; left time: 1283.7333s
	iters: 1100, epoch: 1 | loss: 0.0058363
	speed: 0.1638s/iter; left time: 1697.1441s
Epoch: 1 cost time: 139.6349687576294
Update Best URT params
Epoch: 1, Steps: 1146 | Train Loss: 1.0220662 Vali Loss: 0.0072805 Test Loss: 0.0076115
Validation loss decreased (inf --> 0.007281).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0045074
	speed: 0.6206s/iter; left time: 6339.0728s
	iters: 200, epoch: 2 | loss: 0.0039067
	speed: 0.1599s/iter; left time: 1617.3913s
	iters: 300, epoch: 2 | loss: 0.0051686
	speed: 0.1612s/iter; left time: 1614.1141s
	iters: 400, epoch: 2 | loss: 0.0042460
	speed: 0.1622s/iter; left time: 1607.7234s
	iters: 500, epoch: 2 | loss: 0.2473307
	speed: 0.1606s/iter; left time: 1576.0330s
	iters: 600, epoch: 2 | loss: 3.8227925
	speed: 0.1615s/iter; left time: 1568.9495s
	iters: 700, epoch: 2 | loss: 3.8219047
	speed: 0.1610s/iter; left time: 1548.0059s
	iters: 800, epoch: 2 | loss: 0.0054414
	speed: 0.1673s/iter; left time: 1591.9046s
	iters: 900, epoch: 2 | loss: 0.0037070
	speed: 0.1640s/iter; left time: 1544.0060s
	iters: 1000, epoch: 2 | loss: 0.0045213
	speed: 0.1620s/iter; left time: 1508.9504s
	iters: 1100, epoch: 2 | loss: 0.9005488
	speed: 0.1599s/iter; left time: 1473.5052s
Epoch: 2 cost time: 186.19362807273865
Update Best URT params
Epoch: 2, Steps: 1146 | Train Loss: 1.0058616 Vali Loss: 0.0072030 Test Loss: 0.0073207
Validation loss decreased (0.007281 --> 0.007203).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0040154
	speed: 0.6898s/iter; left time: 6255.7976s
	iters: 200, epoch: 3 | loss: 0.0048395
	speed: 0.1609s/iter; left time: 1443.4457s
	iters: 300, epoch: 3 | loss: 0.0050207
	speed: 0.1629s/iter; left time: 1445.1622s
	iters: 400, epoch: 3 | loss: 0.0052950
	speed: 0.1609s/iter; left time: 1411.1055s
	iters: 500, epoch: 3 | loss: 0.0055221
	speed: 0.1595s/iter; left time: 1382.3433s
	iters: 600, epoch: 3 | loss: 0.0051713
	speed: 0.1605s/iter; left time: 1375.1852s
	iters: 700, epoch: 3 | loss: 0.0048777
	speed: 0.1614s/iter; left time: 1366.9610s
	iters: 800, epoch: 3 | loss: 11.9480247
	speed: 0.1596s/iter; left time: 1335.5963s
	iters: 900, epoch: 3 | loss: 5.1245165
	speed: 0.1597s/iter; left time: 1320.9308s
	iters: 1000, epoch: 3 | loss: 0.0035985
	speed: 0.1612s/iter; left time: 1316.8248s
	iters: 1100, epoch: 3 | loss: 0.0046855
	speed: 0.1619s/iter; left time: 1306.4385s
Epoch: 3 cost time: 184.98651909828186
Epoch: 3, Steps: 1146 | Train Loss: 1.0036097 Vali Loss: 0.0076430 Test Loss: 0.0079498
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.0058633
	speed: 0.6188s/iter; left time: 4902.8309s
	iters: 200, epoch: 4 | loss: 0.0044575
	speed: 0.1842s/iter; left time: 1440.9094s
	iters: 300, epoch: 4 | loss: 0.9729940
	speed: 0.1812s/iter; left time: 1399.6691s
	iters: 400, epoch: 4 | loss: 0.6399451
	speed: 0.1762s/iter; left time: 1343.0077s
	iters: 500, epoch: 4 | loss: 0.0036346
	speed: 0.1604s/iter; left time: 1206.9990s
	iters: 600, epoch: 4 | loss: 0.1028172
	speed: 0.1616s/iter; left time: 1199.7285s
	iters: 700, epoch: 4 | loss: 0.0058389
	speed: 0.1607s/iter; left time: 1176.7828s
	iters: 800, epoch: 4 | loss: 0.0045182
	speed: 0.1612s/iter; left time: 1164.6027s
	iters: 900, epoch: 4 | loss: 0.0076622
	speed: 0.1609s/iter; left time: 1145.9265s
	iters: 1000, epoch: 4 | loss: 3.3717489
	speed: 0.1624s/iter; left time: 1140.5735s
	iters: 1100, epoch: 4 | loss: 0.0044368
	speed: 0.1607s/iter; left time: 1112.8649s
Epoch: 4 cost time: 191.18663001060486
Epoch: 4, Steps: 1146 | Train Loss: 1.0039506 Vali Loss: 0.0082081 Test Loss: 0.0086568
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.0045255
	speed: 0.6201s/iter; left time: 4202.2131s
	iters: 200, epoch: 5 | loss: 0.0052455
	speed: 0.1608s/iter; left time: 1073.5672s
	iters: 300, epoch: 5 | loss: 0.0058182
	speed: 0.1604s/iter; left time: 1054.9890s
	iters: 400, epoch: 5 | loss: 0.0050540
	speed: 0.1601s/iter; left time: 1037.2865s
	iters: 500, epoch: 5 | loss: 0.0037161
	speed: 0.1615s/iter; left time: 1029.8301s
	iters: 600, epoch: 5 | loss: 0.0049531
	speed: 0.1733s/iter; left time: 1087.9866s
	iters: 700, epoch: 5 | loss: 4.9409652
	speed: 0.1813s/iter; left time: 1120.0551s
	iters: 800, epoch: 5 | loss: 0.0044442
	speed: 0.1738s/iter; left time: 1056.1621s
	iters: 900, epoch: 5 | loss: 12.7605724
	speed: 0.1596s/iter; left time: 953.9491s
	iters: 1000, epoch: 5 | loss: 0.0058011
	speed: 0.1621s/iter; left time: 952.5073s
	iters: 1100, epoch: 5 | loss: 6.2411337
	speed: 0.1609s/iter; left time: 929.7642s
Epoch: 5 cost time: 189.76250290870667
Epoch: 5, Steps: 1146 | Train Loss: 1.0027836 Vali Loss: 0.0083521 Test Loss: 0.0087460
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 1) (10444, 96, 1)
mse:0.007316267117857933, mae:0.07290905714035034
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training URT: Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36696
val 5175
test 10444
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.0057195
	speed: 0.1669s/iter; left time: 1895.8196s
	iters: 200, epoch: 1 | loss: 0.0055293
	speed: 0.1615s/iter; left time: 1819.1321s
	iters: 300, epoch: 1 | loss: 8.1624308
	speed: 0.1628s/iter; left time: 1816.9830s
	iters: 400, epoch: 1 | loss: 0.0043977
	speed: 0.1606s/iter; left time: 1775.9071s
	iters: 500, epoch: 1 | loss: 0.0049513
	speed: 0.1603s/iter; left time: 1757.5834s
	iters: 600, epoch: 1 | loss: 0.0047641
	speed: 0.1619s/iter; left time: 1758.5346s
	iters: 700, epoch: 1 | loss: 4.2119274
	speed: 0.1636s/iter; left time: 1760.9072s
	iters: 800, epoch: 1 | loss: 0.0045361
	speed: 0.1779s/iter; left time: 1896.2259s
	iters: 900, epoch: 1 | loss: 0.0067456
	speed: 0.1829s/iter; left time: 1931.2363s
	iters: 1000, epoch: 1 | loss: 0.0058624
	speed: 0.1682s/iter; left time: 1759.6897s
	iters: 1100, epoch: 1 | loss: 0.0041089
	speed: 0.1612s/iter; left time: 1669.6949s
Epoch: 1 cost time: 190.4127333164215
Update Best URT params
Epoch: 1, Steps: 1146 | Train Loss: 0.9868558 Vali Loss: 0.0060261 Test Loss: 0.0054480
Validation loss decreased (inf --> 0.006026).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0053885
	speed: 0.6217s/iter; left time: 6351.1457s
	iters: 200, epoch: 2 | loss: 0.1061202
	speed: 0.1624s/iter; left time: 1643.0163s
	iters: 300, epoch: 2 | loss: 0.0065430
	speed: 0.1614s/iter; left time: 1616.1561s
	iters: 400, epoch: 2 | loss: 0.0056466
	speed: 0.1610s/iter; left time: 1595.9681s
	iters: 500, epoch: 2 | loss: 0.0277744
	speed: 0.1603s/iter; left time: 1573.6870s
	iters: 600, epoch: 2 | loss: 0.0042294
	speed: 0.1632s/iter; left time: 1585.0939s
	iters: 700, epoch: 2 | loss: 0.0041538
	speed: 0.1614s/iter; left time: 1552.2140s
	iters: 800, epoch: 2 | loss: 0.0041266
	speed: 0.1607s/iter; left time: 1529.4654s
	iters: 900, epoch: 2 | loss: 8.1271877
	speed: 0.1605s/iter; left time: 1511.2583s
	iters: 1000, epoch: 2 | loss: 8.1536140
	speed: 0.1609s/iter; left time: 1498.6018s
	iters: 1100, epoch: 2 | loss: 0.2432083
	speed: 0.1617s/iter; left time: 1490.2164s
Epoch: 2 cost time: 186.78189158439636
Epoch: 2, Steps: 1146 | Train Loss: 0.9671522 Vali Loss: 0.0061735 Test Loss: 0.0057815
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.0036103
	speed: 0.6995s/iter; left time: 6343.7555s
	iters: 200, epoch: 3 | loss: 0.0055665
	speed: 0.1561s/iter; left time: 1400.0321s
	iters: 300, epoch: 3 | loss: 0.0042698
	speed: 0.1538s/iter; left time: 1363.9541s
	iters: 400, epoch: 3 | loss: 0.0048187
	speed: 0.1606s/iter; left time: 1407.9625s
	iters: 500, epoch: 3 | loss: 0.0052871
	speed: 0.1616s/iter; left time: 1401.2677s
	iters: 600, epoch: 3 | loss: 0.0039624
	speed: 0.1626s/iter; left time: 1393.7246s
	iters: 700, epoch: 3 | loss: 4.0002394
	speed: 0.1615s/iter; left time: 1367.6122s
	iters: 800, epoch: 3 | loss: 0.0048968
	speed: 0.1610s/iter; left time: 1347.1147s
	iters: 900, epoch: 3 | loss: 0.0054484
	speed: 0.1607s/iter; left time: 1328.5130s
	iters: 1000, epoch: 3 | loss: 0.0051701
	speed: 0.1607s/iter; left time: 1312.9010s
	iters: 1100, epoch: 3 | loss: 0.0062077
	speed: 0.1611s/iter; left time: 1300.0374s
Epoch: 3 cost time: 186.92331886291504
Update Best URT params
Epoch: 3, Steps: 1146 | Train Loss: 0.9738003 Vali Loss: 0.0059064 Test Loss: 0.0054717
Validation loss decreased (0.006026 --> 0.005906).  Saving model ...
	iters: 100, epoch: 4 | loss: 3.8090465
	speed: 0.6221s/iter; left time: 4929.2114s
	iters: 200, epoch: 4 | loss: 8.1423197
	speed: 0.1618s/iter; left time: 1265.7479s
	iters: 300, epoch: 4 | loss: 0.0060937
	speed: 0.1602s/iter; left time: 1237.3494s
	iters: 400, epoch: 4 | loss: 0.0043175
	speed: 0.1614s/iter; left time: 1230.3090s
	iters: 500, epoch: 4 | loss: 0.0035394
	speed: 0.2038s/iter; left time: 1533.3256s
	iters: 600, epoch: 4 | loss: 0.0038212
	speed: 0.1793s/iter; left time: 1330.6039s
	iters: 700, epoch: 4 | loss: 0.0048169
	speed: 0.1646s/iter; left time: 1205.1602s
	iters: 800, epoch: 4 | loss: 0.1681641
	speed: 0.1594s/iter; left time: 1151.5046s
	iters: 900, epoch: 4 | loss: 8.1333599
	speed: 0.1626s/iter; left time: 1158.3223s
	iters: 1000, epoch: 4 | loss: 0.0038496
	speed: 0.1613s/iter; left time: 1133.0393s
	iters: 1100, epoch: 4 | loss: 0.0051770
	speed: 0.1596s/iter; left time: 1104.7692s
Epoch: 4 cost time: 191.82154512405396
Epoch: 4, Steps: 1146 | Train Loss: 0.9751209 Vali Loss: 0.0059848 Test Loss: 0.0056600
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 5 | loss: 0.0756142
	speed: 0.6189s/iter; left time: 4194.5662s
	iters: 200, epoch: 5 | loss: 0.0116507
	speed: 0.1609s/iter; left time: 1074.4455s
	iters: 300, epoch: 5 | loss: 0.0042898
	speed: 0.1613s/iter; left time: 1060.7532s
	iters: 400, epoch: 5 | loss: 5.2295885
	speed: 0.1616s/iter; left time: 1046.8881s
	iters: 500, epoch: 5 | loss: 0.0039495
	speed: 0.1603s/iter; left time: 1022.5169s
	iters: 600, epoch: 5 | loss: 0.0043146
	speed: 0.1601s/iter; left time: 1004.8772s
	iters: 700, epoch: 5 | loss: 3.8118615
	speed: 0.1609s/iter; left time: 993.9252s
	iters: 800, epoch: 5 | loss: 0.0066865
	speed: 0.1622s/iter; left time: 985.7563s
	iters: 900, epoch: 5 | loss: 3.8203342
	speed: 0.1881s/iter; left time: 1124.5312s
	iters: 1000, epoch: 5 | loss: 0.0068980
	speed: 0.1790s/iter; left time: 1052.1205s
	iters: 1100, epoch: 5 | loss: 0.0051058
	speed: 0.1649s/iter; left time: 952.8510s
Epoch: 5 cost time: 190.13253903388977
Epoch: 5, Steps: 1146 | Train Loss: 0.9677091 Vali Loss: 0.0060246 Test Loss: 0.0057979
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 8.1221113
	speed: 0.6200s/iter; left time: 3491.4049s
	iters: 200, epoch: 6 | loss: 0.0051790
	speed: 0.1613s/iter; left time: 891.9487s
	iters: 300, epoch: 6 | loss: 3.8096166
	speed: 0.1624s/iter; left time: 882.1870s
	iters: 400, epoch: 6 | loss: 0.0042526
	speed: 0.1609s/iter; left time: 857.9613s
	iters: 500, epoch: 6 | loss: 0.0051409
	speed: 0.1599s/iter; left time: 836.3795s
	iters: 600, epoch: 6 | loss: 3.8436325
	speed: 0.1619s/iter; left time: 830.7640s
	iters: 700, epoch: 6 | loss: 0.0049102
	speed: 0.1621s/iter; left time: 815.6394s
	iters: 800, epoch: 6 | loss: 0.4272042
	speed: 0.1614s/iter; left time: 795.6387s
	iters: 900, epoch: 6 | loss: 0.0740077
	speed: 0.1605s/iter; left time: 775.3222s
	iters: 1000, epoch: 6 | loss: 0.9590196
	speed: 0.1609s/iter; left time: 761.3276s
	iters: 1100, epoch: 6 | loss: 0.1526606
	speed: 0.1606s/iter; left time: 743.9284s
Epoch: 6 cost time: 185.64731788635254
Epoch: 6, Steps: 1146 | Train Loss: 0.9720231 Vali Loss: 0.0059315 Test Loss: 0.0057808
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : Weather_E3k_96_96_B6autoformer_custom_ftS_sl96_ll48_pl96_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
test shape: (10444, 96, 1) (10444, 96, 1)
mse:0.005472131073474884, mae:0.056556619703769684
