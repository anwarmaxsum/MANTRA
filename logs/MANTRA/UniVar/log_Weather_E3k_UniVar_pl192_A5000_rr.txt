(torchenv) maxsum@WS-5820:~/ws/MTNs/Autoformer/Autoformer-main$ CUDA_VISIBLE_DEVICES=1 sh scripts/Weather_script/run_E3k_Weather_UniVar_v2_pl192.sh 
Args in experiment:
Namespace(is_training=1, model_id='Weather_E3kv2_96_192', model='B6autoformer', slow_model='AutoformerS1', data='custom', root_path='./dataset/weather/', data_path='weather.csv', features='S', target='OT', freq='h', checkpoints='./checkpoints1/', seq_len=96, label_len=48, pred_len=192, bucket_size=4, n_hashes=4, enc_in=1, dec_in=1, c_out=1, d_model=256, n_learner=3, n_heads=8, urt_heads=1, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=3, distil=True, dropout=0.01, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=3, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, anomaly=1.0, des='Exp', loss='mse', lradj='type1', use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', fix_seed='2023')
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 4.0730643
	speed: 0.2141s/iter; left time: 2425.8725s
	iters: 200, epoch: 1 | loss: 0.0025141
	speed: 0.1888s/iter; left time: 2120.9217s
	iters: 300, epoch: 1 | loss: 4.0891600
	speed: 0.1909s/iter; left time: 2125.0816s
	iters: 400, epoch: 1 | loss: 6.0703406
	speed: 0.1861s/iter; left time: 2053.3524s
	iters: 500, epoch: 1 | loss: 0.0026575
	speed: 0.1936s/iter; left time: 2115.7956s
	iters: 600, epoch: 1 | loss: 0.0051450
	speed: 0.1893s/iter; left time: 2049.9137s
	iters: 700, epoch: 1 | loss: 0.0176925
	speed: 0.1905s/iter; left time: 2044.1338s
	iters: 800, epoch: 1 | loss: 4.0742617
	speed: 0.1913s/iter; left time: 2033.9600s
	iters: 900, epoch: 1 | loss: 0.0939828
	speed: 0.1885s/iter; left time: 1984.7329s
	iters: 1000, epoch: 1 | loss: 0.0421830
	speed: 0.1920s/iter; left time: 2002.6546s
	iters: 1100, epoch: 1 | loss: 0.0051533
	speed: 0.1900s/iter; left time: 1963.2338s
Epoch: 1 cost time: 219.89505243301392
Epoch: 1, Steps: 1143 | Train Loss: 1.2421423 Vali Loss: 0.0090801 Test Loss: 0.0064133
Validation loss decreased (inf --> 0.009080).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0067471
	speed: 0.6115s/iter; left time: 6229.6318s
	iters: 200, epoch: 2 | loss: 0.0064462
	speed: 0.1888s/iter; left time: 1904.4097s
	iters: 300, epoch: 2 | loss: 0.0047253
	speed: 0.1902s/iter; left time: 1899.2532s
	iters: 400, epoch: 2 | loss: 0.0060591
	speed: 0.1924s/iter; left time: 1902.2340s
	iters: 500, epoch: 2 | loss: 0.0054104
	speed: 0.1919s/iter; left time: 1878.6847s
	iters: 600, epoch: 2 | loss: 4.5438643
	speed: 0.1922s/iter; left time: 1862.0882s
	iters: 700, epoch: 2 | loss: 6.0011854
	speed: 0.1896s/iter; left time: 1818.0811s
	iters: 800, epoch: 2 | loss: 0.0099089
	speed: 0.1876s/iter; left time: 1780.1321s
	iters: 900, epoch: 2 | loss: 0.0134050
	speed: 0.1955s/iter; left time: 1835.4894s
	iters: 1000, epoch: 2 | loss: 1.9128898
	speed: 0.1933s/iter; left time: 1794.9229s
	iters: 1100, epoch: 2 | loss: 0.0049751
	speed: 0.1912s/iter; left time: 1756.9492s
Epoch: 2 cost time: 219.32193231582642
Epoch: 2, Steps: 1143 | Train Loss: 1.1955017 Vali Loss: 0.0083100 Test Loss: 0.0081960
Validation loss decreased (0.009080 --> 0.008310).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 1.9129180
	speed: 0.6092s/iter; left time: 5510.4780s
	iters: 200, epoch: 3 | loss: 4.6659651
	speed: 0.1901s/iter; left time: 1700.1318s
	iters: 300, epoch: 3 | loss: 2.8690166
	speed: 0.1889s/iter; left time: 1670.4978s
	iters: 400, epoch: 3 | loss: 0.0043124
	speed: 0.1901s/iter; left time: 1662.2134s
	iters: 500, epoch: 3 | loss: 1.9257381
	speed: 0.1905s/iter; left time: 1646.9246s
	iters: 600, epoch: 3 | loss: 0.0049025
	speed: 0.1886s/iter; left time: 1611.8941s
	iters: 700, epoch: 3 | loss: 4.1144381
	speed: 0.1907s/iter; left time: 1610.6142s
	iters: 800, epoch: 3 | loss: 0.6031729
	speed: 0.1878s/iter; left time: 1567.2214s
	iters: 900, epoch: 3 | loss: 0.0046867
	speed: 0.1898s/iter; left time: 1565.0837s
	iters: 1000, epoch: 3 | loss: 0.0041943
	speed: 0.1930s/iter; left time: 1572.0123s
	iters: 1100, epoch: 3 | loss: 4.0744715
	speed: 0.1908s/iter; left time: 1534.6984s
Epoch: 3 cost time: 217.75476455688477
Epoch: 3, Steps: 1143 | Train Loss: 1.1619346 Vali Loss: 0.0057244 Test Loss: 0.0063842
Validation loss decreased (0.008310 --> 0.005724).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0048760
	speed: 0.6062s/iter; left time: 4790.5290s
	iters: 200, epoch: 4 | loss: 0.0054409
	speed: 0.1917s/iter; left time: 1495.7024s
	iters: 300, epoch: 4 | loss: 9.4854050
	speed: 0.1886s/iter; left time: 1452.7382s
	iters: 400, epoch: 4 | loss: 0.0054144
	speed: 0.1892s/iter; left time: 1438.0383s
	iters: 500, epoch: 4 | loss: 4.0849133
	speed: 0.1908s/iter; left time: 1431.2955s
	iters: 600, epoch: 4 | loss: 5.9899073
	speed: 0.1883s/iter; left time: 1393.8454s
	iters: 700, epoch: 4 | loss: 1.9130812
	speed: 0.1909s/iter; left time: 1394.1959s
	iters: 800, epoch: 4 | loss: 1.9212959
	speed: 0.1906s/iter; left time: 1372.3420s
	iters: 900, epoch: 4 | loss: 0.0051599
	speed: 0.1922s/iter; left time: 1364.7713s
	iters: 1000, epoch: 4 | loss: 0.4994351
	speed: 0.1900s/iter; left time: 1330.6401s
	iters: 1100, epoch: 4 | loss: 1.9200599
	speed: 0.1893s/iter; left time: 1306.2957s
Epoch: 4 cost time: 217.78203439712524
Epoch: 4, Steps: 1143 | Train Loss: 1.1363298 Vali Loss: 0.0058978 Test Loss: 0.0069612
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0030614
	speed: 0.6066s/iter; left time: 4099.8303s
	iters: 200, epoch: 5 | loss: 1.6601999
	speed: 0.1941s/iter; left time: 1292.6541s
	iters: 300, epoch: 5 | loss: 0.0044473
	speed: 0.1915s/iter; left time: 1255.9058s
	iters: 400, epoch: 5 | loss: 0.0033571
	speed: 0.1880s/iter; left time: 1214.1695s
	iters: 500, epoch: 5 | loss: 1.1072302
	speed: 0.1895s/iter; left time: 1205.2363s
	iters: 600, epoch: 5 | loss: 0.0050439
	speed: 0.1917s/iter; left time: 1199.7509s
	iters: 700, epoch: 5 | loss: 0.0049270
	speed: 0.1876s/iter; left time: 1155.3907s
	iters: 800, epoch: 5 | loss: 4.0811491
	speed: 0.1900s/iter; left time: 1151.2073s
	iters: 900, epoch: 5 | loss: 0.0028124
	speed: 0.1876s/iter; left time: 1118.0056s
	iters: 1000, epoch: 5 | loss: 4.0771103
	speed: 0.1911s/iter; left time: 1119.6695s
	iters: 1100, epoch: 5 | loss: 0.0039907
	speed: 0.1896s/iter; left time: 1091.9737s
Epoch: 5 cost time: 217.87594747543335
Epoch: 5, Steps: 1143 | Train Loss: 1.1016400 Vali Loss: 0.0054238 Test Loss: 0.0062752
Validation loss decreased (0.005724 --> 0.005424).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0031549
	speed: 0.6078s/iter; left time: 3413.6120s
	iters: 200, epoch: 6 | loss: 0.0040277
	speed: 0.1930s/iter; left time: 1064.3920s
	iters: 300, epoch: 6 | loss: 3.1499135
	speed: 0.1946s/iter; left time: 1054.0476s
	iters: 400, epoch: 6 | loss: 0.0043045
	speed: 0.1878s/iter; left time: 998.2150s
	iters: 500, epoch: 6 | loss: 5.2777805
	speed: 0.1920s/iter; left time: 1001.3657s
	iters: 600, epoch: 6 | loss: 0.0040270
	speed: 0.1878s/iter; left time: 960.9397s
	iters: 700, epoch: 6 | loss: 0.0036589
	speed: 0.1903s/iter; left time: 954.7220s
	iters: 800, epoch: 6 | loss: 0.0039861
	speed: 0.1867s/iter; left time: 917.8675s
	iters: 900, epoch: 6 | loss: 4.0712767
	speed: 0.1873s/iter; left time: 902.1401s
	iters: 1000, epoch: 6 | loss: 0.0043423
	speed: 0.1885s/iter; left time: 889.0259s
	iters: 1100, epoch: 6 | loss: 0.0070471
	speed: 0.1923s/iter; left time: 887.5336s
Epoch: 6 cost time: 217.62788677215576
Epoch: 6, Steps: 1143 | Train Loss: 1.0897389 Vali Loss: 0.0053486 Test Loss: 0.0064229
Validation loss decreased (0.005424 --> 0.005349).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0751389
	speed: 0.6096s/iter; left time: 2726.8091s
	iters: 200, epoch: 7 | loss: 0.0045002
	speed: 0.1865s/iter; left time: 815.4613s
	iters: 300, epoch: 7 | loss: 0.0038780
	speed: 0.1929s/iter; left time: 824.2440s
	iters: 400, epoch: 7 | loss: 0.0037349
	speed: 0.1900s/iter; left time: 792.9960s
	iters: 500, epoch: 7 | loss: 0.0051872
	speed: 0.1916s/iter; left time: 780.3304s
	iters: 600, epoch: 7 | loss: 0.0038936
	speed: 0.1924s/iter; left time: 764.5220s
	iters: 700, epoch: 7 | loss: 0.0039769
	speed: 0.1887s/iter; left time: 730.7651s
	iters: 800, epoch: 7 | loss: 14.0238752
	speed: 0.1890s/iter; left time: 713.1996s
	iters: 900, epoch: 7 | loss: 0.0031143
	speed: 0.1893s/iter; left time: 695.3856s
	iters: 1000, epoch: 7 | loss: 1.9206270
	speed: 0.1883s/iter; left time: 672.9478s
	iters: 1100, epoch: 7 | loss: 3.8421583
	speed: 0.1902s/iter; left time: 660.5335s
Epoch: 7 cost time: 217.947016954422
Epoch: 7, Steps: 1143 | Train Loss: 1.0860050 Vali Loss: 0.0051283 Test Loss: 0.0062389
Validation loss decreased (0.005349 --> 0.005128).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0038523
	speed: 0.6077s/iter; left time: 2023.6724s
	iters: 200, epoch: 8 | loss: 0.0034743
	speed: 0.1872s/iter; left time: 604.7152s
	iters: 300, epoch: 8 | loss: 1.9247625
	speed: 0.1923s/iter; left time: 601.8300s
	iters: 400, epoch: 8 | loss: 3.4082108
	speed: 0.1874s/iter; left time: 567.8487s
	iters: 500, epoch: 8 | loss: 0.0042909
	speed: 0.1889s/iter; left time: 553.5802s
	iters: 600, epoch: 8 | loss: 0.0036923
	speed: 0.1929s/iter; left time: 546.0212s
	iters: 700, epoch: 8 | loss: 0.0039456
	speed: 0.1906s/iter; left time: 520.2252s
	iters: 800, epoch: 8 | loss: 0.0034056
	speed: 0.1914s/iter; left time: 503.3089s
	iters: 900, epoch: 8 | loss: 1.9217706
	speed: 0.1895s/iter; left time: 479.3985s
	iters: 1000, epoch: 8 | loss: 0.0037957
	speed: 0.1919s/iter; left time: 466.3933s
	iters: 1100, epoch: 8 | loss: 1.0232161
	speed: 0.1913s/iter; left time: 445.6675s
Epoch: 8 cost time: 217.88825631141663
Epoch: 8, Steps: 1143 | Train Loss: 1.0811071 Vali Loss: 0.0053517 Test Loss: 0.0068205
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0035477
	speed: 0.6078s/iter; left time: 1329.3465s
	iters: 200, epoch: 9 | loss: 0.3185338
	speed: 0.1908s/iter; left time: 398.2046s
	iters: 300, epoch: 9 | loss: 0.0033643
	speed: 0.1903s/iter; left time: 378.0415s
	iters: 400, epoch: 9 | loss: 0.0032497
	speed: 0.1902s/iter; left time: 358.8363s
	iters: 500, epoch: 9 | loss: 0.0033926
	speed: 0.1890s/iter; left time: 337.7006s
	iters: 600, epoch: 9 | loss: 0.0330950
	speed: 0.1916s/iter; left time: 323.2907s
	iters: 700, epoch: 9 | loss: 0.0039588
	speed: 0.1932s/iter; left time: 306.5364s
	iters: 800, epoch: 9 | loss: 0.0039831
	speed: 0.1914s/iter; left time: 284.5713s
	iters: 900, epoch: 9 | loss: 2.1440773
	speed: 0.1909s/iter; left time: 264.8400s
	iters: 1000, epoch: 9 | loss: 0.0034309
	speed: 0.1886s/iter; left time: 242.7189s
	iters: 1100, epoch: 9 | loss: 2.2826407
	speed: 0.1905s/iter; left time: 226.1187s
Epoch: 9 cost time: 218.6084222793579
Epoch: 9, Steps: 1143 | Train Loss: 1.0851913 Vali Loss: 0.0051983 Test Loss: 0.0067363
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.2589210
	speed: 0.6059s/iter; left time: 632.6036s
	iters: 200, epoch: 10 | loss: 2.0106361
	speed: 0.1896s/iter; left time: 178.9733s
	iters: 300, epoch: 10 | loss: 0.0032549
	speed: 0.1890s/iter; left time: 159.5426s
	iters: 400, epoch: 10 | loss: 0.0034138
	speed: 0.1920s/iter; left time: 142.8422s
	iters: 500, epoch: 10 | loss: 0.0033484
	speed: 0.1907s/iter; left time: 122.8420s
	iters: 600, epoch: 10 | loss: 0.0037951
	speed: 0.1920s/iter; left time: 104.4287s
	iters: 700, epoch: 10 | loss: 0.0043675
	speed: 0.1924s/iter; left time: 85.4421s
	iters: 800, epoch: 10 | loss: 1.9163074
	speed: 0.1883s/iter; left time: 64.7878s
	iters: 900, epoch: 10 | loss: 4.0843549
	speed: 0.1888s/iter; left time: 46.0592s
	iters: 1000, epoch: 10 | loss: 0.2249546
	speed: 0.1896s/iter; left time: 27.3028s
	iters: 1100, epoch: 10 | loss: 0.0036957
	speed: 0.1930s/iter; left time: 8.4900s
Epoch: 10 cost time: 218.2978754043579
Epoch: 10, Steps: 1143 | Train Loss: 1.0843892 Vali Loss: 0.0052579 Test Loss: 0.0068188
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 1) (10348, 192, 1)
mse:0.006241253111511469, mae:0.05541592836380005
Test learner: 0 test 10348
mse:0.00363424071110785, mae:0.047128159552812576
Test learner: 1 test 10348
mse:0.011744854971766472, mae:0.09053688496351242
Test learner: 2 test 10348
mse:0.050313036888837814, mae:0.1821547895669937
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
>>>>>>>start training : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.0037965
	speed: 0.1927s/iter; left time: 2183.7640s
	iters: 200, epoch: 1 | loss: 1.9258962
	speed: 0.1902s/iter; left time: 2136.3386s
	iters: 300, epoch: 1 | loss: 1.5302480
	speed: 0.1898s/iter; left time: 2112.5836s
	iters: 400, epoch: 1 | loss: 0.0109699
	speed: 0.1916s/iter; left time: 2113.6535s
	iters: 500, epoch: 1 | loss: 1.9408183
	speed: 0.1922s/iter; left time: 2100.8341s
	iters: 600, epoch: 1 | loss: 0.0033933
	speed: 0.1889s/iter; left time: 2045.7802s
	iters: 700, epoch: 1 | loss: 0.0136682
	speed: 0.1939s/iter; left time: 2080.4295s
	iters: 800, epoch: 1 | loss: 0.0065750
	speed: 0.1912s/iter; left time: 2033.1161s
	iters: 900, epoch: 1 | loss: 2.5423760
	speed: 0.1935s/iter; left time: 2037.2365s
	iters: 1000, epoch: 1 | loss: 0.0057598
	speed: 0.1865s/iter; left time: 1945.2097s
	iters: 1100, epoch: 1 | loss: 4.0832567
	speed: 0.1949s/iter; left time: 2013.6152s
Epoch: 1 cost time: 219.03334760665894
Epoch: 1, Steps: 1143 | Train Loss: 1.2288699 Vali Loss: 0.0089535 Test Loss: 0.0094531
Validation loss decreased (inf --> 0.008954).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4540019
	speed: 0.6200s/iter; left time: 6316.1413s
	iters: 200, epoch: 2 | loss: 2.1808004
	speed: 0.1909s/iter; left time: 1925.4940s
	iters: 300, epoch: 2 | loss: 1.9744138
	speed: 0.1938s/iter; left time: 1935.2462s
	iters: 400, epoch: 2 | loss: 2.3250377
	speed: 0.1917s/iter; left time: 1895.9589s
	iters: 500, epoch: 2 | loss: 0.0065213
	speed: 0.1906s/iter; left time: 1866.0246s
	iters: 600, epoch: 2 | loss: 0.2730622
	speed: 0.1917s/iter; left time: 1857.1689s
	iters: 700, epoch: 2 | loss: 1.9331527
	speed: 0.1884s/iter; left time: 1806.5206s
	iters: 800, epoch: 2 | loss: 0.0092635
	speed: 0.1871s/iter; left time: 1775.4831s
	iters: 900, epoch: 2 | loss: 0.0070575
	speed: 0.1889s/iter; left time: 1773.3827s
	iters: 1000, epoch: 2 | loss: 0.0070543
	speed: 0.1937s/iter; left time: 1798.6963s
	iters: 1100, epoch: 2 | loss: 1.9124588
	speed: 0.1944s/iter; left time: 1786.4832s
Epoch: 2 cost time: 219.73382568359375
Epoch: 2, Steps: 1143 | Train Loss: 1.1920210 Vali Loss: 0.0107565 Test Loss: 0.0085300
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0053675
	speed: 0.6065s/iter; left time: 5485.6652s
	iters: 200, epoch: 3 | loss: 0.0045541
	speed: 0.1951s/iter; left time: 1745.5105s
	iters: 300, epoch: 3 | loss: 1.9233479
	speed: 0.1967s/iter; left time: 1740.1512s
	iters: 400, epoch: 3 | loss: 0.0059284
	speed: 0.1926s/iter; left time: 1684.2557s
	iters: 500, epoch: 3 | loss: 1.9128122
	speed: 0.1953s/iter; left time: 1688.2970s
	iters: 600, epoch: 3 | loss: 0.4302591
	speed: 0.1935s/iter; left time: 1653.8271s
	iters: 700, epoch: 3 | loss: 0.0163008
	speed: 0.1919s/iter; left time: 1620.8517s
	iters: 800, epoch: 3 | loss: 1.8166941
	speed: 0.1940s/iter; left time: 1619.2395s
	iters: 900, epoch: 3 | loss: 0.0071482
	speed: 0.1891s/iter; left time: 1559.0184s
	iters: 1000, epoch: 3 | loss: 0.0067191
	speed: 0.1895s/iter; left time: 1543.0866s
	iters: 1100, epoch: 3 | loss: 0.0090534
	speed: 0.1878s/iter; left time: 1510.5905s
Epoch: 3 cost time: 220.55612182617188
Epoch: 3, Steps: 1143 | Train Loss: 1.1484033 Vali Loss: 0.0080684 Test Loss: 0.0068866
Validation loss decreased (0.008954 --> 0.008068).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 1.9102733
	speed: 0.6050s/iter; left time: 4781.0570s
	iters: 200, epoch: 4 | loss: 0.0045855
	speed: 0.1902s/iter; left time: 1483.7799s
	iters: 300, epoch: 4 | loss: 2.8380668
	speed: 0.1876s/iter; left time: 1445.1704s
	iters: 400, epoch: 4 | loss: 1.4781530
	speed: 0.1892s/iter; left time: 1438.3714s
	iters: 500, epoch: 4 | loss: 0.0073812
	speed: 0.1905s/iter; left time: 1428.7838s
	iters: 600, epoch: 4 | loss: 0.0052269
	speed: 0.1921s/iter; left time: 1421.9054s
	iters: 700, epoch: 4 | loss: 0.0064571
	speed: 0.1940s/iter; left time: 1416.9453s
	iters: 800, epoch: 4 | loss: 0.0045262
	speed: 0.1906s/iter; left time: 1372.3729s
	iters: 900, epoch: 4 | loss: 0.0042154
	speed: 0.1900s/iter; left time: 1349.1187s
	iters: 1000, epoch: 4 | loss: 0.0086221
	speed: 0.1894s/iter; left time: 1326.4649s
	iters: 1100, epoch: 4 | loss: 0.0056436
	speed: 0.1913s/iter; left time: 1320.1814s
Epoch: 4 cost time: 218.2270188331604
Epoch: 4, Steps: 1143 | Train Loss: 1.1163573 Vali Loss: 0.0090921 Test Loss: 0.0073651
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.3696083
	speed: 0.6040s/iter; left time: 4082.2186s
	iters: 200, epoch: 5 | loss: 0.0062490
	speed: 0.1907s/iter; left time: 1269.8865s
	iters: 300, epoch: 5 | loss: 0.0038621
	speed: 0.1849s/iter; left time: 1212.5032s
	iters: 400, epoch: 5 | loss: 0.9355690
	speed: 0.1844s/iter; left time: 1190.7313s
	iters: 500, epoch: 5 | loss: 1.9164317
	speed: 0.1797s/iter; left time: 1142.3945s
	iters: 600, epoch: 5 | loss: 4.0749459
	speed: 0.1798s/iter; left time: 1125.1450s
	iters: 700, epoch: 5 | loss: 0.0068681
	speed: 0.1804s/iter; left time: 1111.1044s
	iters: 800, epoch: 5 | loss: 0.0048284
	speed: 0.1817s/iter; left time: 1101.0190s
	iters: 900, epoch: 5 | loss: 0.0060126
	speed: 0.1791s/iter; left time: 1066.9698s
	iters: 1000, epoch: 5 | loss: 3.2311921
	speed: 0.1773s/iter; left time: 1039.0368s
	iters: 1100, epoch: 5 | loss: 1.9132174
	speed: 0.1792s/iter; left time: 1031.7868s
Epoch: 5 cost time: 209.19668245315552
Epoch: 5, Steps: 1143 | Train Loss: 1.1033660 Vali Loss: 0.0061124 Test Loss: 0.0049416
Validation loss decreased (0.008068 --> 0.006112).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0039858
	speed: 0.5806s/iter; left time: 3260.7764s
	iters: 200, epoch: 6 | loss: 0.0033499
	speed: 0.1802s/iter; left time: 993.8744s
	iters: 300, epoch: 6 | loss: 4.0857534
	speed: 0.1824s/iter; left time: 987.8071s
	iters: 400, epoch: 6 | loss: 0.0038814
	speed: 0.1776s/iter; left time: 944.2294s
	iters: 500, epoch: 6 | loss: 1.9173360
	speed: 0.1848s/iter; left time: 964.1038s
	iters: 600, epoch: 6 | loss: 0.0041762
	speed: 0.1813s/iter; left time: 927.6339s
	iters: 700, epoch: 6 | loss: 0.0035655
	speed: 0.2932s/iter; left time: 1470.7576s
	iters: 800, epoch: 6 | loss: 0.0043397
	speed: 0.3803s/iter; left time: 1869.7627s
	iters: 900, epoch: 6 | loss: 4.0704484
	speed: 0.3790s/iter; left time: 1825.2765s
	iters: 1000, epoch: 6 | loss: 0.0038950
	speed: 0.3767s/iter; left time: 1776.3794s
	iters: 1100, epoch: 6 | loss: 1.9250755
	speed: 0.3806s/iter; left time: 1756.9225s
Epoch: 6 cost time: 306.79897570610046
Epoch: 6, Steps: 1143 | Train Loss: 1.1022496 Vali Loss: 0.0063924 Test Loss: 0.0054659
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0040663
	speed: 1.0360s/iter; left time: 4634.1699s
	iters: 200, epoch: 7 | loss: 0.0040581
	speed: 0.3782s/iter; left time: 1653.8383s
	iters: 300, epoch: 7 | loss: 4.0701590
	speed: 0.3776s/iter; left time: 1613.6563s
	iters: 400, epoch: 7 | loss: 1.7085583
	speed: 0.3775s/iter; left time: 1575.4286s
	iters: 500, epoch: 7 | loss: 4.0766149
	speed: 0.3768s/iter; left time: 1534.6904s
	iters: 600, epoch: 7 | loss: 0.0044747
	speed: 0.3624s/iter; left time: 1439.6600s
	iters: 700, epoch: 7 | loss: 0.0043926
	speed: 0.3733s/iter; left time: 1445.9251s
	iters: 800, epoch: 7 | loss: 0.0049362
	speed: 0.3765s/iter; left time: 1420.4534s
	iters: 900, epoch: 7 | loss: 0.0032184
	speed: 0.3767s/iter; left time: 1383.4375s
	iters: 1000, epoch: 7 | loss: 0.0038199
	speed: 0.3815s/iter; left time: 1363.1010s
	iters: 1100, epoch: 7 | loss: 0.0036532
	speed: 0.3829s/iter; left time: 1329.9341s
Epoch: 7 cost time: 431.52244234085083
Epoch: 7, Steps: 1143 | Train Loss: 1.0975202 Vali Loss: 0.0056083 Test Loss: 0.0049298
Validation loss decreased (0.006112 --> 0.005608).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0045239
	speed: 1.0381s/iter; left time: 3456.7182s
	iters: 200, epoch: 8 | loss: 4.0793376
	speed: 0.3801s/iter; left time: 1227.6675s
	iters: 300, epoch: 8 | loss: 0.1574102
	speed: 0.3754s/iter; left time: 1175.1442s
	iters: 400, epoch: 8 | loss: 1.7911060
	speed: 0.3840s/iter; left time: 1163.5036s
	iters: 500, epoch: 8 | loss: 1.0268586
	speed: 0.3774s/iter; left time: 1105.7652s
	iters: 600, epoch: 8 | loss: 1.9685128
	speed: 0.3713s/iter; left time: 1050.8120s
	iters: 700, epoch: 8 | loss: 0.8437948
	speed: 0.3622s/iter; left time: 988.8386s
	iters: 800, epoch: 8 | loss: 0.0045147
	speed: 0.3688s/iter; left time: 969.9634s
	iters: 900, epoch: 8 | loss: 1.3363161
	speed: 0.3811s/iter; left time: 964.3004s
	iters: 1000, epoch: 8 | loss: 0.0037235
	speed: 0.3738s/iter; left time: 908.2754s
	iters: 1100, epoch: 8 | loss: 0.0045247
	speed: 0.3782s/iter; left time: 881.1171s
Epoch: 8 cost time: 429.93976640701294
Epoch: 8, Steps: 1143 | Train Loss: 1.0929821 Vali Loss: 0.0060277 Test Loss: 0.0047199
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 1.9214261
	speed: 1.0501s/iter; left time: 2296.5682s
	iters: 200, epoch: 9 | loss: 0.0511651
	speed: 0.3793s/iter; left time: 791.6445s
	iters: 300, epoch: 9 | loss: 1.9240526
	speed: 0.3766s/iter; left time: 748.2118s
	iters: 400, epoch: 9 | loss: 0.0033754
	speed: 0.3733s/iter; left time: 704.4097s
	iters: 500, epoch: 9 | loss: 0.0046763
	speed: 0.3786s/iter; left time: 676.6342s
	iters: 600, epoch: 9 | loss: 0.0038521
	speed: 0.3786s/iter; left time: 638.7108s
	iters: 700, epoch: 9 | loss: 1.9257805
	speed: 0.3669s/iter; left time: 582.2044s
	iters: 800, epoch: 9 | loss: 2.0331383
	speed: 0.3764s/iter; left time: 559.6535s
	iters: 900, epoch: 9 | loss: 0.0038108
	speed: 0.3713s/iter; left time: 514.9334s
	iters: 1000, epoch: 9 | loss: 0.0038185
	speed: 0.3802s/iter; left time: 489.3522s
	iters: 1100, epoch: 9 | loss: 1.9119828
	speed: 0.3774s/iter; left time: 447.9320s
Epoch: 9 cost time: 430.8540482521057
Epoch: 9, Steps: 1143 | Train Loss: 1.0922629 Vali Loss: 0.0057676 Test Loss: 0.0045230
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0042481
	speed: 1.0629s/iter; left time: 1109.6332s
	iters: 200, epoch: 10 | loss: 0.0045203
	speed: 0.3854s/iter; left time: 363.8004s
	iters: 300, epoch: 10 | loss: 0.0037402
	speed: 0.3809s/iter; left time: 321.4448s
	iters: 400, epoch: 10 | loss: 0.2434948
	speed: 0.3835s/iter; left time: 285.3384s
	iters: 500, epoch: 10 | loss: 1.6920389
	speed: 0.3769s/iter; left time: 242.7056s
	iters: 600, epoch: 10 | loss: 4.0815806
	speed: 0.3777s/iter; left time: 205.4574s
	iters: 700, epoch: 10 | loss: 0.0031431
	speed: 0.3721s/iter; left time: 165.2268s
	iters: 800, epoch: 10 | loss: 0.0047183
	speed: 0.3657s/iter; left time: 125.8176s
	iters: 900, epoch: 10 | loss: 0.0040658
	speed: 0.3714s/iter; left time: 90.6095s
	iters: 1000, epoch: 10 | loss: 0.0056331
	speed: 0.3773s/iter; left time: 54.3259s
	iters: 1100, epoch: 10 | loss: 0.2089950
	speed: 0.3788s/iter; left time: 16.6692s
Epoch: 10 cost time: 432.25275683403015
Epoch: 10, Steps: 1143 | Train Loss: 1.0937861 Vali Loss: 0.0057746 Test Loss: 0.0045492
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 1) (10348, 192, 1)
mse:0.0049285790883004665, mae:0.05641919746994972
Test learner: 0 test 10348
mse:0.003571199020370841, mae:0.04559376835823059
Test learner: 1 test 10348
mse:0.01448642648756504, mae:0.09807826578617096
Test learner: 2 test 10348
mse:0.0065219225361943245, mae:0.054522302001714706
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.0028776
	speed: 0.3849s/iter; left time: 4361.1081s
	iters: 200, epoch: 1 | loss: 0.0026765
	speed: 0.3808s/iter; left time: 4276.5731s
	iters: 300, epoch: 1 | loss: 0.0116597
	speed: 0.3807s/iter; left time: 4237.2324s
	iters: 400, epoch: 1 | loss: 2.4773436
	speed: 0.3783s/iter; left time: 4173.0125s
	iters: 500, epoch: 1 | loss: 1.9288678
	speed: 0.3763s/iter; left time: 4112.9822s
	iters: 600, epoch: 1 | loss: 3.8522410
	speed: 0.3614s/iter; left time: 3914.7228s
	iters: 700, epoch: 1 | loss: 0.0064771
	speed: 0.3702s/iter; left time: 3972.6896s
	iters: 800, epoch: 1 | loss: 0.0064202
	speed: 0.3716s/iter; left time: 3950.2387s
	iters: 900, epoch: 1 | loss: 5.9967279
	speed: 0.3772s/iter; left time: 3972.6093s
	iters: 1000, epoch: 1 | loss: 0.0108277
	speed: 0.3764s/iter; left time: 3926.2065s
	iters: 1100, epoch: 1 | loss: 0.0102268
	speed: 0.3820s/iter; left time: 3946.0184s
Epoch: 1 cost time: 430.6980080604553
Epoch: 1, Steps: 1143 | Train Loss: 1.2184845 Vali Loss: 0.0111859 Test Loss: 0.0088923
Validation loss decreased (inf --> 0.011186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 4.0829759
	speed: 1.0426s/iter; left time: 10622.5022s
	iters: 200, epoch: 2 | loss: 4.4322977
	speed: 0.3791s/iter; left time: 3824.2549s
	iters: 300, epoch: 2 | loss: 0.0040659
	speed: 0.3758s/iter; left time: 3753.5652s
	iters: 400, epoch: 2 | loss: 1.9337419
	speed: 0.3785s/iter; left time: 3742.1463s
	iters: 500, epoch: 2 | loss: 0.7291840
	speed: 0.3749s/iter; left time: 3669.0499s
	iters: 600, epoch: 2 | loss: 0.0078743
	speed: 0.3678s/iter; left time: 3563.6230s
	iters: 700, epoch: 2 | loss: 0.0036232
	speed: 0.3653s/iter; left time: 3502.7388s
	iters: 800, epoch: 2 | loss: 2.2556708
	speed: 0.3654s/iter; left time: 3467.0688s
	iters: 900, epoch: 2 | loss: 3.2724349
	speed: 0.3775s/iter; left time: 3544.3998s
	iters: 1000, epoch: 2 | loss: 0.0093833
	speed: 0.3778s/iter; left time: 3509.3304s
	iters: 1100, epoch: 2 | loss: 0.0057385
	speed: 0.3818s/iter; left time: 3507.9878s
Epoch: 2 cost time: 430.01839232444763
Epoch: 2, Steps: 1143 | Train Loss: 1.1861223 Vali Loss: 0.0067228 Test Loss: 0.0052833
Validation loss decreased (0.011186 --> 0.006723).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.0037902
	speed: 1.0526s/iter; left time: 9521.0981s
	iters: 200, epoch: 3 | loss: 0.0240820
	speed: 0.3767s/iter; left time: 3369.5820s
	iters: 300, epoch: 3 | loss: 0.0067818
	speed: 0.3839s/iter; left time: 3395.8893s
	iters: 400, epoch: 3 | loss: 0.0050355
	speed: 0.3819s/iter; left time: 3339.7459s
	iters: 500, epoch: 3 | loss: 0.0058475
	speed: 0.3795s/iter; left time: 3281.1938s
	iters: 600, epoch: 3 | loss: 0.0069633
	speed: 0.3800s/iter; left time: 3247.0000s
	iters: 700, epoch: 3 | loss: 1.9201273
	speed: 0.3665s/iter; left time: 3095.1865s
	iters: 800, epoch: 3 | loss: 0.0042200
	speed: 0.3677s/iter; left time: 3068.0429s
	iters: 900, epoch: 3 | loss: 5.4059153
	speed: 0.3739s/iter; left time: 3082.8957s
	iters: 1000, epoch: 3 | loss: 1.6562222
	speed: 0.3786s/iter; left time: 3083.8368s
	iters: 1100, epoch: 3 | loss: 0.0064026
	speed: 0.3792s/iter; left time: 3050.6524s
Epoch: 3 cost time: 431.6730456352234
Epoch: 3, Steps: 1143 | Train Loss: 1.1534202 Vali Loss: 0.0108447 Test Loss: 0.0109494
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 4 | loss: 0.0042453
	speed: 1.0540s/iter; left time: 8328.8320s
	iters: 200, epoch: 4 | loss: 3.1880481
	speed: 0.3797s/iter; left time: 2962.0500s
	iters: 300, epoch: 4 | loss: 0.0040127
	speed: 0.3800s/iter; left time: 2926.4574s
	iters: 400, epoch: 4 | loss: 1.9208244
	speed: 0.3797s/iter; left time: 2886.4335s
	iters: 500, epoch: 4 | loss: 4.4495811
	speed: 0.3781s/iter; left time: 2836.3088s
	iters: 600, epoch: 4 | loss: 0.0042727
	speed: 0.3783s/iter; left time: 2800.1454s
	iters: 700, epoch: 4 | loss: 0.0043557
	speed: 0.3731s/iter; left time: 2724.3480s
	iters: 800, epoch: 4 | loss: 1.9211562
	speed: 0.3639s/iter; left time: 2620.7666s
	iters: 900, epoch: 4 | loss: 0.0047566
	speed: 0.3682s/iter; left time: 2614.8701s
	iters: 1000, epoch: 4 | loss: 4.0811834
	speed: 0.3819s/iter; left time: 2673.9639s
	iters: 1100, epoch: 4 | loss: 0.0053203
	speed: 0.3778s/iter; left time: 2607.3956s
Epoch: 4 cost time: 431.344269990921
Epoch: 4, Steps: 1143 | Train Loss: 1.1162315 Vali Loss: 0.0074696 Test Loss: 0.0089803
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 5 | loss: 0.0033997
	speed: 1.0494s/iter; left time: 7093.1895s
	iters: 200, epoch: 5 | loss: 0.0038961
	speed: 0.3796s/iter; left time: 2527.9097s
	iters: 300, epoch: 5 | loss: 0.0037830
	speed: 0.3803s/iter; left time: 2494.2025s
	iters: 400, epoch: 5 | loss: 2.0863135
	speed: 0.3805s/iter; left time: 2457.3625s
	iters: 500, epoch: 5 | loss: 1.1734707
	speed: 0.3778s/iter; left time: 2402.5522s
	iters: 600, epoch: 5 | loss: 1.9230913
	speed: 0.3788s/iter; left time: 2370.7179s
	iters: 700, epoch: 5 | loss: 0.9468462
	speed: 0.3797s/iter; left time: 2338.5239s
	iters: 800, epoch: 5 | loss: 5.5785646
	speed: 0.3814s/iter; left time: 2310.7306s
	iters: 900, epoch: 5 | loss: 0.0049416
	speed: 0.3595s/iter; left time: 2142.3560s
	iters: 1000, epoch: 5 | loss: 0.0040749
	speed: 0.3590s/iter; left time: 2103.2700s
	iters: 1100, epoch: 5 | loss: 0.7052650
	speed: 0.3397s/iter; left time: 1956.5937s
Epoch: 5 cost time: 424.0537152290344
Epoch: 5, Steps: 1143 | Train Loss: 1.1020326 Vali Loss: 0.0057641 Test Loss: 0.0057035
Validation loss decreased (0.006723 --> 0.005764).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 6 | loss: 0.0052868
	speed: 1.0383s/iter; left time: 5831.0101s
	iters: 200, epoch: 6 | loss: 0.0036157
	speed: 0.3841s/iter; left time: 2118.4564s
	iters: 300, epoch: 6 | loss: 1.9237689
	speed: 0.3816s/iter; left time: 2066.5974s
	iters: 400, epoch: 6 | loss: 0.0036454
	speed: 0.3820s/iter; left time: 2030.8585s
	iters: 500, epoch: 6 | loss: 1.9129725
	speed: 0.3803s/iter; left time: 1983.8524s
	iters: 600, epoch: 6 | loss: 0.0035345
	speed: 0.3776s/iter; left time: 1932.0011s
	iters: 700, epoch: 6 | loss: 0.0033999
	speed: 0.3798s/iter; left time: 1905.2119s
	iters: 800, epoch: 6 | loss: 0.0039839
	speed: 0.3812s/iter; left time: 1874.0182s
	iters: 900, epoch: 6 | loss: 0.1489034
	speed: 0.3784s/iter; left time: 1822.5526s
	iters: 1000, epoch: 6 | loss: 0.0030910
	speed: 0.3786s/iter; left time: 1785.3140s
	iters: 1100, epoch: 6 | loss: 1.9106352
	speed: 0.3729s/iter; left time: 1721.1116s
Epoch: 6 cost time: 434.68560123443604
Epoch: 6, Steps: 1143 | Train Loss: 1.0949562 Vali Loss: 0.0048693 Test Loss: 0.0048363
Validation loss decreased (0.005764 --> 0.004869).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 7 | loss: 0.0037415
	speed: 1.1132s/iter; left time: 4979.2754s
	iters: 200, epoch: 7 | loss: 4.0669527
	speed: 0.3861s/iter; left time: 1688.4450s
	iters: 300, epoch: 7 | loss: 0.2410764
	speed: 0.3824s/iter; left time: 1634.0925s
	iters: 400, epoch: 7 | loss: 0.0035147
	speed: 0.3807s/iter; left time: 1588.8325s
	iters: 500, epoch: 7 | loss: 0.0030074
	speed: 0.3846s/iter; left time: 1566.3557s
	iters: 600, epoch: 7 | loss: 0.0030854
	speed: 0.3799s/iter; left time: 1509.3949s
	iters: 700, epoch: 7 | loss: 0.0038516
	speed: 0.3792s/iter; left time: 1468.6330s
	iters: 800, epoch: 7 | loss: 0.0031807
	speed: 0.3875s/iter; left time: 1461.8621s
	iters: 900, epoch: 7 | loss: 0.0042982
	speed: 0.3846s/iter; left time: 1412.7637s
	iters: 1000, epoch: 7 | loss: 0.0041555
	speed: 0.3828s/iter; left time: 1367.8198s
	iters: 1100, epoch: 7 | loss: 1.9097155
	speed: 0.3874s/iter; left time: 1345.4056s
Epoch: 7 cost time: 437.37616443634033
Epoch: 7, Steps: 1143 | Train Loss: 1.1056361 Vali Loss: 0.0045564 Test Loss: 0.0054846
Validation loss decreased (0.004869 --> 0.004556).  Saving model ...
Updating learning rate to 1.5625e-06
	iters: 100, epoch: 8 | loss: 0.0038875
	speed: 1.1185s/iter; left time: 3724.6219s
	iters: 200, epoch: 8 | loss: 0.0036403
	speed: 0.3786s/iter; left time: 1222.8838s
	iters: 300, epoch: 8 | loss: 0.0027349
	speed: 0.3846s/iter; left time: 1203.7790s
	iters: 400, epoch: 8 | loss: 0.0041979
	speed: 0.3815s/iter; left time: 1156.0243s
	iters: 500, epoch: 8 | loss: 0.0037594
	speed: 0.3815s/iter; left time: 1117.8846s
	iters: 600, epoch: 8 | loss: 0.0044314
	speed: 0.3849s/iter; left time: 1089.3457s
	iters: 700, epoch: 8 | loss: 0.0034847
	speed: 0.3839s/iter; left time: 1047.9262s
	iters: 800, epoch: 8 | loss: 0.0034387
	speed: 0.3851s/iter; left time: 1012.8269s
	iters: 900, epoch: 8 | loss: 0.0036347
	speed: 0.3820s/iter; left time: 966.5572s
	iters: 1000, epoch: 8 | loss: 0.0030398
	speed: 0.3819s/iter; left time: 928.0782s
	iters: 1100, epoch: 8 | loss: 1.9109542
	speed: 0.3905s/iter; left time: 909.8398s
Epoch: 8 cost time: 437.2373893260956
Epoch: 8, Steps: 1143 | Train Loss: 1.1024512 Vali Loss: 0.0045146 Test Loss: 0.0052144
Validation loss decreased (0.004556 --> 0.004515).  Saving model ...
Updating learning rate to 7.8125e-07
	iters: 100, epoch: 9 | loss: 0.0032155
	speed: 1.0864s/iter; left time: 2375.8879s
	iters: 200, epoch: 9 | loss: 1.1032517
	speed: 0.3820s/iter; left time: 797.1794s
	iters: 300, epoch: 9 | loss: 0.0025815
	speed: 0.3766s/iter; left time: 748.3599s
	iters: 400, epoch: 9 | loss: 2.7543533
	speed: 0.3837s/iter; left time: 723.9722s
	iters: 500, epoch: 9 | loss: 0.0031414
	speed: 0.3818s/iter; left time: 682.2943s
	iters: 600, epoch: 9 | loss: 0.0034637
	speed: 0.3815s/iter; left time: 643.5380s
	iters: 700, epoch: 9 | loss: 0.0037095
	speed: 0.3828s/iter; left time: 607.4729s
	iters: 800, epoch: 9 | loss: 0.0036578
	speed: 0.3877s/iter; left time: 576.4409s
	iters: 900, epoch: 9 | loss: 0.0035134
	speed: 0.3817s/iter; left time: 529.4471s
	iters: 1000, epoch: 9 | loss: 1.9126942
	speed: 0.3868s/iter; left time: 497.7972s
	iters: 1100, epoch: 9 | loss: 4.0770321
	speed: 0.3787s/iter; left time: 449.5317s
Epoch: 9 cost time: 436.00302290916443
Epoch: 9, Steps: 1143 | Train Loss: 1.0971361 Vali Loss: 0.0043984 Test Loss: 0.0051995
Validation loss decreased (0.004515 --> 0.004398).  Saving model ...
Updating learning rate to 3.90625e-07
	iters: 100, epoch: 10 | loss: 0.0039422
	speed: 1.0552s/iter; left time: 1101.6269s
	iters: 200, epoch: 10 | loss: 0.1798523
	speed: 0.3725s/iter; left time: 351.6585s
	iters: 300, epoch: 10 | loss: 1.6380947
	speed: 0.3851s/iter; left time: 325.0365s
	iters: 400, epoch: 10 | loss: 0.0031535
	speed: 0.3783s/iter; left time: 281.4697s
	iters: 500, epoch: 10 | loss: 0.0031417
	speed: 0.3788s/iter; left time: 243.9697s
	iters: 600, epoch: 10 | loss: 0.0031130
	speed: 0.3838s/iter; left time: 208.7668s
	iters: 700, epoch: 10 | loss: 1.9140061
	speed: 0.3821s/iter; left time: 169.6678s
	iters: 800, epoch: 10 | loss: 0.6080781
	speed: 0.3832s/iter; left time: 131.8352s
	iters: 900, epoch: 10 | loss: 1.9229429
	speed: 0.3864s/iter; left time: 94.2879s
	iters: 1000, epoch: 10 | loss: 0.0094123
	speed: 0.3784s/iter; left time: 54.4859s
	iters: 1100, epoch: 10 | loss: 0.0035194
	speed: 0.3785s/iter; left time: 16.6544s
Epoch: 10 cost time: 434.1562695503235
Epoch: 10, Steps: 1143 | Train Loss: 1.0990540 Vali Loss: 0.0043985 Test Loss: 0.0052349
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-07
>>>>>>>testing : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 1) (10348, 192, 1)
mse:0.005203811451792717, mae:0.05111496150493622
Test learner: 0 test 10348
mse:0.004785591270774603, mae:0.05418414995074272
Test learner: 1 test 10348
mse:0.023544378578662872, mae:0.10249615460634232
Test learner: 2 test 10348
mse:0.004526444710791111, mae:0.04383791610598564
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.00389789473592771
stdev: 0.009013802066105327
stdev: 0.0062924702990542645
stdev: 0.0021393648415386213
stdev: 0.0022720710031736715
stdev: 0.005211060330473793
stdev: 0.0011988069545634107
stdev: 0.0075454724139043545
stdev: 0.0057194860804500045
stdev: 0.005904417149294411
stdev: 0.005107359343831957
stdev: 0.005512440381976261
stdev: 0.004550216975213523
stdev: 0.0023605507292126858
stdev: 0.004247876594197319
stdev: 0.0024586930618065903
stdev: 0.004041628237529124
stdev: 0.0026229095268389944
stdev: 0.004518922610259292
stdev: 0.0013208338936367935
stdev: 0.006083754840266261
stdev: 0.002831153426857548
stdev: 0.003885440118990134
stdev: 0.0043890740448641035
stdev: 0.002656487276448098
stdev: 0.0019355665271763543
stdev: 0.00509434502092531
stdev: 0.002762774537423048
stdev: 0.004406728802978894
stdev: 0.009374787633533964
stdev: 0.007841437418818487
stdev: 0.007936878138929144
stdev: 0.006370305015692377
stdev: 0.00812459032495573
stdev: 0.008293044732903869
stdev: 0.00982501503183741
stdev: 0.008963067286477621
stdev: 0.0019882101292753767
>>>>>>>start training URT: Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.0043748
	speed: 0.1780s/iter; left time: 2016.7110s
	iters: 200, epoch: 1 | loss: 0.0027807
	speed: 0.1554s/iter; left time: 1745.0143s
	iters: 300, epoch: 1 | loss: 0.0037923
	speed: 0.1505s/iter; left time: 1674.9608s
	iters: 400, epoch: 1 | loss: 0.0026269
	speed: 0.1547s/iter; left time: 1706.9036s
	iters: 500, epoch: 1 | loss: 0.0030344
	speed: 0.1589s/iter; left time: 1736.7872s
	iters: 600, epoch: 1 | loss: 0.0035732
	speed: 0.1618s/iter; left time: 1752.7436s
	iters: 700, epoch: 1 | loss: 0.1343153
	speed: 0.1572s/iter; left time: 1686.4560s
	iters: 800, epoch: 1 | loss: 0.0030410
	speed: 0.1519s/iter; left time: 1614.8343s
	iters: 900, epoch: 1 | loss: 1.9065967
	speed: 0.1505s/iter; left time: 1584.7083s
	iters: 1000, epoch: 1 | loss: 4.0696726
	speed: 0.1508s/iter; left time: 1573.2101s
	iters: 1100, epoch: 1 | loss: 1.5937192
	speed: 0.1537s/iter; left time: 1587.9807s
Epoch: 1 cost time: 178.87304091453552
Update Best URT params
Epoch: 1, Steps: 1143 | Train Loss: 1.0713167 Vali Loss: 0.0054066 Test Loss: 0.0066282
Validation loss decreased (inf --> 0.005407).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0035514
	speed: 0.5650s/iter; left time: 5756.5249s
	iters: 200, epoch: 2 | loss: 0.0037050
	speed: 0.1515s/iter; left time: 1527.8902s
	iters: 300, epoch: 2 | loss: 0.0063376
	speed: 0.1545s/iter; left time: 1542.8264s
	iters: 400, epoch: 2 | loss: 0.0043587
	speed: 0.1518s/iter; left time: 1500.9415s
	iters: 500, epoch: 2 | loss: 0.0038478
	speed: 0.1553s/iter; left time: 1520.5012s
	iters: 600, epoch: 2 | loss: 8.1311684
	speed: 0.1513s/iter; left time: 1465.8677s
	iters: 700, epoch: 2 | loss: 0.0041043
	speed: 0.1541s/iter; left time: 1477.0765s
	iters: 800, epoch: 2 | loss: 1.9269989
	speed: 0.1519s/iter; left time: 1441.4530s
	iters: 900, epoch: 2 | loss: 0.0032880
	speed: 0.1564s/iter; left time: 1468.2433s
	iters: 1000, epoch: 2 | loss: 0.0031876
	speed: 0.1538s/iter; left time: 1428.1033s
	iters: 1100, epoch: 2 | loss: 0.0039105
	speed: 0.1521s/iter; left time: 1397.1943s
Epoch: 2 cost time: 176.51710271835327
Update Best URT params
Epoch: 2, Steps: 1143 | Train Loss: 1.0648259 Vali Loss: 0.0052424 Test Loss: 0.0079544
Validation loss decreased (0.005407 --> 0.005242).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0044158
	speed: 0.5593s/iter; left time: 5058.6527s
	iters: 200, epoch: 3 | loss: 0.1693465
	speed: 0.1539s/iter; left time: 1376.2044s
	iters: 300, epoch: 3 | loss: 0.0037964
	speed: 0.2418s/iter; left time: 2138.6044s
	iters: 400, epoch: 3 | loss: 1.9772433
	speed: 0.2825s/iter; left time: 2470.8348s
	iters: 500, epoch: 3 | loss: 0.0039816
	speed: 0.2863s/iter; left time: 2475.1394s
	iters: 600, epoch: 3 | loss: 0.0025978
	speed: 0.2862s/iter; left time: 2445.5603s
	iters: 700, epoch: 3 | loss: 0.0031094
	speed: 0.2817s/iter; left time: 2379.2207s
	iters: 800, epoch: 3 | loss: 0.0026142
	speed: 0.2866s/iter; left time: 2391.3871s
	iters: 900, epoch: 3 | loss: 0.0033278
	speed: 0.2791s/iter; left time: 2300.9310s
	iters: 1000, epoch: 3 | loss: 0.0035360
	speed: 0.2801s/iter; left time: 2281.5633s
	iters: 1100, epoch: 3 | loss: 1.9145954
	speed: 0.2801s/iter; left time: 2253.1962s
Epoch: 3 cost time: 294.00791597366333
Epoch: 3, Steps: 1143 | Train Loss: 1.0641365 Vali Loss: 0.0053380 Test Loss: 0.0079078
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.0037052
	speed: 1.0143s/iter; left time: 8014.7039s
	iters: 200, epoch: 4 | loss: 0.0041659
	speed: 0.2798s/iter; left time: 2182.6369s
	iters: 300, epoch: 4 | loss: 4.0804901
	speed: 0.2819s/iter; left time: 2171.3639s
	iters: 400, epoch: 4 | loss: 0.0042928
	speed: 0.2811s/iter; left time: 2137.0319s
	iters: 500, epoch: 4 | loss: 1.9214158
	speed: 0.2707s/iter; left time: 2030.6293s
	iters: 600, epoch: 4 | loss: 3.3680418
	speed: 0.2621s/iter; left time: 1939.8194s
	iters: 700, epoch: 4 | loss: 0.2439886
	speed: 0.2659s/iter; left time: 1941.8504s
	iters: 800, epoch: 4 | loss: 4.0699000
	speed: 0.2765s/iter; left time: 1991.2681s
	iters: 900, epoch: 4 | loss: 0.1658007
	speed: 0.2834s/iter; left time: 2012.6824s
	iters: 1000, epoch: 4 | loss: 0.8580813
	speed: 0.2808s/iter; left time: 1966.4271s
	iters: 1100, epoch: 4 | loss: 0.0042849
	speed: 0.2847s/iter; left time: 1965.2186s
Epoch: 4 cost time: 318.0188407897949
Update Best URT params
Epoch: 4, Steps: 1143 | Train Loss: 1.0611313 Vali Loss: 0.0050798 Test Loss: 0.0085395
Validation loss decreased (0.005242 --> 0.005080).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0037767
	speed: 1.0332s/iter; left time: 6983.4035s
	iters: 200, epoch: 5 | loss: 1.9121985
	speed: 0.2870s/iter; left time: 1911.1098s
	iters: 300, epoch: 5 | loss: 4.0731535
	speed: 0.2852s/iter; left time: 1870.3512s
	iters: 400, epoch: 5 | loss: 6.7568827
	speed: 0.2839s/iter; left time: 1833.5384s
	iters: 500, epoch: 5 | loss: 0.0049487
	speed: 0.2847s/iter; left time: 1810.1758s
	iters: 600, epoch: 5 | loss: 0.0046616
	speed: 0.2885s/iter; left time: 1805.9754s
	iters: 700, epoch: 5 | loss: 0.8316090
	speed: 0.2910s/iter; left time: 1792.4014s
	iters: 800, epoch: 5 | loss: 1.9139044
	speed: 0.2866s/iter; left time: 1736.2906s
	iters: 900, epoch: 5 | loss: 0.0027857
	speed: 0.2817s/iter; left time: 1678.7859s
	iters: 1000, epoch: 5 | loss: 6.0099249
	speed: 0.2702s/iter; left time: 1582.9370s
	iters: 1100, epoch: 5 | loss: 1.9091271
	speed: 0.2630s/iter; left time: 1514.5758s
Epoch: 5 cost time: 322.7332007884979
Epoch: 5, Steps: 1143 | Train Loss: 1.0634381 Vali Loss: 0.0050869 Test Loss: 0.0083508
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.0026083
	speed: 1.0048s/iter; left time: 5643.0040s
	iters: 200, epoch: 6 | loss: 0.0033287
	speed: 0.2826s/iter; left time: 1558.8446s
	iters: 300, epoch: 6 | loss: 1.6563544
	speed: 0.2827s/iter; left time: 1530.8994s
	iters: 400, epoch: 6 | loss: 4.0714979
	speed: 0.2862s/iter; left time: 1521.4559s
	iters: 500, epoch: 6 | loss: 0.0042773
	speed: 0.2798s/iter; left time: 1459.3064s
	iters: 600, epoch: 6 | loss: 1.9204997
	speed: 0.2786s/iter; left time: 1425.2386s
	iters: 700, epoch: 6 | loss: 0.0044087
	speed: 0.2826s/iter; left time: 1417.2796s
	iters: 800, epoch: 6 | loss: 0.0034093
	speed: 0.2832s/iter; left time: 1391.9824s
	iters: 900, epoch: 6 | loss: 0.0040202
	speed: 0.2851s/iter; left time: 1373.2211s
	iters: 1000, epoch: 6 | loss: 0.0026494
	speed: 0.2813s/iter; left time: 1326.6702s
	iters: 1100, epoch: 6 | loss: 0.0033709
	speed: 0.2820s/iter; left time: 1301.7394s
Epoch: 6 cost time: 323.7246527671814
Update Best URT params
Epoch: 6, Steps: 1143 | Train Loss: 1.0597559 Vali Loss: 0.0043220 Test Loss: 0.0079296
Validation loss decreased (0.005080 --> 0.004322).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8552934
	speed: 1.0035s/iter; left time: 4488.8663s
	iters: 200, epoch: 7 | loss: 0.2431075
	speed: 0.2637s/iter; left time: 1153.1932s
	iters: 300, epoch: 7 | loss: 4.0576892
	speed: 0.2575s/iter; left time: 1100.2045s
	iters: 400, epoch: 7 | loss: 0.0031590
	speed: 0.2692s/iter; left time: 1123.3989s
	iters: 500, epoch: 7 | loss: 0.1685184
	speed: 0.2817s/iter; left time: 1147.4485s
	iters: 600, epoch: 7 | loss: 1.9254310
	speed: 0.2812s/iter; left time: 1117.0174s
	iters: 700, epoch: 7 | loss: 0.0047738
	speed: 0.2830s/iter; left time: 1096.1255s
	iters: 800, epoch: 7 | loss: 4.0758152
	speed: 0.2838s/iter; left time: 1070.9002s
	iters: 900, epoch: 7 | loss: 0.0029037
	speed: 0.2839s/iter; left time: 1042.6804s
	iters: 1000, epoch: 7 | loss: 0.0025148
	speed: 0.2818s/iter; left time: 1006.9834s
	iters: 1100, epoch: 7 | loss: 2.4833107
	speed: 0.2845s/iter; left time: 988.1849s
Epoch: 7 cost time: 316.20628023147583
Epoch: 7, Steps: 1143 | Train Loss: 1.0576484 Vali Loss: 0.0043869 Test Loss: 0.0083637
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.4934292
	speed: 1.0196s/iter; left time: 3395.2880s
	iters: 200, epoch: 8 | loss: 0.0038736
	speed: 0.2813s/iter; left time: 908.4650s
	iters: 300, epoch: 8 | loss: 0.0029067
	speed: 0.2851s/iter; left time: 892.4562s
	iters: 400, epoch: 8 | loss: 0.8548774
	speed: 0.2859s/iter; left time: 866.3791s
	iters: 500, epoch: 8 | loss: 0.0042304
	speed: 0.2798s/iter; left time: 819.7494s
	iters: 600, epoch: 8 | loss: 0.0050700
	speed: 0.2649s/iter; left time: 749.7190s
	iters: 700, epoch: 8 | loss: 5.6119280
	speed: 0.2585s/iter; left time: 705.6068s
	iters: 800, epoch: 8 | loss: 1.5723336
	speed: 0.2655s/iter; left time: 698.2031s
	iters: 900, epoch: 8 | loss: 0.0033918
	speed: 0.2713s/iter; left time: 686.4860s
	iters: 1000, epoch: 8 | loss: 0.0054777
	speed: 0.2812s/iter; left time: 683.3207s
	iters: 1100, epoch: 8 | loss: 0.0046116
	speed: 0.2812s/iter; left time: 655.1464s
Epoch: 8 cost time: 317.2429869174957
Epoch: 8, Steps: 1143 | Train Loss: 1.0585335 Vali Loss: 0.0051872 Test Loss: 0.0096067
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 9 | loss: 0.0040546
	speed: 1.0234s/iter; left time: 2238.2270s
	iters: 200, epoch: 9 | loss: 1.9224061
	speed: 0.2836s/iter; left time: 591.9294s
	iters: 300, epoch: 9 | loss: 0.0049526
	speed: 0.2834s/iter; left time: 563.0347s
	iters: 400, epoch: 9 | loss: 0.0035851
	speed: 0.2830s/iter; left time: 534.0118s
	iters: 500, epoch: 9 | loss: 0.6271841
	speed: 0.2820s/iter; left time: 503.9422s
	iters: 600, epoch: 9 | loss: 0.0026048
	speed: 0.2831s/iter; left time: 477.6273s
	iters: 700, epoch: 9 | loss: 0.0059067
	speed: 0.2810s/iter; left time: 445.9635s
	iters: 800, epoch: 9 | loss: 0.0041276
	speed: 0.2810s/iter; left time: 417.8399s
	iters: 900, epoch: 9 | loss: 0.0033316
	speed: 0.2819s/iter; left time: 390.9752s
	iters: 1000, epoch: 9 | loss: 0.0033185
	speed: 0.2814s/iter; left time: 362.1507s
	iters: 1100, epoch: 9 | loss: 0.0031813
	speed: 0.2644s/iter; left time: 313.8474s
Epoch: 9 cost time: 320.4116141796112
Epoch: 9, Steps: 1143 | Train Loss: 1.0570855 Vali Loss: 0.0050476 Test Loss: 0.0099529
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 1) (10348, 192, 1)
mse:0.007909600622951984, mae:0.0628156065940857
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.008377396846064557
stdev: 0.0037685160134432335
stdev: 0.0033534520018520136
stdev: 0.004651511897972907
stdev: 0.0059807834357843105
stdev: 0.006629737969635403
stdev: 0.0017088422226270309
stdev: 0.009750550838549834
stdev: 0.004701799488894027
stdev: 0.007494979629638079
stdev: 0.0069695873238060976
stdev: 0.002964027383766686
stdev: 0.0026845528338548886
stdev: 0.0075680131488307465
stdev: 0.008769819366784014
stdev: 0.004525483277957965
stdev: 0.0019904330214741035
stdev: 0.009215123532215028
stdev: 0.004213053899166476
stdev: 0.00471665961836313
stdev: 0.002651947243965037
stdev: 0.006273912429908084
stdev: 0.008701037619831889
stdev: 0.008107130937207881
stdev: 0.0017905818133238257
stdev: 0.009396939452102501
stdev: 0.005499560265466813
stdev: 0.00427831290271721
stdev: 0.005352455714557049
stdev: 0.005637021321999348
stdev: 0.009951791209076886
stdev: 0.007780630990366405
stdev: 0.004292379242223742
stdev: 0.006502357732507919
stdev: 0.004776502149535791
stdev: 0.0018250904989186452
stdev: 0.005813685268892471
stdev: 0.004066877967828311
>>>>>>>start training URT: Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 0.0047904
	speed: 0.2868s/iter; left time: 3249.6720s
	iters: 200, epoch: 1 | loss: 4.0767527
	speed: 0.2836s/iter; left time: 3185.2782s
	iters: 300, epoch: 1 | loss: 3.1169746
	speed: 0.2864s/iter; left time: 3187.8364s
	iters: 400, epoch: 1 | loss: 0.0034393
	speed: 0.2845s/iter; left time: 3138.2291s
	iters: 500, epoch: 1 | loss: 0.0046241
	speed: 0.2816s/iter; left time: 3078.4233s
	iters: 600, epoch: 1 | loss: 4.0642920
	speed: 0.2800s/iter; left time: 3032.1430s
	iters: 700, epoch: 1 | loss: 0.0033004
	speed: 0.2808s/iter; left time: 3012.8072s
	iters: 800, epoch: 1 | loss: 0.2507971
	speed: 0.2818s/iter; left time: 2996.0452s
	iters: 900, epoch: 1 | loss: 0.0055089
	speed: 0.2822s/iter; left time: 2972.0316s
	iters: 1000, epoch: 1 | loss: 0.0044404
	speed: 0.2837s/iter; left time: 2959.7024s
	iters: 1100, epoch: 1 | loss: 0.0053772
	speed: 0.2845s/iter; left time: 2939.5811s
Epoch: 1 cost time: 323.8168375492096
Update Best URT params
Epoch: 1, Steps: 1143 | Train Loss: 1.0754863 Vali Loss: 0.0064232 Test Loss: 0.0060233
Validation loss decreased (inf --> 0.006423).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0049651
	speed: 1.0017s/iter; left time: 10204.8855s
	iters: 200, epoch: 2 | loss: 2.9076977
	speed: 0.2696s/iter; left time: 2719.9320s
	iters: 300, epoch: 2 | loss: 1.9217584
	speed: 0.2617s/iter; left time: 2613.5474s
	iters: 400, epoch: 2 | loss: 0.0047833
	speed: 0.2607s/iter; left time: 2577.4883s
	iters: 500, epoch: 2 | loss: 5.9948626
	speed: 0.2586s/iter; left time: 2531.1784s
	iters: 600, epoch: 2 | loss: 0.0056083
	speed: 0.2704s/iter; left time: 2619.8826s
	iters: 700, epoch: 2 | loss: 0.0053293
	speed: 0.2839s/iter; left time: 2722.1322s
	iters: 800, epoch: 2 | loss: 1.0443177
	speed: 0.2866s/iter; left time: 2719.6190s
	iters: 900, epoch: 2 | loss: 1.3788131
	speed: 0.2841s/iter; left time: 2666.9131s
	iters: 1000, epoch: 2 | loss: 0.0037920
	speed: 0.2832s/iter; left time: 2630.2300s
	iters: 1100, epoch: 2 | loss: 0.0056163
	speed: 0.2825s/iter; left time: 2595.3205s
Epoch: 2 cost time: 313.4393210411072
Update Best URT params
Epoch: 2, Steps: 1143 | Train Loss: 1.0721328 Vali Loss: 0.0061848 Test Loss: 0.0056948
Validation loss decreased (0.006423 --> 0.006185).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0046597
	speed: 1.0250s/iter; left time: 9271.5466s
	iters: 200, epoch: 3 | loss: 1.9139684
	speed: 0.2812s/iter; left time: 2515.0457s
	iters: 300, epoch: 3 | loss: 0.0047092
	speed: 0.2816s/iter; left time: 2490.5314s
	iters: 400, epoch: 3 | loss: 0.0041657
	speed: 0.2842s/iter; left time: 2485.0580s
	iters: 500, epoch: 3 | loss: 0.0042483
	speed: 0.2811s/iter; left time: 2429.8248s
	iters: 600, epoch: 3 | loss: 0.0066228
	speed: 0.2826s/iter; left time: 2414.5414s
	iters: 700, epoch: 3 | loss: 0.0046729
	speed: 0.2778s/iter; left time: 2346.1231s
	iters: 800, epoch: 3 | loss: 4.0602875
	speed: 0.2631s/iter; left time: 2195.5350s
	iters: 900, epoch: 3 | loss: 0.7369623
	speed: 0.2599s/iter; left time: 2142.5310s
	iters: 1000, epoch: 3 | loss: 0.7264077
	speed: 0.2635s/iter; left time: 2146.5231s
	iters: 1100, epoch: 3 | loss: 0.0052982
	speed: 0.2781s/iter; left time: 2237.1073s
Epoch: 3 cost time: 316.5769443511963
Epoch: 3, Steps: 1143 | Train Loss: 1.0706242 Vali Loss: 0.0067234 Test Loss: 0.0061283
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.0784505
	speed: 1.0286s/iter; left time: 8128.0578s
	iters: 200, epoch: 4 | loss: 0.0050997
	speed: 0.2826s/iter; left time: 2204.6428s
	iters: 300, epoch: 4 | loss: 0.0055982
	speed: 0.2834s/iter; left time: 2182.7386s
	iters: 400, epoch: 4 | loss: 3.7144799
	speed: 0.2810s/iter; left time: 2136.4058s
	iters: 500, epoch: 4 | loss: 0.6483585
	speed: 0.2838s/iter; left time: 2129.2071s
	iters: 600, epoch: 4 | loss: 0.0058173
	speed: 0.2837s/iter; left time: 2100.2834s
	iters: 700, epoch: 4 | loss: 3.1128039
	speed: 0.2834s/iter; left time: 2069.0481s
	iters: 800, epoch: 4 | loss: 0.0047354
	speed: 0.2841s/iter; left time: 2046.2207s
	iters: 900, epoch: 4 | loss: 0.0049859
	speed: 0.2857s/iter; left time: 2029.3013s
	iters: 1000, epoch: 4 | loss: 1.9181497
	speed: 0.2844s/iter; left time: 1991.2739s
	iters: 1100, epoch: 4 | loss: 4.0681496
	speed: 0.2821s/iter; left time: 1946.7426s
Epoch: 4 cost time: 325.3033854961395
Epoch: 4, Steps: 1143 | Train Loss: 1.0705013 Vali Loss: 0.0064617 Test Loss: 0.0058765
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 5 | loss: 0.0057404
	speed: 0.9833s/iter; left time: 6646.4292s
	iters: 200, epoch: 5 | loss: 2.0655441
	speed: 0.2804s/iter; left time: 1867.0983s
	iters: 300, epoch: 5 | loss: 0.0051464
	speed: 0.2833s/iter; left time: 1858.1371s
	iters: 400, epoch: 5 | loss: 2.2167892
	speed: 0.2846s/iter; left time: 1838.5490s
	iters: 500, epoch: 5 | loss: 4.0748515
	speed: 0.2844s/iter; left time: 1808.2424s
	iters: 600, epoch: 5 | loss: 4.2650547
	speed: 0.2836s/iter; left time: 1775.2105s
	iters: 700, epoch: 5 | loss: 1.9208820
	speed: 0.2823s/iter; left time: 1738.9651s
	iters: 800, epoch: 5 | loss: 1.3143424
	speed: 0.2822s/iter; left time: 1710.0745s
	iters: 900, epoch: 5 | loss: 1.9166582
	speed: 0.2842s/iter; left time: 1693.7365s
	iters: 1000, epoch: 5 | loss: 0.0063944
	speed: 0.2834s/iter; left time: 1660.3402s
	iters: 1100, epoch: 5 | loss: 0.2344174
	speed: 0.2849s/iter; left time: 1640.8629s
Epoch: 5 cost time: 322.65300941467285
Epoch: 5, Steps: 1143 | Train Loss: 1.0700834 Vali Loss: 0.0066684 Test Loss: 0.0059912
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 1) (10348, 192, 1)
mse:0.005692450795322657, mae:0.06119891256093979
Use GPU: cuda:0
Check c_out
1
Check c_out
1
Check c_out
1
[CREATE] 3 learners of Autoformer
stdev: 0.0011650689180082222
stdev: 0.006431073584825836
stdev: 0.009296255556933971
stdev: 0.0035322771822149926
stdev: 0.008513208830001034
stdev: 0.005946603917867569
stdev: 0.0011961191436278358
stdev: 0.00412353900576364
stdev: 0.005950313122404854
stdev: 0.0011188506801521948
stdev: 0.0074430343649941446
stdev: 0.0027079930481982636
stdev: 0.007682203661959859
stdev: 0.006664882330555672
stdev: 0.004259655370821585
stdev: 0.00664326451334338
stdev: 0.005633962771652832
stdev: 0.009054165861432033
stdev: 0.005667988831155426
stdev: 0.006466682624266456
stdev: 0.005273343986990874
stdev: 0.007386316292472245
stdev: 0.002037184386106846
stdev: 0.007595146617364617
stdev: 0.00890238282297522
stdev: 0.005671575591892068
stdev: 0.00712447093627573
stdev: 0.004920022416427312
stdev: 0.009745868992401152
stdev: 0.004286721395051589
stdev: 0.0066044169297078585
stdev: 0.0033246408939077436
stdev: 0.007132089628265548
stdev: 0.00888932737378869
stdev: 0.0031804164498893846
stdev: 0.0022836897491352237
stdev: 0.008428502005730955
stdev: 0.0051889613250137865
>>>>>>>start training URT: Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2>>>>>>>>>>>>>>>>>>>>>>>>>>
Train URT layer >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36600
val 5079
test 10348
Best MSE: 10000000000.0
	iters: 100, epoch: 1 | loss: 1.7038956
	speed: 0.2901s/iter; left time: 3287.6414s
	iters: 200, epoch: 1 | loss: 0.0033961
	speed: 0.2656s/iter; left time: 2982.6250s
	iters: 300, epoch: 1 | loss: 0.0033826
	speed: 0.2611s/iter; left time: 2905.8814s
	iters: 400, epoch: 1 | loss: 0.0037788
	speed: 0.2609s/iter; left time: 2877.8066s
	iters: 500, epoch: 1 | loss: 1.9245632
	speed: 0.2732s/iter; left time: 2986.5056s
	iters: 600, epoch: 1 | loss: 0.0027039
	speed: 0.2842s/iter; left time: 3078.5513s
	iters: 700, epoch: 1 | loss: 4.0728140
	speed: 0.2825s/iter; left time: 3031.9885s
	iters: 800, epoch: 1 | loss: 1.9161088
	speed: 0.2834s/iter; left time: 3012.8200s
	iters: 900, epoch: 1 | loss: 0.0038856
	speed: 0.2826s/iter; left time: 2975.5489s
	iters: 1000, epoch: 1 | loss: 1.9141331
	speed: 0.2833s/iter; left time: 2955.1082s
	iters: 1100, epoch: 1 | loss: 1.2073886
	speed: 0.2848s/iter; left time: 2942.5937s
Epoch: 1 cost time: 317.67761492729187
Update Best URT params
Epoch: 1, Steps: 1143 | Train Loss: 1.0871735 Vali Loss: 0.0043386 Test Loss: 0.0048500
Validation loss decreased (inf --> 0.004339).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0024913
	speed: 1.0180s/iter; left time: 10371.7594s
	iters: 200, epoch: 2 | loss: 4.0774179
	speed: 0.2819s/iter; left time: 2843.4587s
	iters: 300, epoch: 2 | loss: 0.5973904
	speed: 0.2807s/iter; left time: 2803.3664s
	iters: 400, epoch: 2 | loss: 0.0037824
	speed: 0.2839s/iter; left time: 2807.5548s
	iters: 500, epoch: 2 | loss: 0.0029147
	speed: 0.2807s/iter; left time: 2747.5271s
	iters: 600, epoch: 2 | loss: 0.0033727
	speed: 0.2816s/iter; left time: 2728.5739s
	iters: 700, epoch: 2 | loss: 0.0030721
	speed: 0.2625s/iter; left time: 2516.5219s
	iters: 800, epoch: 2 | loss: 0.0032174
	speed: 0.2613s/iter; left time: 2479.0285s
	iters: 900, epoch: 2 | loss: 4.0693274
	speed: 0.2634s/iter; left time: 2472.4493s
	iters: 1000, epoch: 2 | loss: 0.0033428
	speed: 0.2697s/iter; left time: 2504.8766s
	iters: 1100, epoch: 2 | loss: 0.0040132
	speed: 0.2825s/iter; left time: 2595.6350s
Epoch: 2 cost time: 316.1958553791046
Epoch: 2, Steps: 1143 | Train Loss: 1.0764898 Vali Loss: 0.0045421 Test Loss: 0.0051371
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 3 | loss: 0.8186382
	speed: 1.0237s/iter; left time: 9259.0626s
	iters: 200, epoch: 3 | loss: 1.9145859
	speed: 0.2810s/iter; left time: 2513.2258s
	iters: 300, epoch: 3 | loss: 1.9145902
	speed: 0.2819s/iter; left time: 2492.9683s
	iters: 400, epoch: 3 | loss: 4.0741644
	speed: 0.2814s/iter; left time: 2460.6645s
	iters: 500, epoch: 3 | loss: 1.2078916
	speed: 0.2805s/iter; left time: 2425.1173s
	iters: 600, epoch: 3 | loss: 4.0807114
	speed: 0.2840s/iter; left time: 2426.4826s
	iters: 700, epoch: 3 | loss: 0.0025573
	speed: 0.2834s/iter; left time: 2393.5995s
	iters: 800, epoch: 3 | loss: 0.0024450
	speed: 0.2808s/iter; left time: 2342.9770s
	iters: 900, epoch: 3 | loss: 0.1863126
	speed: 0.2838s/iter; left time: 2340.1854s
	iters: 1000, epoch: 3 | loss: 1.9207668
	speed: 0.2828s/iter; left time: 2303.3421s
	iters: 1100, epoch: 3 | loss: 0.0035419
	speed: 0.2835s/iter; left time: 2280.5207s
Epoch: 3 cost time: 322.9370119571686
Epoch: 3, Steps: 1143 | Train Loss: 1.0775108 Vali Loss: 0.0045986 Test Loss: 0.0052798
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.0037193
	speed: 0.9758s/iter; left time: 7710.9921s
	iters: 200, epoch: 4 | loss: 1.3691082
	speed: 0.2848s/iter; left time: 2221.7718s
	iters: 300, epoch: 4 | loss: 0.1721936
	speed: 0.2837s/iter; left time: 2184.8296s
	iters: 400, epoch: 4 | loss: 1.9268612
	speed: 0.2806s/iter; left time: 2133.4900s
	iters: 500, epoch: 4 | loss: 0.0041433
	speed: 0.2831s/iter; left time: 2123.6525s
	iters: 600, epoch: 4 | loss: 1.0528131
	speed: 0.2848s/iter; left time: 2107.7288s
	iters: 700, epoch: 4 | loss: 0.0042905
	speed: 0.2826s/iter; left time: 2063.7099s
	iters: 800, epoch: 4 | loss: 4.0768509
	speed: 0.2810s/iter; left time: 2023.9897s
	iters: 900, epoch: 4 | loss: 0.0025689
	speed: 0.2820s/iter; left time: 2002.7530s
	iters: 1000, epoch: 4 | loss: 0.0031146
	speed: 0.2829s/iter; left time: 1980.8163s
	iters: 1100, epoch: 4 | loss: 0.0050203
	speed: 0.2828s/iter; left time: 1951.6245s
Epoch: 4 cost time: 322.7351818084717
Epoch: 4, Steps: 1143 | Train Loss: 1.0753563 Vali Loss: 0.0045873 Test Loss: 0.0050672
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing FastSlow+URT : Weather_E3kv2_96_192_B6autoformer_custom_ftS_sl96_ll48_pl192_dm256_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_Exp_2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
test shape: (10348, 192, 1) (10348, 192, 1)
mse:0.00485409377142787, mae:0.05059003084897995
